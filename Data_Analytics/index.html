<html lang="en" dir="ltr" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
      <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <title>CITS4009 - Project 1</title>
        <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
        <link href="page_styles.css" rel="stylesheet" type="text/css"/>
        <style type="text/css">
          p a.formula-ref {
            margin-left: 40px
          }
        </style>
      </head>
      <body>
        <div class="container-fluid main-container"> 
 <div class="fluid-row" id="header"> 
  <div class="btn-group pull-right"> <button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button> 
   <ul class="dropdown-menu" style="min-width: 50px;"> 
    <li><a id="rmd-show-all-code" href="https://lms.uwa.edu.au#">Show All Code</a></li> 
    <li><a id="rmd-hide-all-code" href="https://lms.uwa.edu.au#">Hide All Code</a></li> 
    <li role="separator" class="divider"></li> 
    <li><a id="rmd-download-source" href="https://lms.uwa.edu.au#">Download Rmd</a></li> 
   </ul> 
  </div> 
  <h1 class="title toc-ignore">CITS4009 - Project 1</h1> 
  <h4 class="author">Sergio Banchero (22565979)</h4> 
 </div> <!-- rnb-text-begin --> 
 <div id="introduction" class="section level3"> 
  <h3>Introduction</h3> 
  <p>The data set analyzed can be obtained from the Kaggle platform. It’s part of the “Data Science for Good: Kiva Crowdfunding” challenge. <a href="https://www.kaggle.com/kiva/data-science-for-good-kiva-crowdfunding" class="uri">https://www.kaggle.com/kiva/data-science-for-good-kiva-crowdfunding</a></p> 
  <p>Kiva.org is a crowdfunding organization that provides loans to people in economic disadvantage all over the world. The data set includes over 670K loans made by Kiva in a span of almost 3 years and a half. Data provided includes geographical information, usage of the loans and some information about the borrowers.</p> 
 </div> 
 <div id="data-loading-overview-and-set-up" class="section level3"> 
  <h3>Data loading, overview and set up</h3> 
  <p>Load libraries</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxubGlicmFyeShnZ3Bsb3QyKVxubGlicmFyeShncmlkRXh0cmEpXG5saWJyYXJ5KGRwbHlyKVxubGlicmFyeShnZ3RoZW1lcylcbmxpYnJhcnkobnVtZm9ybSlcbmxpYnJhcnkodHJlZW1hcGlmeSlcbmxpYnJhcnkodGltZURhdGUpXG5saWJyYXJ5KGx1YnJpZGF0ZSlcbmxpYnJhcnkoZHBseXIpXG5saWJyYXJ5KHJlc2hhcGUyKVxubGlicmFyeShjYSlcbmBgYCJ9 --> 
  <pre class="r"><code>library(ggplot2)
library(gridExtra)
library(dplyr)
library(ggthemes)
library(numform)
library(treemapify)
library(timeDate)
library(lubridate)
library(dplyr)
library(reshape2)
library(ca)</code></pre> <!-- rnb-source-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>Setting up a plotting theme so that all charts look coherent</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuY2l0czQwMDlfdGhlbWUgPC0gdGhlbWVfZmV3KCkgKyAjIFRoZW1lIGJhc2VkIG9uIFMuIEZldydzIFwiUHJhY3RpY2FsIFJ1bGVzIGZvciBVc2luZyBDb2xvciBpbiBDaGFydHNcIlxuICAgICAgICAgICAgICAgICAgdGhlbWUocGxvdC50aXRsZSA9IGVsZW1lbnRfdGV4dChjb2xvciA9IFwiZGFya3JlZFwiKSkgK1xuICAgICAgICAgICAgICAgICAgdGhlbWUoc3RyaXAudGV4dC54ID0gZWxlbWVudF90ZXh0KHNpemUgPSAxNCwgY29sb3VyID0gXCIjMjAyMDIwXCIpKSArXG4gICAgICAgICAgICAgICAgICB0aGVtZShwbG90Lm1hcmdpbj1tYXJnaW4oMTAsMzAsMTAsMzApKVxuYGBgIn0= --> 
  <pre class="r"><code>cits4009_theme &lt;- theme_few() + # Theme based on S. Few's "Practical Rules for Using Color in Charts"
                  theme(plot.title = element_text(color = "darkred")) +
                  theme(strip.text.x = element_text(size = 14, colour = "#202020")) +
                  theme(plot.margin=margin(10,30,10,30))</code></pre> <!-- rnb-source-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>Load the main data</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuZGF0YS5wYXRoIDwtICcuL2RhdGEva2l2YV9sb2Fucy5jc3YnXG5raXZhIDwtIHJlYWQuY3N2KGRhdGEucGF0aClcbmBgYCJ9 --> 
  <pre class="r"><code>data.path &lt;- './data/kiva_loans.csv'
kiva &lt;- read.csv(data.path)</code></pre> <!-- rnb-source-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>Using str to analyze the data</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuc3RyKGtpdmEpXG5gYGAifQ== --> 
  <pre class="r"><code>str(kiva)</code></pre> <!-- rnb-source-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>There are 671205 obs with 20 variables, comprised by 14 factors, 2 integer and 4 numeric variables. But in fact columns, we can see that from the factors, some have too many levels: “use”, “posted_time”, “disbursed_time”, “funded_time”, “tags”, “borrower_genders” and “date”. This is because R treats any column for which it finds “string” data as factors by default. We will deal with these later on. From the numeric variables, partner_id and id are actually ids so they could be treated as factors or ignored for now.</p> 
  <p>Using summary to analyze the data</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuc3VtbWFyeShraXZhKVxuYGBgIn0= --> 
  <pre class="r"><code>summary(kiva)</code></pre> <!-- rnb-source-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>Most numeric variables, like loan amount and lender count are highly right-skewed.</p> 
  <p>Viewing the first ten observations</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuaGVhZChraXZhKVxuYGBgIn0= --> 
  <pre class="r"><code>head(kiva)</code></pre> <!-- rnb-source-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>From the above two summaries, we can see that borrower_genders is a list with the genders of all the borrowers individually listed. “Use”" is a free text field.</p> 
  <div id="initial-transformations" class="section level5"> 
   <h5>Initial transformations</h5> 
   <p>Based on the above observations, we’ll convert some columns to a more appropriate format and add new ones that might be useful in further analysis.</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxudGltZV9jb2xzIDwtIGMoJ3Bvc3RlZF90aW1lJywgJ2Rpc2J1cnNlZF90aW1lJywgJ2Z1bmRlZF90aW1lJylcbmtpdmFbLHRpbWVfY29sc11ba2l2YVssdGltZV9jb2xzXT09XCJcIl0gPC0gTkEgIyBSZXBsYWNlIHRoZSBcIlwiIHN0cmluZyBmb3IgTkEgaW4gdGhlIGRhdGUtdGltZSBjb2x1bW5zXG5cbmtpdmEgPC0gd2l0aGluKGtpdmEsIHtcbiAgICAgICAgICBwYXJ0bmVyX2lkIDwtIGFzLmZhY3RvcihwYXJ0bmVyX2lkKVxuICAgICAgICAgIHVzZSA8LSBhcy5jaGFyYWN0ZXIodXNlKVxuICAgICAgICAgIFxuICAgICAgICAgICMgVXNlIHRoZSBcImJvcnJvd2VyX2dlbmRlcnNcIiB0byBleHRyYWN0IHRoZSBudW1iZXIgb2YgYm9ycm93ZXJzXG4gICAgICAgICAgbnVtYmVyX2JvcnJvd2VycyA8LSBzYXBwbHkoc3Ryc3BsaXQoYXMuY2hhcmFjdGVyKGtpdmEkYm9ycm93ZXJfZ2VuZGVycyksIFwiLCBcIiksIGxlbmd0aClcbiAgICAgICAgICBib3Jyb3dlcnNfZmVtYWxlcyA8LSBzYXBwbHkoc3Ryc3BsaXQoYXMuY2hhcmFjdGVyKGtpdmEkYm9ycm93ZXJfZ2VuZGVycyksIFwiLCBcIiksIGZ1bmN0aW9uKHgpe3N1bSh4PT0nZmVtYWxlJyl9KVxuICAgICAgICAgIGJvcnJvd2Vyc19tYWxlcyA8LSBzYXBwbHkoc3Ryc3BsaXQoYXMuY2hhcmFjdGVyKGtpdmEkYm9ycm93ZXJfZ2VuZGVycyksIFwiLCBcIiksIGZ1bmN0aW9uKHgpe3N1bSh4PT0nbWFsZScpfSlcbiAgICAgICAgICBcbiAgICAgICAgICAjIFBhcnNpbmcgYW5kIGNvbnZlcnRpbmcgZGF0ZXNcbiAgICAgICAgICBkYXRlIDwtIGFzLkRhdGUoZGF0ZSwgZm9ybWF0PSclWS0lbS0lZCcpXG4gICAgICAgICAgcG9zdGVkX3RpbWUgPC0gYXMuUE9TSVhsdChwb3N0ZWRfdGltZSlcbiAgICAgICAgICBkaXNidXJzZWRfdGltZSA8LSBhcy5QT1NJWGx0KGRpc2J1cnNlZF90aW1lKVxuICAgICAgICAgIGZ1bmRlZF90aW1lIDwtIGFzLlBPU0lYbHQoZnVuZGVkX3RpbWUpXG4gICAgICAgICAgZnVuZGVkX2xhZyA8LSBhcy5udW1lcmljKGRpZmZ0aW1lKGZ1bmRlZF90aW1lLCBwb3N0ZWRfdGltZSwgdW5pdHMgPSBcImRheXNcIikpXG4gICAgICAgICAgZnVuZGVkX2xhZ1tmdW5kZWRfbGFnPDBdIDwtIE5BICMgbmVnYXRpdmUgdGltZXMgbWFrZSBubyBzZW5zZSwgc2V0IHRvIE5BXG4gICAgICAgICAgXG4gICAgICAgICAgIyBDb252ZXJ0IHRhZ3MgdG8gY2hhcmFjdGVyc1xuICAgICAgICAgIHRhZ3MgPC0gYXMuY2hhcmFjdGVyKHRhZ3MpXG4gICAgICAgICAgdXNlcl9mYXZvcml0ZSA8LSBncmVwbChcInVzZXJfZmF2b3JpdGVcIiwgdGFncykgIyB0YWtlIHRoZSBcInVzZXJfZmF2b3JpdGVcIiB0YWcgYXMgYSBib29sZWFuIHZhcmlhYmxlXG4gICAgICAgICAgXG4gICAgICAgICAgZnVsbHlfZnVuZGVkIDwtIGZ1bmRlZF9hbW91bnQ+PWxvYW5fYW1vdW50ICMgYm9vbGVhbiB2YXJpYWJsZSBpbmRpY2F0aW5nIGlmIHRoZSBsb2FuIHdhcyBmdWxseSBmdW5kZWRcbn0pXG5gYGAifQ== --> 
   <pre class="r"><code>time_cols &lt;- c('posted_time', 'disbursed_time', 'funded_time')
kiva[,time_cols][kiva[,time_cols]==""] &lt;- NA # Replace the "" string for NA in the date-time columns

kiva &lt;- within(kiva, {
          partner_id &lt;- as.factor(partner_id)
          use &lt;- as.character(use)
          
          # Use the "borrower_genders" to extract the number of borrowers
          number_borrowers &lt;- sapply(strsplit(as.character(kiva$borrower_genders), ", "), length)
          borrowers_females &lt;- sapply(strsplit(as.character(kiva$borrower_genders), ", "), function(x){sum(x=='female')})
          borrowers_males &lt;- sapply(strsplit(as.character(kiva$borrower_genders), ", "), function(x){sum(x=='male')})
          
          # Parsing and converting dates
          date &lt;- as.Date(date, format='%Y-%m-%d')
          posted_time &lt;- as.POSIXlt(posted_time)
          disbursed_time &lt;- as.POSIXlt(disbursed_time)
          funded_time &lt;- as.POSIXlt(funded_time)
          funded_lag &lt;- as.numeric(difftime(funded_time, posted_time, units = "days"))
          funded_lag[funded_lag&lt;0] &lt;- NA # negative times make no sense, set to NA
          
          # Convert tags to characters
          tags &lt;- as.character(tags)
          user_favorite &lt;- grepl("user_favorite", tags) # take the "user_favorite" tag as a boolean variable
          
          fully_funded &lt;- funded_amount&gt;=loan_amount # boolean variable indicating if the loan was fully funded
})</code></pre> <!-- rnb-source-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
   <p>Analyze the number of NA each variables</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuYXBwbHkoaXMubmEoa2l2YSksIDIsIHN1bSlcbmBgYCJ9 --> 
   <pre class="r"><code>apply(is.na(kiva), 2, sum)</code></pre> <!-- rnb-source-end --> <!-- rnb-output-begin eyJkYXRhIjoiICAgICAgICAgICAgICAgIGlkICAgICAgZnVuZGVkX2Ftb3VudCAgICAgICAgbG9hbl9hbW91bnQgICAgICAgICAgIGFjdGl2aXR5ICAgICAgICAgICAgIHNlY3RvciAgICAgICAgICAgICAgICB1c2UgICAgICAgY291bnRyeV9jb2RlIFxuICAgICAgICAgICAgICAgICAwICAgICAgICAgICAgICAgICAgMCAgICAgICAgICAgICAgICAgIDAgICAgICAgICAgICAgICAgICAwICAgICAgICAgICAgICAgICAgMCAgICAgICAgICAgICAgICAgIDAgICAgICAgICAgICAgICAgICAwIFxuICAgICAgICAgICBjb3VudHJ5ICAgICAgICAgICAgIHJlZ2lvbiAgICAgICAgICAgY3VycmVuY3kgICAgICAgICBwYXJ0bmVyX2lkICAgICAgICBwb3N0ZWRfdGltZSAgICAgZGlzYnVyc2VkX3RpbWUgICAgICAgIGZ1bmRlZF90aW1lIFxuICAgICAgICAgICAgICAgICAwICAgICAgICAgICAgICAgICAgMCAgICAgICAgICAgICAgICAgIDAgICAgICAgICAgICAgIDEzNTA3ICAgICAgICAgICAgICAgICAgMCAgICAgICAgICAgICAgIDIzOTYgICAgICAgICAgICAgIDQ4MzMxIFxuICAgIHRlcm1faW5fbW9udGhzICAgICAgIGxlbmRlcl9jb3VudCAgICAgICAgICAgICAgIHRhZ3MgICBib3Jyb3dlcl9nZW5kZXJzIHJlcGF5bWVudF9pbnRlcnZhbCAgICAgICAgICAgICAgIGRhdGUgICAgICAgZnVsbHlfZnVuZGVkIFxuICAgICAgICAgICAgICAgICAwICAgICAgICAgICAgICAgICAgMCAgICAgICAgICAgICAgICAgIDAgICAgICAgICAgICAgICAgICAwICAgICAgICAgICAgICAgICAgMCAgICAgICAgICAgICAgICAgIDAgICAgICAgICAgICAgICAgICAwIFxuICAgICB1c2VyX2Zhdm9yaXRlICAgICAgICAgZnVuZGVkX2xhZyAgICBib3Jyb3dlcnNfbWFsZXMgIGJvcnJvd2Vyc19mZW1hbGVzICAgbnVtYmVyX2JvcnJvd2VycyBcbiAgICAgICAgICAgICAgICAgMCAgICAgICAgICAgICAgNDgzMzIgICAgICAgICAgICAgICAgICAwICAgICAgICAgICAgICAgICAgMCAgICAgICAgICAgICAgICAgIDAgXG4ifQ== --> 
   <pre><code>                id      funded_amount        loan_amount           activity             sector                use       country_code 
                 0                  0                  0                  0                  0                  0                  0 
           country             region           currency         partner_id        posted_time     disbursed_time        funded_time 
                 0                  0                  0              13507                  0               2396              48331 
    term_in_months       lender_count               tags   borrower_genders repayment_interval               date       fully_funded 
                 0                  0                  0                  0                  0                  0                  0 
     user_favorite         funded_lag    borrowers_males  borrowers_females   number_borrowers 
                 0              48332                  0                  0                  0 </code></pre> <!-- rnb-output-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
   <p>Most of the columns don’t have any NA. The ones that do might be due to lack of funding. We can see this by splitting the same information between the fully funded and not funded loans:</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxueCA8LSByYmluZChhcHBseShpcy5uYShraXZhW2tpdmEkZnVsbHlfZnVuZGVkLF0pLCAyLCBzdW0pLFxuICAgICAgICAgICBhcHBseShpcy5uYShraXZhWyFraXZhJGZ1bGx5X2Z1bmRlZCxdKSwgMiwgc3VtKSlcbnJvd25hbWVzKHgpIDwtIGMoJ2Z1bGx5X2Z1bmRlZCcsJ25vdF9mdWxseV9mdW5kZWQnKVxudCh4Wyxjb2xTdW1zKHgpPjBdKVxuYGBgIn0= --> 
   <pre class="r"><code>x &lt;- rbind(apply(is.na(kiva[kiva$fully_funded,]), 2, sum),
           apply(is.na(kiva[!kiva$fully_funded,]), 2, sum))
rownames(x) &lt;- c('fully_funded','not_fully_funded')
t(x[,colSums(x)&gt;0])</code></pre> <!-- rnb-source-end --> <!-- rnb-output-begin eyJkYXRhIjoiICAgICAgICAgICAgICAgZnVsbHlfZnVuZGVkIG5vdF9mdWxseV9mdW5kZWRcbnBhcnRuZXJfaWQgICAgICAgICAgICAxMTM1MiAgICAgICAgICAgICAyMTU1XG5kaXNidXJzZWRfdGltZSAgICAgICAgICAyNDEgICAgICAgICAgICAgMjE1NVxuZnVuZGVkX3RpbWUgICAgICAgICAgICAgICAzICAgICAgICAgICAgNDgzMjhcbmZ1bmRlZF9sYWcgICAgICAgICAgICAgICAgNCAgICAgICAgICAgIDQ4MzI4XG4ifQ== --> 
   <pre><code>               fully_funded not_fully_funded
partner_id            11352             2155
disbursed_time          241             2155
funded_time               3            48328
funded_lag                4            48328</code></pre> <!-- rnb-output-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
   <p>We see that that’s mostly the case for all variables except partner_id.</p> 
  </div> 
 </div> 
 <div id="analyzing-loan-amount-funded-amount-and-funded-time" class="section level3"> 
  <h3>Analyzing loan amount, funded amount and funded time</h3> 
  <p>Since these are right-skewed variables, we’ll use two histograms to analyze the distribution: one with a log10 scale and one with a truncated linear scale</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxucDEgPC0gZ2dwbG90KGRhdGEgPSBraXZhLCBtYXBwaW5nID0gYWVzKHggPSBsb2FuX2Ftb3VudCkpK1xuICBnZW9tX2hpc3RvZ3JhbShhZXMoeT0uLmRlbnNpdHkuLiksIGJpbnM9NTAsIGZpbGwgPSBcImdyZXlcIikrXG4gIGdlb21fZGVuc2l0eShjb2xvcj0nZGFya3JlZCcpICtcbiAgc2NhbGVfeF9jb250aW51b3VzKHRyYW5zPSdsb2cxMCcpK1xuICBnZ3RpdGxlKFwiTG9hbiBBbW91bnQgKExvZyBTY2FsZSlcIikgKyBcbiAgY2l0czQwMDlfdGhlbWVcbnAyIDwtIGdncGxvdChkYXRhID0ga2l2YSwgXG4gICAgICBtYXBwaW5nID0gYWVzKHggPSBsb2FuX2Ftb3VudCkpK1xuICBnZW9tX2hpc3RvZ3JhbShhZXMoeT0uLmRlbnNpdHkuLiksIGJpbnMgPSAyMDAsIGZpbGwgPSBcImdyZXlcIikrXG4gIGdlb21fZGVuc2l0eShjb2xvcj0nZGFya3JlZCcpICtcbiAgc2NhbGVfeF9jb250aW51b3VzKGxpbWl0cz1jKDAsIDAuNWUrMDQpKStcbiAgYW5ub3RhdGUoXCJ0ZXh0XCIsIHggPSAxMDAwLCB5ID0gMC4wMDE1LCBsYWJlbCA9IFwiU3Bpa2VzIGF0IGRpc2NyZXRlIHZhbHVlc1xcbiAkMUssICQxLjVLLCBldGNcIikgK1xuICBnZ3RpdGxlKFwiTG9hbiBBbW91bnQgKFVwIHRvICQ1SylcIikgKyBcbiAgY2l0czQwMDlfdGhlbWVcbmdyaWQuYXJyYW5nZShwMSwgcDIsIG5jb2w9MSlcbmBgYCJ9 --> 
  <pre class="r"><code>p1 &lt;- ggplot(data = kiva, mapping = aes(x = loan_amount))+
  geom_histogram(aes(y=..density..), bins=50, fill = "grey")+
  geom_density(color='darkred') +
  scale_x_continuous(trans='log10')+
  ggtitle("Loan Amount (Log Scale)") + 
  cits4009_theme
p2 &lt;- ggplot(data = kiva, 
      mapping = aes(x = loan_amount))+
  geom_histogram(aes(y=..density..), bins = 200, fill = "grey")+
  geom_density(color='darkred') +
  scale_x_continuous(limits=c(0, 0.5e+04))+
  annotate("text", x = 1000, y = 0.0015, label = "Spikes at discrete values\n $1K, $1.5K, etc") +
  ggtitle("Loan Amount (Up to $5K)") + 
  cits4009_theme
grid.arrange(p1, p2, ncol=1)</code></pre> <!-- rnb-source-end --> <!-- rnb-plot-begin eyJjb25kaXRpb25zIjpbWzEsIlJlbW92ZWQgOTU3OSByb3dzIGNvbnRhaW5pbmcgbm9uLWZpbml0ZSB2YWx1ZXMgKHN0YXRfYmluKS4iXSxbMSwiUmVtb3ZlZCA5NTc5IHJvd3MgY29udGFpbmluZyBub24tZmluaXRlIHZhbHVlcyAoc3RhdF9kZW5zaXR5KS4iXSxbMSwiUmVtb3ZlZCAyIHJvd3MgY29udGFpbmluZyBtaXNzaW5nIHZhbHVlcyAoZ2VvbV9iYXIpLiJdXSwiaGVpZ2h0Ijo3LjQxNjYsInNpemVfYmVoYXZpb3IiOjEsIndpZHRoIjoxMn0= --> 
  <p><img src="image0.png" /></p> <!-- rnb-plot-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>Most loans have “round” values like 100, 500, 1K, etc.</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxucDEgPC0gZ2dwbG90KGRhdGEgPSBraXZhLCBtYXBwaW5nID0gYWVzKHggPSBmdW5kZWRfYW1vdW50KSkrXG4gIGdlb21faGlzdG9ncmFtKGFlcyh5PS4uZGVuc2l0eS4uKSwgYmlucz01MCwgZmlsbCA9IFwiZ3JleVwiKStcbiAgZ2VvbV9kZW5zaXR5KGNvbG9yPSdkYXJrcmVkJykgK1xuICBzY2FsZV94X2NvbnRpbnVvdXModHJhbnM9J2xvZzEwJykrXG4gIGdndGl0bGUoXCJGdW5kZWQgQW1vdW50IChMb2cgU2NhbGUpXCIpICsgXG4gIGNpdHM0MDA5X3RoZW1lXG5wMiA8LSBnZ3Bsb3QoZGF0YSA9IGtpdmEsIFxuICAgICAgbWFwcGluZyA9IGFlcyh4ID0gZnVuZGVkX2Ftb3VudCkpK1xuICBnZW9tX2hpc3RvZ3JhbShhZXMoeT0uLmRlbnNpdHkuLiksIGJpbnMgPSAyMDAsIGZpbGwgPSBcImdyZXlcIikrXG4gIGdlb21fZGVuc2l0eShjb2xvcj0nZGFya3JlZCcpICtcbiAgc2NhbGVfeF9jb250aW51b3VzKGxpbWl0cz1jKDAsIDAuNWUrMDQpKStcbiAgZ2d0aXRsZShcIkZ1bmRlZCBBbW91bnQgKFVwIHRvICQ1SylcIikgKyBcbiAgY2l0czQwMDlfdGhlbWVcbmdyaWQuYXJyYW5nZShwMSwgcDIsIG5jb2w9MSlcbmBgYCJ9 --> 
  <pre class="r"><code>p1 &lt;- ggplot(data = kiva, mapping = aes(x = funded_amount))+
  geom_histogram(aes(y=..density..), bins=50, fill = "grey")+
  geom_density(color='darkred') +
  scale_x_continuous(trans='log10')+
  ggtitle("Funded Amount (Log Scale)") + 
  cits4009_theme
p2 &lt;- ggplot(data = kiva, 
      mapping = aes(x = funded_amount))+
  geom_histogram(aes(y=..density..), bins = 200, fill = "grey")+
  geom_density(color='darkred') +
  scale_x_continuous(limits=c(0, 0.5e+04))+
  ggtitle("Funded Amount (Up to $5K)") + 
  cits4009_theme
grid.arrange(p1, p2, ncol=1)</code></pre> <!-- rnb-source-end --> <!-- rnb-plot-begin eyJjb25kaXRpb25zIjpbWzEsIlRyYW5zZm9ybWF0aW9uIGludHJvZHVjZWQgaW5maW5pdGUgdmFsdWVzIGluIGNvbnRpbnVvdXMgeC1heGlzIl0sWzEsIlRyYW5zZm9ybWF0aW9uIGludHJvZHVjZWQgaW5maW5pdGUgdmFsdWVzIGluIGNvbnRpbnVvdXMgeC1heGlzIl0sWzEsIlJlbW92ZWQgMzM4MyByb3dzIGNvbnRhaW5pbmcgbm9uLWZpbml0ZSB2YWx1ZXMgKHN0YXRfYmluKS4iXSxbMSwiUmVtb3ZlZCAzMzgzIHJvd3MgY29udGFpbmluZyBub24tZmluaXRlIHZhbHVlcyAoc3RhdF9kZW5zaXR5KS4iXSxbMSwiUmVtb3ZlZCA4NDc5IHJvd3MgY29udGFpbmluZyBub24tZmluaXRlIHZhbHVlcyAoc3RhdF9iaW4pLiJdLFsxLCJSZW1vdmVkIDg0Nzkgcm93cyBjb250YWluaW5nIG5vbi1maW5pdGUgdmFsdWVzIChzdGF0X2RlbnNpdHkpLiJdLFsxLCJSZW1vdmVkIDIgcm93cyBjb250YWluaW5nIG1pc3NpbmcgdmFsdWVzIChnZW9tX2JhcikuIl1dLCJoZWlnaHQiOjcuNDE2Niwic2l6ZV9iZWhhdmlvciI6MSwid2lkdGgiOjEyfQ== --> 
  <p><img src="image1.png" /></p> <!-- rnb-plot-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>As expected, the “funded_amount” has a distribution almost identical to “loan_amount”.</p> 
  <p>Because most loans have “round” values like 100, 500, 1K, etc., it might be useful to add a categorical variable to group them</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuYnJrcyA8LWMoMCwgMTAwLCAyMDAsIDMwMCwgNDAwLCA1MDAsIDEwMDAsIDIwMDAsIDUwMDAsIEluZilcbmtpdmEkbG9hbl9hbW91bnRfcmFuZ2UgPC0gY3V0KGtpdmEkbG9hbl9hbW91bnQsIGJyZWFrcz1icmtzLCByaWdodD1GQUxTRSwgaW5jbHVkZS5sb3dlc3Q9VClcbmxldmVscyhraXZhJGxvYW5fYW1vdW50X3JhbmdlKSA8LSBjKFwiWzAsMTAwKVwiLCBcIlsxMDAsMjAwKVwiLCBcIlsyMDAsMzAwKVwiLCBcIlszMDAsNDAwKVwiLCBcIls0MDAsNTAwKVwiLCBcIls1MDAsMUspXCIsIFwiWzFLLDJLKVwiLFxuXCJbMkssNUspXCIsIFwiPj01S1wiKVxuYGBgIn0= --> 
  <pre class="r"><code>brks &lt;-c(0, 100, 200, 300, 400, 500, 1000, 2000, 5000, Inf)
kiva$loan_amount_range &lt;- cut(kiva$loan_amount, breaks=brks, right=FALSE, include.lowest=T)
levels(kiva$loan_amount_range) &lt;- c("[0,100)", "[100,200)", "[200,300)", "[300,400)", "[400,500)", "[500,1K)", "[1K,2K)",
"[2K,5K)", "&gt;=5K")</code></pre> <!-- rnb-source-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>We can also analyze the distribution of “funded lag” (how long it took for the loan to be funded). Again we’ll use a log scale and a truncated linear scale to plot the distribution.</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxucDEgPC0gZ2dwbG90KGRhdGEgPSBraXZhLCBtYXBwaW5nID0gYWVzKHggPSBmdW5kZWRfbGFnKSkrXG4gIGdlb21faGlzdG9ncmFtKGFlcyh5PS4uZGVuc2l0eS4uKSwgYmlucz0zMCwgZmlsbCA9IFwiZ3JleVwiKStcbiAgZ2VvbV9kZW5zaXR5KGNvbG9yPSdkYXJrcmVkJykgK1xuICBzY2FsZV94X2NvbnRpbnVvdXModHJhbnM9J2xvZzEwJykrXG4gIGdndGl0bGUoXCJGdW5kZWQgTGFnIChMb2cgU2NhbGUpXCIpICsgXG4gIGNpdHM0MDA5X3RoZW1lXG5wMiA8LSBnZ3Bsb3QoZGF0YSA9IGtpdmEsIFxuICAgICAgbWFwcGluZyA9IGFlcyh4ID0gZnVuZGVkX2xhZykpK1xuICBnZW9tX2hpc3RvZ3JhbShhZXMoeT0uLmRlbnNpdHkuLiksIGJpbnMgPSAxMDAsIGZpbGwgPSBcImdyZXlcIikrXG4gIGdlb21fZGVuc2l0eShjb2xvcj0nZGFya3JlZCcpICtcbiAgc2NhbGVfeF9jb250aW51b3VzKGxpbWl0cz1jKDAsIDEwMCkpK1xuICBhbm5vdGF0ZShcInRleHRcIiwgeCA9IDMwLCB5ID0gMC4wMywgbGFiZWwgPSBcIn4zMCBkYXlzXFxuIGZ1bmRlZCBsYWdcIikgK1xuICBnZ3RpdGxlKFwiRnVuZGVkIExhZyAoVXAgdG8gMTAwIGRheXMpXCIpICsgXG4gIGNpdHM0MDA5X3RoZW1lXG5ncmlkLmFycmFuZ2UocDEsIHAyLCBuY29sPTEpXG5gYGAifQ== --> 
  <pre class="r"><code>p1 &lt;- ggplot(data = kiva, mapping = aes(x = funded_lag))+
  geom_histogram(aes(y=..density..), bins=30, fill = "grey")+
  geom_density(color='darkred') +
  scale_x_continuous(trans='log10')+
  ggtitle("Funded Lag (Log Scale)") + 
  cits4009_theme
p2 &lt;- ggplot(data = kiva, 
      mapping = aes(x = funded_lag))+
  geom_histogram(aes(y=..density..), bins = 100, fill = "grey")+
  geom_density(color='darkred') +
  scale_x_continuous(limits=c(0, 100))+
  annotate("text", x = 30, y = 0.03, label = "~30 days\n funded lag") +
  ggtitle("Funded Lag (Up to 100 days)") + 
  cits4009_theme
grid.arrange(p1, p2, ncol=1)</code></pre> <!-- rnb-source-end --> <!-- rnb-plot-begin eyJjb25kaXRpb25zIjpbWzEsIlJlbW92ZWQgNDgzMzIgcm93cyBjb250YWluaW5nIG5vbi1maW5pdGUgdmFsdWVzIChzdGF0X2JpbikuIl0sWzEsIlJlbW92ZWQgNDgzMzIgcm93cyBjb250YWluaW5nIG5vbi1maW5pdGUgdmFsdWVzIChzdGF0X2RlbnNpdHkpLiJdLFsxLCJSZW1vdmVkIDQ5NDUyIHJvd3MgY29udGFpbmluZyBub24tZmluaXRlIHZhbHVlcyAoc3RhdF9iaW4pLiJdLFsxLCJSZW1vdmVkIDQ5NDUyIHJvd3MgY29udGFpbmluZyBub24tZmluaXRlIHZhbHVlcyAoc3RhdF9kZW5zaXR5KS4iXSxbMSwiUmVtb3ZlZCAyIHJvd3MgY29udGFpbmluZyBtaXNzaW5nIHZhbHVlcyAoZ2VvbV9iYXIpLiJdXSwiaGVpZ2h0Ijo3LjQxNjYsInNpemVfYmVoYXZpb3IiOjEsIndpZHRoIjoxMn0= --> 
  <p><img src="image2.png" /></p> <!-- rnb-plot-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>We see that it seems to be a bi-modal distribution, with a peak around 1 week and another at around 1 month.</p> 
  <p>Now we want to analyze if there’s a relation between the loan amount and how long it takes to fund it. Since funded lag seems to be bi-modal, a boxplot might not show this detail, so we’ll use violin plots.</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuZ2QgPC0ga2l2YSAlPiUgXG4gICAgICAgIGdyb3VwX2J5KGxvYW5fYW1vdW50X3JhbmdlKSAlPiUgXG4gICAgICAgIHN1bW1hcmlzZShmdW5kZWRfbGFnID0gbWVhbihmdW5kZWRfbGFnLCBuYS5ybSA9IFQpKVxuZ2dwbG90KGRhdGEgPSBraXZhLCBcbiAgICAgIG1hcHBpbmcgPSBhZXMoeSA9IGZ1bmRlZF9sYWcsIHggPSBsb2FuX2Ftb3VudF9yYW5nZSkpK1xuICBnZW9tX2hsaW5lKHlpbnRlcmNlcHQgPSAzMSwgc2hvdy5sZWdlbmQgPSBULCBzaXplPTEsIGNvbG9yPSdkYXJrZ3JheScsIGxpbmV0eXBlPSdkb3R0ZWQnKSArXG4gIGdlb21faGxpbmUoeWludGVyY2VwdCA9IDYsIHNob3cubGVnZW5kID0gVCwgc2l6ZT0xLCBjb2xvcj0nZGFya2dyYXknLCBsaW5ldHlwZT0nZG90dGVkJykgKyBcbiAgZ2VvbV92aW9saW4oZmlsbCA9J2xpZ2h0Z3JheScpK1xuICBnZW9tX3BvaW50KGRhdGEgPSBnZCwgc3RhdCA9IFwiaWRlbnRpdHlcIiwgYWVzKHNoYXBlPSdtZWFuJyksIGNvbG9yPSdkYXJrcmVkJywgc2l6ZT00KStcbiAgc2NhbGVfeV9jb250aW51b3VzKGxpbWl0cyA9IGMoMCwxMDApKStcbiAgYW5ub3RhdGUoXCJ0ZXh0XCIsIHggPSAtMC41LCB5ID0gNywgbGFiZWwgPSBcIiBcIikgK1xuICBhbm5vdGF0ZShcInRleHRcIiwgeCA9IDAsIHkgPSA3LCBsYWJlbCA9IFwifjEgV2Vla1xcbiBmdW5kZWQgbGFnXCIpICtcbiAgYW5ub3RhdGUoXCJ0ZXh0XCIsIHggPSA0LjUsIHkgPSAzMixsYWJlbCA9IFwifjMwIGRheXNcXG4gZnVuZGVkIGxhZ1wiKSArXG4gIGdndGl0bGUoXCJGdW5kZWQgTGFnIERpc3RyaWJ1dGlvbiBieSBMb2FuIEFtb3VudCBSYW5nZVwiKSArIFxuICBjaXRzNDAwOV90aGVtZVxuYGBgIn0= --> 
  <pre class="r"><code>gd &lt;- kiva %&gt;% 
        group_by(loan_amount_range) %&gt;% 
        summarise(funded_lag = mean(funded_lag, na.rm = T))
ggplot(data = kiva, 
      mapping = aes(y = funded_lag, x = loan_amount_range))+
  geom_hline(yintercept = 31, show.legend = T, size=1, color='darkgray', linetype='dotted') +
  geom_hline(yintercept = 6, show.legend = T, size=1, color='darkgray', linetype='dotted') + 
  geom_violin(fill ='lightgray')+
  geom_point(data = gd, stat = "identity", aes(shape='mean'), color='darkred', size=4)+
  scale_y_continuous(limits = c(0,100))+
  annotate("text", x = -0.5, y = 7, label = " ") +
  annotate("text", x = 0, y = 7, label = "~1 Week\n funded lag") +
  annotate("text", x = 4.5, y = 32,label = "~30 days\n funded lag") +
  ggtitle("Funded Lag Distribution by Loan Amount Range") + 
  cits4009_theme</code></pre> <!-- rnb-source-end --> <!-- rnb-plot-begin eyJjb25kaXRpb25zIjpbWzEsIlJlbW92ZWQgNDk0NTIgcm93cyBjb250YWluaW5nIG5vbi1maW5pdGUgdmFsdWVzIChzdGF0X3lkZW5zaXR5KS4iXV0sImhlaWdodCI6Ny40MTY2LCJzaXplX2JlaGF2aW9yIjoxLCJ3aWR0aCI6MTJ9 --> 
  <p><img src="image3.png" /></p> <!-- rnb-plot-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>The funded lag appears to increase with the loan amount. Another visible pattern is that a 30 days lag seems to be very common in large loans, whereas smaller loans get funded much quicker, specially after one week. This could be due to kiva’s promotion policy on how projects get displayed and ranked in their site (For instance, after 30 days, a project that hasn’t been funded is shown to more visitors).</p> 
 </div> 
 <div id="analyzing-number-of-lenders" class="section level3"> 
  <h3>Analyzing Number of Lenders</h3> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxucDEgPC0gZ2dwbG90KGRhdGEgPSBraXZhLCBcbiAgICAgIG1hcHBpbmcgPSBhZXMoeCA9IGxlbmRlcl9jb3VudCkpK1xuICBnZW9tX2hpc3RvZ3JhbShhZXMoeT0uLmRlbnNpdHkuLiksIGJpbnMgPSAxMDAsIGZpbGwgPSBcImdyZXlcIikrXG4gIGdlb21fZGVuc2l0eShjb2xvcj0nZGFya3JlZCcpICtcbiAgc2NhbGVfeF9jb250aW51b3VzKHRyYW5zPSdsb2cxMCcpK1xuICBnZ3RpdGxlKFwiTnVtYmVyIG9mIGxlbmRlcnMgZGlzdHJpYnV0aW9uIChMb2cpXCIpICsgXG4gIGNpdHM0MDA5X3RoZW1lXG5wMiA8LSBnZ3Bsb3QoZGF0YSA9IGtpdmEsIFxuICAgICAgbWFwcGluZyA9IGFlcyh4ID0gbGVuZGVyX2NvdW50KSkrXG4gIGdlb21faGlzdG9ncmFtKGFlcyh5PS4uZGVuc2l0eS4uKSwgYmlucyA9IDEwMCwgZmlsbCA9IFwiZ3JleVwiKStcbiAgZ2VvbV9kZW5zaXR5KGNvbG9yPSdkYXJrcmVkJykgK1xuICBzY2FsZV94X2NvbnRpbnVvdXMobGltaXRzPWMoMCwgMTAwKSkrXG4gIGdndGl0bGUoXCJOdW1iZXIgb2YgbGVuZGVycyAodXAgdG8gMTAwKSBkaXN0cmlidXRpb25cIikgKyBcbiAgY2l0czQwMDlfdGhlbWVcbmdyaWQuYXJyYW5nZShwMSwgcDIsIG5jb2w9MSlcbmBgYCJ9 --> 
  <pre class="r"><code>p1 &lt;- ggplot(data = kiva, 
      mapping = aes(x = lender_count))+
  geom_histogram(aes(y=..density..), bins = 100, fill = "grey")+
  geom_density(color='darkred') +
  scale_x_continuous(trans='log10')+
  ggtitle("Number of lenders distribution (Log)") + 
  cits4009_theme
p2 &lt;- ggplot(data = kiva, 
      mapping = aes(x = lender_count))+
  geom_histogram(aes(y=..density..), bins = 100, fill = "grey")+
  geom_density(color='darkred') +
  scale_x_continuous(limits=c(0, 100))+
  ggtitle("Number of lenders (up to 100) distribution") + 
  cits4009_theme
grid.arrange(p1, p2, ncol=1)</code></pre> <!-- rnb-source-end --> <!-- rnb-plot-begin eyJjb25kaXRpb25zIjpbWzEsIlRyYW5zZm9ybWF0aW9uIGludHJvZHVjZWQgaW5maW5pdGUgdmFsdWVzIGluIGNvbnRpbnVvdXMgeC1heGlzIl0sWzEsIlRyYW5zZm9ybWF0aW9uIGludHJvZHVjZWQgaW5maW5pdGUgdmFsdWVzIGluIGNvbnRpbnVvdXMgeC1heGlzIl0sWzEsIlJlbW92ZWQgMzM4MyByb3dzIGNvbnRhaW5pbmcgbm9uLWZpbml0ZSB2YWx1ZXMgKHN0YXRfYmluKS4iXSxbMSwiUmVtb3ZlZCAzMzgzIHJvd3MgY29udGFpbmluZyBub24tZmluaXRlIHZhbHVlcyAoc3RhdF9kZW5zaXR5KS4iXSxbMSwiUmVtb3ZlZCAxMzAyOSByb3dzIGNvbnRhaW5pbmcgbm9uLWZpbml0ZSB2YWx1ZXMgKHN0YXRfYmluKS4iXSxbMSwiUmVtb3ZlZCAxMzAyOSByb3dzIGNvbnRhaW5pbmcgbm9uLWZpbml0ZSB2YWx1ZXMgKHN0YXRfZGVuc2l0eSkuIl0sWzEsIlJlbW92ZWQgMiByb3dzIGNvbnRhaW5pbmcgbWlzc2luZyB2YWx1ZXMgKGdlb21fYmFyKS4iXV0sImhlaWdodCI6Ny40MTY2LCJzaXplX2JlaGF2aW9yIjoxLCJ3aWR0aCI6MTJ9 --> 
  <p><img src="image4.png" /></p> <!-- rnb-plot-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>The number of lenders seems to follow a one-inflated Poisson distribution</p> 
  <p>Now we’ll see the relation between number of lenders and loan amount.</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuZ2dwbG90KG1hcHBpbmcgPSBhZXMoeD1sZW5kZXJfY291bnQsIHk9bG9hbl9hbW91bnQpLCBkYXRhPWtpdmFba2l2YSRsb2FuX2Ftb3VudD4xICYga2l2YSRsZW5kZXJfY291bnQ+MCxdKSArXG4gIGdlb21fcG9pbnQoYWxwaGE9MC4wMSkgK1xuICBzY2FsZV94X2NvbnRpbnVvdXModHJhbnM9J2xvZzEwJykgK1xuICBzY2FsZV95X2NvbnRpbnVvdXModHJhbnM9J2xvZzEwJykgK1xuICBnZW9tX2xpbmUoc3RhdD0nc3VtbWFyeScsZnVuLnk9cXVhbnRpbGUsZnVuLmFyZ3MgPSBsaXN0KDAuMDUpLFxuICAgICAgICAgICAgbGluZXR5cGU9MiwgbWFwcGluZz1hZXMoY29sb3I9XCI1JSBQZXJjZW50aWxlXCIpLCBzaXplPTEpK1xuICBnZW9tX2xpbmUoc3RhdD0nc3VtbWFyeScsZnVuLnk9bWVhbixcbiAgICAgICAgICAgIGxpbmV0eXBlPTEsIG1hcHBpbmc9YWVzKGNvbG9yPVwiTWVhblwiKSwgc2l6ZT0xKStcbiAgZ2VvbV9saW5lKHN0YXQ9J3N1bW1hcnknLGZ1bi55PXF1YW50aWxlLGZ1bi5hcmdzID0gbGlzdCgwLjk1KSxcbiAgICAgICAgICAgIGxpbmV0eXBlPTIsIG1hcHBpbmc9YWVzKGNvbG9yPVwiOTUlIFBlcmNlbnRpbGVcIiksIHNpemU9MSkrXG4gIGdndGl0bGUoXCJMb2FuIEFtb3VudCBWcyBOdW1iZXIgb2YgTGVuZGVyc1wiKSArIFxuICBjaXRzNDAwOV90aGVtZVxuYGBgIn0= --> 
  <pre class="r"><code>ggplot(mapping = aes(x=lender_count, y=loan_amount), data=kiva[kiva$loan_amount&gt;1 &amp; kiva$lender_count&gt;0,]) +
  geom_point(alpha=0.01) +
  scale_x_continuous(trans='log10') +
  scale_y_continuous(trans='log10') +
  geom_line(stat='summary',fun.y=quantile,fun.args = list(0.05),
            linetype=2, mapping=aes(color="5% Percentile"), size=1)+
  geom_line(stat='summary',fun.y=mean,
            linetype=1, mapping=aes(color="Mean"), size=1)+
  geom_line(stat='summary',fun.y=quantile,fun.args = list(0.95),
            linetype=2, mapping=aes(color="95% Percentile"), size=1)+
  ggtitle("Loan Amount Vs Number of Lenders") + 
  cits4009_theme</code></pre> <!-- rnb-source-end --> <!-- rnb-plot-begin eyJjb25kaXRpb25zIjpbXSwiaGVpZ2h0Ijo3LjQxNjYsInNpemVfYmVoYXZpb3IiOjEsIndpZHRoIjoxMn0= --> 
  <p><img src="image5.png" /></p> <!-- rnb-plot-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>There seems to be a linear relation between the number of lenders and the lower quantiles of the loan amount. This could be because of a minimum lending amount. We can create a histogram of loan amount per lender to see if this is could be the case.</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxubWFzayA8LSBraXZhJGxvYW5fYW1vdW50PjEgJiBraXZhJGxlbmRlcl9jb3VudD4wXG5raXZhJGxvYW5fYW1vdW50X3Blcl9sZW5kZXIgPC0ga2l2YSRsb2FuX2Ftb3VudCAvIGtpdmEkbGVuZGVyX2NvdW50XG5raXZhJGxvYW5fYW1vdW50X3Blcl9sZW5kZXJbIW1hc2tdIDwtIE5BXG5nZ3Bsb3QoZGF0YSA9IGtpdmEsIG1hcHBpbmcgPSBhZXMoeCA9IGxvYW5fYW1vdW50X3Blcl9sZW5kZXIpKSArXG4gIGdlb21faGlzdG9ncmFtKGJpbnM9MTAwKSArXG4gIHNjYWxlX3hfY29udGludW91cyhsaW1pdHMgPSBjKDAsNTAwKSkrXG4gIGdndGl0bGUoXCJEaXN0cmlidXRpb24gb2YgTG9hbiBBbW91bnQgUGVyIExlbmRlciAodXAgdG8gJDUwMClcIikgK1xuICBjaXRzNDAwOV90aGVtZVxuYGBgIn0= --> 
  <pre class="r"><code>mask &lt;- kiva$loan_amount&gt;1 &amp; kiva$lender_count&gt;0
kiva$loan_amount_per_lender &lt;- kiva$loan_amount / kiva$lender_count
kiva$loan_amount_per_lender[!mask] &lt;- NA
ggplot(data = kiva, mapping = aes(x = loan_amount_per_lender)) +
  geom_histogram(bins=100) +
  scale_x_continuous(limits = c(0,500))+
  ggtitle("Distribution of Loan Amount Per Lender (up to $500)") +
  cits4009_theme</code></pre> <!-- rnb-source-end --> <!-- rnb-plot-begin eyJjb25kaXRpb25zIjpbWzEsIlJlbW92ZWQgMTIyMjcgcm93cyBjb250YWluaW5nIG5vbi1maW5pdGUgdmFsdWVzIChzdGF0X2JpbikuIl0sWzEsIlJlbW92ZWQgMiByb3dzIGNvbnRhaW5pbmcgbWlzc2luZyB2YWx1ZXMgKGdlb21fYmFyKS4iXV0sImhlaWdodCI6Ny40MTY2LCJzaXplX2JlaGF2aW9yIjoxLCJ3aWR0aCI6MTJ9 --> 
  <p><img src="image6.png" /></p> <!-- rnb-plot-end --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuZ2dwbG90KGRhdGEgPSBraXZhLCBtYXBwaW5nID0gYWVzKHggPSBsb2FuX2Ftb3VudF9wZXJfbGVuZGVyKSkgK1xuICBnZW9tX2hpc3RvZ3JhbShiaW5zPTEwMCkgK1xuICBzY2FsZV94X2NvbnRpbnVvdXMobGltaXRzID0gYygwLDUwKSkrXG4gIGdndGl0bGUoXCJEaXN0cmlidXRpb24gb2YgTG9hbiBBbW91bnQgUGVyIExlbmRlciAodXAgdG8gJDUwKVwiKSArXG4gIGNpdHM0MDA5X3RoZW1lXG5gYGAifQ== --> 
  <pre class="r"><code>ggplot(data = kiva, mapping = aes(x = loan_amount_per_lender)) +
  geom_histogram(bins=100) +
  scale_x_continuous(limits = c(0,50))+
  ggtitle("Distribution of Loan Amount Per Lender (up to $50)") +
  cits4009_theme</code></pre> <!-- rnb-source-end --> <!-- rnb-plot-begin eyJjb25kaXRpb25zIjpbWzEsIlJlbW92ZWQgMTQ1MTExIHJvd3MgY29udGFpbmluZyBub24tZmluaXRlIHZhbHVlcyAoc3RhdF9iaW4pLiJdLFsxLCJSZW1vdmVkIDIgcm93cyBjb250YWluaW5nIG1pc3NpbmcgdmFsdWVzIChnZW9tX2JhcikuIl1dLCJoZWlnaHQiOjcuNDE2Niwic2l6ZV9iZWhhdmlvciI6MSwid2lkdGgiOjEyfQ== --> 
  <p><img src="image7.png" /></p> <!-- rnb-plot-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>The large spike at $25 and the very few cases below that amount are a strong indication that the minimum loan is set at $25, and that a very large proportion of founders actually give that amount. In fact, by checking the kiva.org website, we see this is the case.</p> 
 </div> 
 <div id="geographical-information" class="section level3"> 
  <h3>Geographical information</h3> 
  <p>Plot the loan amount by country to have an understanding of where the loans are being used.</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxua2l2YV9ieV9jb3VudHJ5IDwtIGtpdmEgJT4lIFxuICAgICAgICBncm91cF9ieShjb3VudHJ5KSAlPiUgXG4gICAgICAgIHN1bW1hcmlzZShsb2FuX2Ftb3VudF9tZWFuID0gbWVhbihsb2FuX2Ftb3VudCwgbmEucm0gPSBUKSxcbiAgICAgICAgICAgICAgICAgIGxvYW5fYW1vdW50X3N1bSA9IHN1bShsb2FuX2Ftb3VudCwgbmEucm0gPSBUKVxuICAgICAgICAgICAgICAgICAgKVxua2l2YV9ieV9jb3VudHJ5IDwtIHRyYW5zZm9ybShraXZhX2J5X2NvdW50cnksXG4gICAgICAgICAgICAgICAgICAgIGNvdW50cnk9cmVvcmRlcihjb3VudHJ5LCBsb2FuX2Ftb3VudF9zdW0pKVxuZ2dwbG90KGtpdmFfYnlfY291bnRyeSwgbWFwcGluZz1hZXMoeD1jb3VudHJ5LCB5PWxvYW5fYW1vdW50X3N1bSkpK1xuICBnZW9tX2JhcihzdGF0PVwiaWRlbnRpdHlcIiwgZmlsbD1cImdyYXlcIikgK1xuICBnZW9tX3RleHQobWFwcGluZz1hZXMobGFiZWw9ZmZfbWlsbHMoIGRpZ2l0cz0tNCkobG9hbl9hbW91bnRfc3VtKSksIHBvc2l0aW9uID0gcG9zaXRpb25fc3RhY2sodmp1c3QgPSAwLjUpLCBzaXplPTQpICtcbiAgZ2d0aXRsZShcIkxvYW4gQW1vdW50IEJ5IENvdW50cnlcIikgKyBcbiAgY29vcmRfZmxpcCgpICtcbiAgdGhlbWUoYXhpcy50ZXh0Lnk9ZWxlbWVudF90ZXh0KHNpemU9cmVsKDAuOCkpKStcbiAgc2NhbGVfeV9jb250aW51b3VzKGxhYmVsID0gZmZfbWlsbHMocHJlZml4ID0nJCcsIGRpZ2l0cz0tNCkpK1xuICBjaXRzNDAwOV90aGVtZVxuYGBgIn0= --> 
  <pre class="r"><code>kiva_by_country &lt;- kiva %&gt;% 
        group_by(country) %&gt;% 
        summarise(loan_amount_mean = mean(loan_amount, na.rm = T),
                  loan_amount_sum = sum(loan_amount, na.rm = T)
                  )
kiva_by_country &lt;- transform(kiva_by_country,
                    country=reorder(country, loan_amount_sum))
ggplot(kiva_by_country, mapping=aes(x=country, y=loan_amount_sum))+
  geom_bar(stat="identity", fill="gray") +
  geom_text(mapping=aes(label=ff_mills( digits=-4)(loan_amount_sum)), position = position_stack(vjust = 0.5), size=4) +
  ggtitle("Loan Amount By Country") + 
  coord_flip() +
  theme(axis.text.y=element_text(size=rel(0.8)))+
  scale_y_continuous(label = ff_mills(prefix ='$', digits=-4))+
  cits4009_theme</code></pre> <!-- rnb-source-end --> <!-- rnb-plot-begin eyJjb25kaXRpb25zIjpbXSwiaGVpZ2h0IjoxNiwic2l6ZV9iZWhhdmlvciI6MSwid2lkdGgiOjEyfQ== --> 
  <p><img src="image8.png" /></p> <!-- rnb-plot-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>The site offers a secondary file with extra information about the regions, such as geographical coordinates and world region. Load and merge this data.</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxua2l2YV9yZWdpb25zIDwtIHJlYWQuY3N2KCcuL2RhdGEva2l2YV9tcGlfcmVnaW9uX2xvY2F0aW9ucy5jc3YnKVxua2l2YV9ieV9yZWdpb24gPC0ga2l2YSAlPiUgXG4gICAgICAgIGdyb3VwX2J5KC5kb3RzPWMoJ2NvdW50cnknLCAncmVnaW9uJykpICU+JSBcbiAgICAgICAgc3VtbWFyaXNlKGxvYW5fYW1vdW50X21lYW4gPSBtZWFuKGxvYW5fYW1vdW50LCBuYS5ybSA9IFQpLFxuICAgICAgICAgICAgICAgICAgbG9hbl9hbW91bnRfc3VtID0gc3VtKGxvYW5fYW1vdW50LCBuYS5ybSA9IFQpXG4gICAgICAgICAgICAgICAgICApXG5raXZhX2J5X3JlZ2lvbiA8LSBtZXJnZShraXZhX2J5X3JlZ2lvbiwga2l2YV9yZWdpb25zLCBieT1jKCdjb3VudHJ5JywncmVnaW9uJyksIGFsbC54ID0gVFJVRSlcbmtpdmFfd2l0aF9yZWdpb24gPC0gbWVyZ2Uoa2l2YSwga2l2YV9yZWdpb25zLCBieT1jKCdjb3VudHJ5JywncmVnaW9uJyksIGFsbC54ID0gVFJVRSlcbmBgYCJ9 --> 
  <pre class="r"><code>kiva_regions &lt;- read.csv('./data/kiva_mpi_region_locations.csv')
kiva_by_region &lt;- kiva %&gt;% 
        group_by(.dots=c('country', 'region')) %&gt;% 
        summarise(loan_amount_mean = mean(loan_amount, na.rm = T),
                  loan_amount_sum = sum(loan_amount, na.rm = T)
                  )
kiva_by_region &lt;- merge(kiva_by_region, kiva_regions, by=c('country','region'), all.x = TRUE)
kiva_with_region &lt;- merge(kiva, kiva_regions, by=c('country','region'), all.x = TRUE)</code></pre> <!-- rnb-source-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>Plot a map</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuY2l0czQwMDlfbWFwX3RoZW1lIDwtIGNpdHM0MDA5X3RoZW1lICsgXG4gICAgICAgICAgICAgICAgICAgICAgdGhlbWUocGFuZWwuZ3JpZCA9IGVsZW1lbnRfYmxhbmsoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYW5lbC5ib3JkZXIgPSBlbGVtZW50X2JsYW5rKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVnZW5kLnBvc2l0aW9uPVwidG9wXCIsIGxlZ2VuZC5kaXJlY3Rpb24gPSAnaG9yaXpvbnRhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXhpcy50aXRsZS54PWVsZW1lbnRfYmxhbmsoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBheGlzLnRleHQueD1lbGVtZW50X2JsYW5rKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXhpcy50aWNrcy54PWVsZW1lbnRfYmxhbmsoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBheGlzLnRpdGxlLnk9ZWxlbWVudF9ibGFuaygpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF4aXMudGV4dC55PWVsZW1lbnRfYmxhbmsoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBheGlzLnRpY2tzLnk9ZWxlbWVudF9ibGFuaygpKVxuYGBgIn0= --> 
  <pre class="r"><code>cits4009_map_theme &lt;- cits4009_theme + 
                      theme(panel.grid = element_blank(),
                            panel.border = element_blank(),
                            legend.position="top", legend.direction = 'horizontal',
                            axis.title.x=element_blank(),
                            axis.text.x=element_blank(),
                            axis.ticks.x=element_blank(),
                            axis.title.y=element_blank(),
                            axis.text.y=element_blank(),
                            axis.ticks.y=element_blank())</code></pre> <!-- rnb-source-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuZ2dwbG90KGtpdmFfYnlfcmVnaW9uKStcbiAgZ2VvbV9wb2x5Z29uKGRhdGE9bWFwX2RhdGEoXCJ3b3JsZFwiKSwgYWVzKHggPSBsb25nLCB5ID0gbGF0LCBncm91cCA9IGdyb3VwKSwgZmlsbD1cIiNGMEYwRjBcIiwgY29sb3VyID0gXCJsaWdodGdyYXlcIikrXG4gIGdlb21fcG9pbnQobWFwcGluZyA9IGFlcyh4PWxvbiwgeT1sYXQsIHNpemUgPSBsb2FuX2Ftb3VudF9zdW0pLCBhbHBoYT0wLjcsIGNvbG9yPSdkYXJrcmVkJykrXG4gIGNvb3JkX3F1aWNrbWFwKCkrXG4gIGZhY2V0X3dyYXAofndvcmxkX3JlZ2lvbiwgIHNjYWxlcyA9IFwiZnJlZVwiKStcbiAgZ2d0aXRsZShcIkxvY2F0aW9uIG9mIExvYW5zIGJ5IFdvcmxkIFJlZ2lvblwiKSArIFxuICBjaXRzNDAwOV9tYXBfdGhlbWVcbmBgYCJ9 --> 
  <pre class="r"><code>ggplot(kiva_by_region)+
  geom_polygon(data=map_data("world"), aes(x = long, y = lat, group = group), fill="#F0F0F0", colour = "lightgray")+
  geom_point(mapping = aes(x=lon, y=lat, size = loan_amount_sum), alpha=0.7, color='darkred')+
  coord_quickmap()+
  facet_wrap(~world_region,  scales = "free")+
  ggtitle("Location of Loans by World Region") + 
  cits4009_map_theme</code></pre> <!-- rnb-source-end --> <!-- rnb-plot-begin eyJjb25kaXRpb25zIjpbWzEsIlJlbW92ZWQgMTI3MTMgcm93cyBjb250YWluaW5nIG1pc3NpbmcgdmFsdWVzIChnZW9tX3BvaW50KS4iXV0sImhlaWdodCI6Ny40MTY2LCJzaXplX2JlaGF2aW9yIjoxLCJ3aWR0aCI6MTJ9 --> 
  <p><img src="image9.png" /></p> <!-- rnb-plot-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>There are some clear issues with the data: We can see that there are miss located points, for instance there are points categorized as “Latin America and Caribbean” but are placed in Africa or Asia. We can clean up this by setting to NA the coordinates that fall far from the region bounding box. Also, many countries seem to have not been mapped correctly. For instance, Philippines is the largest in terms of loan amount, but no point appears for it.</p> 
  <p>The problem is that the “region” name not always matches between both files. An approximate solution is to use the country instead of the region to map them.</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxua2l2YV9jb3VudHJpZXMgPC0ga2l2YV9yZWdpb25zICU+JSBcbiAgICAgICAgZ3JvdXBfYnkoLmRvdHM9YygnY291bnRyeScpKSAlPiUgXG4gICAgICAgIHN1bW1hcmlzZSh3b3JsZF9yZWdpb25faW1wID0gbWF4KGFzLmNoYXJhY3Rlcih3b3JsZF9yZWdpb24pLCBuYS5ybSA9IFQpLFxuICAgICAgICAgICAgICAgICAgbGF0X2ltcCA9IG1lZGlhbihsYXQpLFxuICAgICAgICAgICAgICAgICAgbG9uX2ltcCA9IG1lZGlhbihsb24pXG4gICAgICAgICAgICAgICAgICApXG5raXZhX2J5X3JlZ2lvbiA8LSBtZXJnZShraXZhX2J5X3JlZ2lvbiwga2l2YV9jb3VudHJpZXMsIGJ5PWMoJ2NvdW50cnknKSwgYWxsLnggPSBUUlVFKVxua2l2YV93aXRoX3JlZ2lvbiA8LSBtZXJnZShraXZhX3dpdGhfcmVnaW9uLCBraXZhX2NvdW50cmllcywgYnk9YygnY291bnRyeScpLCBhbGwueCA9IFRSVUUpXG4jIEltcHV0ZSB3aXRoIHRoZSBjb3VudHJ5IHJlZ2lvblxua2l2YV9ieV9yZWdpb24kd29ybGRfcmVnaW9uW2lzLm5hKGtpdmFfYnlfcmVnaW9uJHdvcmxkX3JlZ2lvbildIDwtIGtpdmFfYnlfcmVnaW9uJHdvcmxkX3JlZ2lvbl9pbXBbaXMubmEoa2l2YV9ieV9yZWdpb24kd29ybGRfcmVnaW9uKV1cbmtpdmFfd2l0aF9yZWdpb24kd29ybGRfcmVnaW9uW2lzLm5hKGtpdmFfd2l0aF9yZWdpb24kd29ybGRfcmVnaW9uKV0gPC0ga2l2YV93aXRoX3JlZ2lvbiR3b3JsZF9yZWdpb25faW1wW2lzLm5hKGtpdmFfd2l0aF9yZWdpb24kd29ybGRfcmVnaW9uKV1cbmBgYCJ9 --> 
  <pre class="r"><code>kiva_countries &lt;- kiva_regions %&gt;% 
        group_by(.dots=c('country')) %&gt;% 
        summarise(world_region_imp = max(as.character(world_region), na.rm = T),
                  lat_imp = median(lat),
                  lon_imp = median(lon)
                  )
kiva_by_region &lt;- merge(kiva_by_region, kiva_countries, by=c('country'), all.x = TRUE)
kiva_with_region &lt;- merge(kiva_with_region, kiva_countries, by=c('country'), all.x = TRUE)
# Impute with the country region
kiva_by_region$world_region[is.na(kiva_by_region$world_region)] &lt;- kiva_by_region$world_region_imp[is.na(kiva_by_region$world_region)]
kiva_with_region$world_region[is.na(kiva_with_region$world_region)] &lt;- kiva_with_region$world_region_imp[is.na(kiva_with_region$world_region)]</code></pre> <!-- rnb-source-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxudW5pcXVlKGtpdmFfYnlfcmVnaW9uJGNvdW50cnlbaXMubmEoa2l2YV9ieV9yZWdpb24kd29ybGRfcmVnaW9uKV0pXG5gYGAifQ== --> 
  <pre class="r"><code>unique(kiva_by_region$country[is.na(kiva_by_region$world_region)])</code></pre> <!-- rnb-source-end --> <!-- rnb-output-begin eyJkYXRhIjoiIFsxXSBCb2xpdmlhICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2hpbGUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENvbmdvICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuIFs0XSBDb3N0YSBSaWNhICAgICAgICAgICAgICAgICAgICAgICAgICAgQ290ZSBEJ0l2b2lyZSAgICAgICAgICAgICAgICAgICAgICAgIEdlb3JnaWEgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuIFs3XSBHdWFtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSXNyYWVsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEtvc292byAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuWzEwXSBMZWJhbm9uICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9sZG92YSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE15YW5tYXIgKEJ1cm1hKSAgICAgICAgICAgICAgICAgICAgIFxuWzEzXSBQYWxlc3RpbmUgICAgICAgICAgICAgICAgICAgICAgICAgICAgUGFuYW1hICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBhcmFndWF5ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuWzE2XSBQdWVydG8gUmljbyAgICAgICAgICAgICAgICAgICAgICAgICAgU2FpbnQgVmluY2VudCBhbmQgdGhlIEdyZW5hZGluZXMgICAgIFNhbW9hICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuWzE5XSBTb2xvbW9uIElzbGFuZHMgICAgICAgICAgICAgICAgICAgICAgVGFuemFuaWEgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRoZSBEZW1vY3JhdGljIFJlcHVibGljIG9mIHRoZSBDb25nb1xuWzIyXSBUdXJrZXkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVW5pdGVkIFN0YXRlcyAgICAgICAgICAgICAgICAgICAgICAgIFZpZXRuYW0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuWzI1XSBWaXJnaW4gSXNsYW5kcyAgICAgICAgICAgICAgICAgICAgICBcbjg3IExldmVsczogQWZnaGFuaXN0YW4gQWxiYW5pYSBBcm1lbmlhIEF6ZXJiYWlqYW4gQmVsaXplIEJlbmluIEJodXRhbiBCb2xpdmlhIEJyYXppbCBCdXJraW5hIEZhc28gQnVydW5kaSBDYW1ib2RpYSBDYW1lcm9vbiBDaGlsZSBDaGluYSAuLi4gWmltYmFid2VcbiJ9 --> 
  <pre><code> [1] Bolivia                              Chile                                Congo                               
 [4] Costa Rica                           Cote D'Ivoire                        Georgia                             
 [7] Guam                                 Israel                               Kosovo                              
[10] Lebanon                              Moldova                              Myanmar (Burma)                     
[13] Palestine                            Panama                               Paraguay                            
[16] Puerto Rico                          Saint Vincent and the Grenadines     Samoa                               
[19] Solomon Islands                      Tanzania                             The Democratic Republic of the Congo
[22] Turkey                               United States                        Vietnam                             
[25] Virgin Islands                      
87 Levels: Afghanistan Albania Armenia Azerbaijan Belize Benin Bhutan Bolivia Brazil Burkina Faso Burundi Cambodia Cameroon Chile China ... Zimbabwe</code></pre> <!-- rnb-output-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>There are 25 countries still with no assigned world region. Further clean up is needed but it would require an external data source or doing it manually. We’ll use an extra world region “UNKNOWN” to tag them</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxubGV2ZWxzKGtpdmFfYnlfcmVnaW9uJHdvcmxkX3JlZ2lvbikgPC0gYyhsZXZlbHMoa2l2YV9ieV9yZWdpb24kd29ybGRfcmVnaW9uKSwgJ1VOS09XTicpXG5raXZhX2J5X3JlZ2lvbiR3b3JsZF9yZWdpb25baXMubmEoa2l2YV9ieV9yZWdpb24kd29ybGRfcmVnaW9uKV0gPC0gJ1VOS09XTidcbmxldmVscyhraXZhX3dpdGhfcmVnaW9uJHdvcmxkX3JlZ2lvbikgPC0gYyhsZXZlbHMoa2l2YV93aXRoX3JlZ2lvbiR3b3JsZF9yZWdpb24pLCAnVU5LT1dOJylcbmtpdmFfd2l0aF9yZWdpb24kd29ybGRfcmVnaW9uW2lzLm5hKGtpdmFfd2l0aF9yZWdpb24kd29ybGRfcmVnaW9uKV0gPC0gJ1VOS09XTidcbmBgYCJ9 --> 
  <pre class="r"><code>levels(kiva_by_region$world_region) &lt;- c(levels(kiva_by_region$world_region), 'UNKOWN')
kiva_by_region$world_region[is.na(kiva_by_region$world_region)] &lt;- 'UNKOWN'
levels(kiva_with_region$world_region) &lt;- c(levels(kiva_with_region$world_region), 'UNKOWN')
kiva_with_region$world_region[is.na(kiva_with_region$world_region)] &lt;- 'UNKOWN'</code></pre> <!-- rnb-source-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>Clean up the data as discussed above</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxua2l2YV9ieV9yZWdpb25fY2xlYW4gPC0ga2l2YV9ieV9yZWdpb25cbm1hcF9kYXRhX3dvcmxkIDwtIG1hcF9kYXRhKFwid29ybGRcIilcbm1hcF9kYXRhX3dvcmxkWywnd29ybGRfcmVnaW9uJ108LSBOQVxubWFwX2RhdGFfd29ybGRfc3BsaXQgPC0gbWFwX2RhdGFfd29ybGRbMDowLF1cbnJlZ2lvbnNfbGltcyA8LSBsaXN0KGxpc3Qod29ybGRfcmVnaW9uPSdMYXRpbiBBbWVyaWNhIGFuZCBDYXJpYmJlYW4nLCB5bGltPWMoLTYwLDMwKSwgeGxpbT1jKC0xMjAsLTMwKSksXG4gICAgICAgICAgICAgICAgICAgICBsaXN0KHdvcmxkX3JlZ2lvbj0nU3ViLVNhaGFyYW4gQWZyaWNhJywgeWxpbT1jKC0zNSwzNSksIHhsaW09YygtMzAsNjApKSxcbiAgICAgICAgICAgICAgICAgICAgIGxpc3Qod29ybGRfcmVnaW9uPSdBcmFiIFN0YXRlcycsIHlsaW09YygtNSwzNSksIHhsaW09YygzMCw2MCkpLFxuICAgICAgICAgICAgICAgICAgICAgbGlzdCh3b3JsZF9yZWdpb249J0Vhc3QgQXNpYSBhbmQgdGhlIFBhY2lmaWMnLCB5bGltPWMoLTYwLDE4MCksIHhsaW09Yyg5MCwxMDAwKSksXG4gICAgICAgICAgICAgICAgICAgICBsaXN0KHdvcmxkX3JlZ2lvbj0nRXVyb3BlIGFuZCBDZW50cmFsIEFzaWEnLCB5bGltPWMoMjAsMjAwKSwgeGxpbT1jKC0yMCw5MCkpLFxuICAgICAgICAgICAgICAgICAgICAgbGlzdCh3b3JsZF9yZWdpb249J1NvdXRoIEFzaWEnLCB5bGltPWMoMCw1MCksIHhsaW09Yyg2MCwxMDApKVxuICAgICAgICAgICAgICAgICAgICAgKVxuZm9yKHJsIGluIHJlZ2lvbnNfbGltcyl7XG4gICBuZXdfcGFydCA8LSBtYXBfZGF0YV93b3JsZFttYXBfZGF0YV93b3JsZCRsb25nPnJsJHhsaW1bMV0gJiBtYXBfZGF0YV93b3JsZCRsb25nPHJsJHhsaW1bMl0gJiBtYXBfZGF0YV93b3JsZCRsYXQ+cmwkeWxpbVsxXSAmIG1hcF9kYXRhX3dvcmxkJGxhdDxybCR5bGltWzJdLF1cbiAgIG5ld19wYXJ0JHdvcmxkX3JlZ2lvbiA8LSBybCR3b3JsZF9yZWdpb25cbiAgIG1hcF9kYXRhX3dvcmxkX3NwbGl0IDwtIHJiaW5kKG1hcF9kYXRhX3dvcmxkX3NwbGl0LCBuZXdfcGFydClcbiAgIG1hc2sgPC0gIShraXZhX2J5X3JlZ2lvbl9jbGVhbiRsb24+cmwkeGxpbVsxXSAmIGtpdmFfYnlfcmVnaW9uX2NsZWFuJGxvbjxybCR4bGltWzJdICYga2l2YV9ieV9yZWdpb25fY2xlYW4kbGF0PnJsJHlsaW1bMV0gJiBraXZhX2J5X3JlZ2lvbl9jbGVhbiRsYXQ8cmwkeWxpbVsyXSlcbiAgIG1hc2tbaXMubmEobWFzayldIDwtIFRSVUVcbiAgIG1hc2sgPC0gbWFzayAmIGtpdmFfYnlfcmVnaW9uX2NsZWFuJHdvcmxkX3JlZ2lvbj09cmwkd29ybGRfcmVnaW9uXG4gICBraXZhX2J5X3JlZ2lvbl9jbGVhblttYXNrLCBjKCdsYXQnLCdsb24nKV0gPC0gTkFcbiAgIFxuICAgbWFzayA8LSAhKGtpdmFfYnlfcmVnaW9uX2NsZWFuJGxvbl9pbXA+cmwkeGxpbVsxXSAmIGtpdmFfYnlfcmVnaW9uX2NsZWFuJGxvbl9pbXA8cmwkeGxpbVsyXSAmIGtpdmFfYnlfcmVnaW9uX2NsZWFuJGxhdF9pbXA+cmwkeWxpbVsxXSAmIGtpdmFfYnlfcmVnaW9uX2NsZWFuJGxhdF9pbXA8cmwkeWxpbVsyXSlcbiAgIG1hc2tbaXMubmEobWFzayldIDwtIFRSVUVcbiAgIG1hc2sgPC0gbWFzayAmIGtpdmFfYnlfcmVnaW9uX2NsZWFuJHdvcmxkX3JlZ2lvbj09cmwkd29ybGRfcmVnaW9uXG4gICBraXZhX2J5X3JlZ2lvbl9jbGVhblttYXNrLCBjKCdsYXRfaW1wJywnbG9uX2ltcCcpXSA8LSBOQVxufVxuIyBJbXB1dGUgd2l0aCB0aGUgY291bnRyeSBtZWRpYW4gbGF0L2xvblxua2l2YV9ieV9yZWdpb25fY2xlYW5baXMubmEoa2l2YV9ieV9yZWdpb25fY2xlYW4kbGF0KSwgYygnbGF0JywnbG9uJyldIDwtIGtpdmFfYnlfcmVnaW9uX2NsZWFuW2lzLm5hKGtpdmFfYnlfcmVnaW9uX2NsZWFuJGxhdCksIGMoJ2xhdF9pbXAnLCdsb25faW1wJyldXG5raXZhX3dpdGhfcmVnaW9uW2lzLm5hKGtpdmFfYnlfcmVnaW9uJGxhdCksIGMoJ2xhdCcsJ2xvbicpXSA8LSBraXZhX3dpdGhfcmVnaW9uW2lzLm5hKGtpdmFfYnlfcmVnaW9uJGxhdCksIGMoJ2xhdF9pbXAnLCdsb25faW1wJyldXG5gYGAifQ== --> 
  <pre class="r"><code>kiva_by_region_clean &lt;- kiva_by_region
map_data_world &lt;- map_data("world")
map_data_world[,'world_region']&lt;- NA
map_data_world_split &lt;- map_data_world[0:0,]
regions_lims &lt;- list(list(world_region='Latin America and Caribbean', ylim=c(-60,30), xlim=c(-120,-30)),
                     list(world_region='Sub-Saharan Africa', ylim=c(-35,35), xlim=c(-30,60)),
                     list(world_region='Arab States', ylim=c(-5,35), xlim=c(30,60)),
                     list(world_region='East Asia and the Pacific', ylim=c(-60,180), xlim=c(90,1000)),
                     list(world_region='Europe and Central Asia', ylim=c(20,200), xlim=c(-20,90)),
                     list(world_region='South Asia', ylim=c(0,50), xlim=c(60,100))
                     )
for(rl in regions_lims){
   new_part &lt;- map_data_world[map_data_world$long&gt;rl$xlim[1] &amp; map_data_world$long&lt;rl$xlim[2] &amp; map_data_world$lat&gt;rl$ylim[1] &amp; map_data_world$lat&lt;rl$ylim[2],]
   new_part$world_region &lt;- rl$world_region
   map_data_world_split &lt;- rbind(map_data_world_split, new_part)
   mask &lt;- !(kiva_by_region_clean$lon&gt;rl$xlim[1] &amp; kiva_by_region_clean$lon&lt;rl$xlim[2] &amp; kiva_by_region_clean$lat&gt;rl$ylim[1] &amp; kiva_by_region_clean$lat&lt;rl$ylim[2])
   mask[is.na(mask)] &lt;- TRUE
   mask &lt;- mask &amp; kiva_by_region_clean$world_region==rl$world_region
   kiva_by_region_clean[mask, c('lat','lon')] &lt;- NA
   
   mask &lt;- !(kiva_by_region_clean$lon_imp&gt;rl$xlim[1] &amp; kiva_by_region_clean$lon_imp&lt;rl$xlim[2] &amp; kiva_by_region_clean$lat_imp&gt;rl$ylim[1] &amp; kiva_by_region_clean$lat_imp&lt;rl$ylim[2])
   mask[is.na(mask)] &lt;- TRUE
   mask &lt;- mask &amp; kiva_by_region_clean$world_region==rl$world_region
   kiva_by_region_clean[mask, c('lat_imp','lon_imp')] &lt;- NA
}
# Impute with the country median lat/lon
kiva_by_region_clean[is.na(kiva_by_region_clean$lat), c('lat','lon')] &lt;- kiva_by_region_clean[is.na(kiva_by_region_clean$lat), c('lat_imp','lon_imp')]
kiva_with_region[is.na(kiva_by_region$lat), c('lat','lon')] &lt;- kiva_with_region[is.na(kiva_by_region$lat), c('lat_imp','lon_imp')]</code></pre> <!-- rnb-source-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuZ2dwbG90KGtpdmFfYnlfcmVnaW9uX2NsZWFuW2tpdmFfYnlfcmVnaW9uX2NsZWFuJHdvcmxkX3JlZ2lvbiE9J1VOS09XTicsXSkrXG4gIGdlb21fcG9seWdvbihkYXRhPW1hcF9kYXRhX3dvcmxkX3NwbGl0LCBhZXMoeCA9IGxvbmcsIHkgPSBsYXQsIGdyb3VwID0gZ3JvdXApLCBmaWxsPVwiI0YwRjBGMFwiLCBjb2xvdXIgPSBcImxpZ2h0Z3JheVwiKStcbiAgZ2VvbV9wb2ludChtYXBwaW5nID0gYWVzKHg9bG9uLCB5PWxhdCwgc2l6ZSA9IGxvYW5fYW1vdW50X3N1bSksIGFscGhhPTAuMywgY29sb3I9J2RhcmtyZWQnLCBwb3NpdGlvbiA9IHBvc2l0aW9uX2ppdHRlcih3ID0gMSwgaCA9IDEpKStcbiAgY29vcmRfcXVpY2ttYXAoKStcbiAgZmFjZXRfd3JhcCh+d29ybGRfcmVnaW9uLCAgc2NhbGVzID0gXCJmcmVlXCIpK1xuICBnZ3RpdGxlKFwiTG9jYXRpb24gb2YgTG9hbnMgYnkgV29ybGQgUmVnaW9uXCIpICsgXG4gIHNjYWxlX3NpemUobGFiZWwgPSBmZl9taWxscyhwcmVmaXggPSckJyksIGJyZWFrcyA9IGMoMWUrNiwyZSs2LDRlKzYsNmUrNikpK1xuICBjaXRzNDAwOV9tYXBfdGhlbWVcbmBgYCJ9 --> 
  <pre class="r"><code>ggplot(kiva_by_region_clean[kiva_by_region_clean$world_region!='UNKOWN',])+
  geom_polygon(data=map_data_world_split, aes(x = long, y = lat, group = group), fill="#F0F0F0", colour = "lightgray")+
  geom_point(mapping = aes(x=lon, y=lat, size = loan_amount_sum), alpha=0.3, color='darkred', position = position_jitter(w = 1, h = 1))+
  coord_quickmap()+
  facet_wrap(~world_region,  scales = "free")+
  ggtitle("Location of Loans by World Region") + 
  scale_size(label = ff_mills(prefix ='$'), breaks = c(1e+6,2e+6,4e+6,6e+6))+
  cits4009_map_theme</code></pre> <!-- rnb-source-end --> <!-- rnb-plot-begin eyJjb25kaXRpb25zIjpbWzEsIlJlbW92ZWQgNTAwMyByb3dzIGNvbnRhaW5pbmcgbWlzc2luZyB2YWx1ZXMgKGdlb21fcG9pbnQpLiJdXSwiaGVpZ2h0Ijo3LjQxNjYsInNpemVfYmVoYXZpb3IiOjEsIndpZHRoIjoxMn0= --> 
  <p><img src="image10.png" /></p> <!-- rnb-plot-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>The plot seems more sensible now. Most loans accumulate around a few locations in each world region.</p> 
 </div> 
 <div id="data-by-sector-region-and-gender" class="section level3"> 
  <h3>Data by sector, region and gender</h3> 
  <p>Analyze for what sector and activity the loans are for</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxua2l2YV9ieV9hY3Rpdml0eSA8LSBraXZhX3dpdGhfcmVnaW9uICU+JSBcbiAgICAgICAgZ3JvdXBfYnkoLmRvdHM9Yygnc2VjdG9yJywgJ2FjdGl2aXR5JykpICU+JSBcbiAgICAgICAgc3VtbWFyaXNlKGxvYW5fYW1vdW50X21lYW4gPSBtZWFuKGxvYW5fYW1vdW50LCBuYS5ybSA9IFQpLFxuICAgICAgICAgICAgICAgICAgbG9hbl9hbW91bnRfc3VtID0gc3VtKGxvYW5fYW1vdW50LCBuYS5ybSA9IFQpXG4gICAgICAgICAgICAgICAgICApXG5nZ3Bsb3Qoa2l2YV9ieV9hY3Rpdml0eSwgZ2dwbG90Mjo6YWVzKGFyZWEgPSBsb2FuX2Ftb3VudF9zdW0sIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbCA9IGFjdGl2aXR5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJncm91cCA9IHNlY3RvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsbCA9IHNlY3RvcikpICsgXG4gIGdlb21fdHJlZW1hcCgpICtcbiAgZ2VvbV90cmVlbWFwX3N1Ymdyb3VwX2JvcmRlcigpICtcbiAgZ2VvbV90cmVlbWFwX3N1Ymdyb3VwX3RleHQocGxhY2UgPSBcImNlbnRyZVwiLCBncm93ID0gRiwgYWxwaGEgPSAuNSwgY29sb3VyID1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJXaGl0ZVwiLCBmb250ZmFjZSA9IFwiaXRhbGljXCIsIG1pbi5zaXplID0gMCkgK1xuICBnZW9tX3RyZWVtYXBfdGV4dChjb2xvdXIgPSBcImJsYWNrXCIsIHBsYWNlID0gXCJjZW50cmVcIiwgcmVmbG93ID0gVCwgYWxwaGE9MC43KSArXG4gIGdndGl0bGUoXCJMb2FuIEFtb3VudCBCeSBTZWN0b3IvQWN0aXZpdHlcIikgK1xuICBjaXRzNDAwOV90aGVtZVxuYGBgIn0= --> 
  <pre class="r"><code>kiva_by_activity &lt;- kiva_with_region %&gt;% 
        group_by(.dots=c('sector', 'activity')) %&gt;% 
        summarise(loan_amount_mean = mean(loan_amount, na.rm = T),
                  loan_amount_sum = sum(loan_amount, na.rm = T)
                  )
ggplot(kiva_by_activity, ggplot2::aes(area = loan_amount_sum, 
                                      label = activity,
                                      subgroup = sector,
                                      fill = sector)) + 
  geom_treemap() +
  geom_treemap_subgroup_border() +
  geom_treemap_subgroup_text(place = "centre", grow = F, alpha = .5, colour =
                             "White", fontface = "italic", min.size = 0) +
  geom_treemap_text(colour = "black", place = "centre", reflow = T, alpha=0.7) +
  ggtitle("Loan Amount By Sector/Activity") +
  cits4009_theme</code></pre> <!-- rnb-source-end --> <!-- rnb-plot-begin eyJjb25kaXRpb25zIjpbXSwiaGVpZ2h0Ijo3LjQxNjYsInNpemVfYmVoYXZpb3IiOjEsIndpZHRoIjoxMn0= --> 
  <p><img src="image11.png" /></p> <!-- rnb-plot-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>There are 3 main sectors, Agriculture, Retail and Food. Within the sectos, the much of the largest activities are not very usefully labeld (e.g Food in Food, Retail in Retail).</p> 
  <p>Analyze if different world regions have different types of loans</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxua2l2YV9ieV9hY3Rpdml0eV93cmVnaW9uIDwtIGtpdmFfd2l0aF9yZWdpb24gJT4lIFxuICAgICAgICBncm91cF9ieSguZG90cz1jKCdzZWN0b3InLCAnd29ybGRfcmVnaW9uJykpICU+JSBcbiAgICAgICAgc3VtbWFyaXNlKGxvYW5fYW1vdW50X21lYW4gPSBtZWFuKGxvYW5fYW1vdW50LCBuYS5ybSA9IFQpLFxuICAgICAgICAgICAgICAgICAgbG9hbl9hbW91bnRfc3VtID0gc3VtKGxvYW5fYW1vdW50LCBuYS5ybSA9IFQpLFxuICAgICAgICAgICAgICAgICAgbG9hbl9jb3VudCA9IHN1bShsb2FuX2Ftb3VudCowKzEsIG5hLnJtID0gVClcbiAgICAgICAgICAgICAgICAgIClcbmtpdmFfdG90YWxfYnlfcmVnaW9uIDwtIGtpdmFfYnlfYWN0aXZpdHlfd3JlZ2lvbiAlPiUgZ3JvdXBfYnkod29ybGRfcmVnaW9uKSAlPiUgc3VtbWFyaXNlKHRvdGFsX2xvYW5zID0gc3VtKGxvYW5fY291bnQsIG5hLnJtID0gVCkpXG5raXZhX2J5X2FjdGl2aXR5X3dyZWdpb24gPC0gbWVyZ2Uoa2l2YV9ieV9hY3Rpdml0eV93cmVnaW9uLCBraXZhX3RvdGFsX2J5X3JlZ2lvbiwgYnk9J3dvcmxkX3JlZ2lvbicpXG5raXZhX2J5X2FjdGl2aXR5X3dyZWdpb24kbG9hbl9wZXJjZW50YWdlIDwtIGtpdmFfYnlfYWN0aXZpdHlfd3JlZ2lvbiRsb2FuX2NvdW50IC8ga2l2YV9ieV9hY3Rpdml0eV93cmVnaW9uJHRvdGFsX2xvYW5zICogMTAwXG5nZ3Bsb3Qoa2l2YV9ieV9hY3Rpdml0eV93cmVnaW9uLCBtYXBwaW5nID0gYWVzKHggPSBzZWN0b3IsIHkgPSB3b3JsZF9yZWdpb24pKSArIFxuICBnZW9tX2NvdW50KG1hcHBpbmcgPSBhZXMoc2l6ZT1sb2FuX3BlcmNlbnRhZ2UsIGNvbG9yPWxvYW5fYW1vdW50X3N1bSkpICtcbiAgZ2d0aXRsZShcIkxvYW5zICUgb2YgUmVnaW9uIEJ5IFNlY3RvclwiKSArXG4gIHNjYWxlX2NvbG9yX2NvbnRpbnVvdXMobG93ID0gXCJibGFja1wiLCBoaWdoID0gXCJyZWRcIiwgbGFiZWwgPSBmZl9taWxscyhwcmVmaXggPSckJykpICtcbiAgc2NhbGVfc2l6ZV9jb250aW51b3VzKHJhbmdlID0gYygwLjEsIDE1KSwgbGFiZWwgPSBmZl9wZXJjZW50KGRpZ2l0cz0wKSkgK1xuICBjaXRzNDAwOV90aGVtZSArXG4gIHRoZW1lKGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KGFuZ2xlID0gOTAsIGhqdXN0ID0gMSwgc2l6ZSA9IDE0KSxcbiAgICAgICAgYXhpcy50ZXh0LnkgPSBlbGVtZW50X3RleHQoYW5nbGUgPSAgMCwgc2l6ZSA9IDE0KSxcbiAgICAgICAgYXhpcy50aXRsZS54ID0gZWxlbWVudF9ibGFuaygpLFxuICAgICAgICBheGlzLnRpdGxlLnkgPSBlbGVtZW50X2JsYW5rKCkpXG5gYGAifQ== --> 
  <pre class="r"><code>kiva_by_activity_wregion &lt;- kiva_with_region %&gt;% 
        group_by(.dots=c('sector', 'world_region')) %&gt;% 
        summarise(loan_amount_mean = mean(loan_amount, na.rm = T),
                  loan_amount_sum = sum(loan_amount, na.rm = T),
                  loan_count = sum(loan_amount*0+1, na.rm = T)
                  )
kiva_total_by_region &lt;- kiva_by_activity_wregion %&gt;% group_by(world_region) %&gt;% summarise(total_loans = sum(loan_count, na.rm = T))
kiva_by_activity_wregion &lt;- merge(kiva_by_activity_wregion, kiva_total_by_region, by='world_region')
kiva_by_activity_wregion$loan_percentage &lt;- kiva_by_activity_wregion$loan_count / kiva_by_activity_wregion$total_loans * 100
ggplot(kiva_by_activity_wregion, mapping = aes(x = sector, y = world_region)) + 
  geom_count(mapping = aes(size=loan_percentage, color=loan_amount_sum)) +
  ggtitle("Loans % of Region By Sector") +
  scale_color_continuous(low = "black", high = "red", label = ff_mills(prefix ='$')) +
  scale_size_continuous(range = c(0.1, 15), label = ff_percent(digits=0)) +
  cits4009_theme +
  theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 14),
        axis.text.y = element_text(angle =  0, size = 14),
        axis.title.x = element_blank(),
        axis.title.y = element_blank())</code></pre> <!-- rnb-source-end --> <!-- rnb-plot-begin eyJjb25kaXRpb25zIjpbXSwiaGVpZ2h0Ijo2LCJzaXplX2JlaGF2aW9yIjoxLCJ3aWR0aCI6MTJ9 --> 
  <p><img src="image12.png" /></p> <!-- rnb-plot-end --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuTkFcbmBgYCJ9 --> 
  <pre class="r"><code>NA</code></pre> <!-- rnb-source-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>We can see that there’s difference in the way each region uses the loans. For instance, the Arab States have a larger percentage dedicated to “Education” than other regions. Sub-Saharan Africa and Latin America and Caribbean have very similar profiles.</p> 
  <p>Analyze if the loan sector and borrower gender are related</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuIyBDcmVhdGUgYSBcImdlbmRlciB0eXBlXCIgdmFyaWFibGUgdG8gc3VtbWFyaXplIHRoZSBnZW5kZXIgaW5mb3JtYXRpb25cbmtpdmFfd2l0aF9yZWdpb24kZ2VuZGVyX3R5cGUgPC0gJ1Vua293bidcbmtpdmFfd2l0aF9yZWdpb24kZ2VuZGVyX3R5cGVba2l2YV93aXRoX3JlZ2lvbiRib3Jyb3dlcnNfZmVtYWxlcz4wXSA8LSAnRmVtYWxlJ1xua2l2YV93aXRoX3JlZ2lvbiRnZW5kZXJfdHlwZVtraXZhX3dpdGhfcmVnaW9uJGJvcnJvd2Vyc19tYWxlcz4wXSA8LSAnTWFsZSdcbmtpdmFfd2l0aF9yZWdpb24kZ2VuZGVyX3R5cGVba2l2YV93aXRoX3JlZ2lvbiRib3Jyb3dlcnNfZmVtYWxlcz4wICYga2l2YV93aXRoX3JlZ2lvbiRib3Jyb3dlcnNfbWFsZXM+MF0gPC0gJ0JvdGgnXG5raXZhX2J5X2FjdGl2aXR5X2dlbmRlcl90eXBlIDwtIGtpdmFfd2l0aF9yZWdpb24gJT4lIFxuICAgICAgICBncm91cF9ieSguZG90cz1jKCdzZWN0b3InLCAnZ2VuZGVyX3R5cGUnKSkgJT4lIFxuICAgICAgICBzdW1tYXJpc2UobG9hbl9hbW91bnRfbWVhbiA9IG1lYW4obG9hbl9hbW91bnQsIG5hLnJtID0gVCksXG4gICAgICAgICAgICAgICAgICBsb2FuX2Ftb3VudF9zdW0gPSBzdW0obG9hbl9hbW91bnQsIG5hLnJtID0gVCksXG4gICAgICAgICAgICAgICAgICBsb2FuX2NvdW50ID0gc3VtKGxvYW5fYW1vdW50KjArMSwgbmEucm0gPSBUKVxuICAgICAgICAgICAgICAgICAgKVxua2l2YV90b3RhbF9ieV9nZW5kZXJfdHlwZSA8LSBraXZhX2J5X2FjdGl2aXR5X2dlbmRlcl90eXBlICU+JSBncm91cF9ieShnZW5kZXJfdHlwZSkgJT4lIHN1bW1hcmlzZSh0b3RhbF9sb2FucyA9IHN1bShsb2FuX2NvdW50LCBuYS5ybSA9IFQpKVxua2l2YV9ieV9hY3Rpdml0eV9nZW5kZXJfdHlwZSA8LSBtZXJnZShraXZhX2J5X2FjdGl2aXR5X2dlbmRlcl90eXBlLCBraXZhX3RvdGFsX2J5X2dlbmRlcl90eXBlLCBieT0nZ2VuZGVyX3R5cGUnKVxua2l2YV9ieV9hY3Rpdml0eV9nZW5kZXJfdHlwZSRsb2FuX3BlcmNlbnRhZ2UgPC0ga2l2YV9ieV9hY3Rpdml0eV9nZW5kZXJfdHlwZSRsb2FuX2NvdW50IC8ga2l2YV9ieV9hY3Rpdml0eV9nZW5kZXJfdHlwZSR0b3RhbF9sb2FucyAqIDEwMFxuZ2dwbG90KGtpdmFfYnlfYWN0aXZpdHlfZ2VuZGVyX3R5cGUsIG1hcHBpbmcgPSBhZXMoeCA9IHNlY3RvciwgeSA9IGdlbmRlcl90eXBlKSkgKyBcbiAgI2dlb21fdGlsZShtYXBwaW5nID0gYWVzKGZpbGw9bG9hbl9hbW91bnRfc3VtKSkgK1xuICBnZW9tX2NvdW50KG1hcHBpbmcgPSBhZXMoc2l6ZT1sb2FuX3BlcmNlbnRhZ2UsIGNvbG9yPWxvYW5fYW1vdW50X3N1bSkpICtcbiAgZ2d0aXRsZShcIkxvYW5zICUgb2YgR2VuZGVyIFR5cGUgQnkgU2VjdG9yXCIpICtcbiAgc2NhbGVfY29sb3JfY29udGludW91cyhsb3cgPSBcImJsYWNrXCIsIGhpZ2ggPSBcInJlZFwiLCBsYWJlbCA9IGZmX21pbGxzKHByZWZpeCA9JyQnKSkgK1xuICBzY2FsZV9zaXplX2NvbnRpbnVvdXMocmFuZ2UgPSBjKDAuMSwgMTUpLCBsYWJlbCA9IGZmX3BlcmNlbnQoZGlnaXRzPTApKSArXG4gIGNpdHM0MDA5X3RoZW1lICtcbiAgdGhlbWUoYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSA5MCwgaGp1c3QgPSAxLCBzaXplID0gMTQpLFxuICAgICAgICBheGlzLnRleHQueSA9IGVsZW1lbnRfdGV4dChhbmdsZSA9ICAwLCBzaXplID0gMTQpLFxuICAgICAgICBheGlzLnRpdGxlLnggPSBlbGVtZW50X2JsYW5rKCksXG4gICAgICAgIGF4aXMudGl0bGUueSA9IGVsZW1lbnRfYmxhbmsoKSlcbmBgYCJ9 --> 
  <pre class="r"><code># Create a "gender type" variable to summarize the gender information
kiva_with_region$gender_type &lt;- 'Unkown'
kiva_with_region$gender_type[kiva_with_region$borrowers_females&gt;0] &lt;- 'Female'
kiva_with_region$gender_type[kiva_with_region$borrowers_males&gt;0] &lt;- 'Male'
kiva_with_region$gender_type[kiva_with_region$borrowers_females&gt;0 &amp; kiva_with_region$borrowers_males&gt;0] &lt;- 'Both'
kiva_by_activity_gender_type &lt;- kiva_with_region %&gt;% 
        group_by(.dots=c('sector', 'gender_type')) %&gt;% 
        summarise(loan_amount_mean = mean(loan_amount, na.rm = T),
                  loan_amount_sum = sum(loan_amount, na.rm = T),
                  loan_count = sum(loan_amount*0+1, na.rm = T)
                  )
kiva_total_by_gender_type &lt;- kiva_by_activity_gender_type %&gt;% group_by(gender_type) %&gt;% summarise(total_loans = sum(loan_count, na.rm = T))
kiva_by_activity_gender_type &lt;- merge(kiva_by_activity_gender_type, kiva_total_by_gender_type, by='gender_type')
kiva_by_activity_gender_type$loan_percentage &lt;- kiva_by_activity_gender_type$loan_count / kiva_by_activity_gender_type$total_loans * 100
ggplot(kiva_by_activity_gender_type, mapping = aes(x = sector, y = gender_type)) + 
  #geom_tile(mapping = aes(fill=loan_amount_sum)) +
  geom_count(mapping = aes(size=loan_percentage, color=loan_amount_sum)) +
  ggtitle("Loans % of Gender Type By Sector") +
  scale_color_continuous(low = "black", high = "red", label = ff_mills(prefix ='$')) +
  scale_size_continuous(range = c(0.1, 15), label = ff_percent(digits=0)) +
  cits4009_theme +
  theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 14),
        axis.text.y = element_text(angle =  0, size = 14),
        axis.title.x = element_blank(),
        axis.title.y = element_blank())</code></pre> <!-- rnb-source-end --> <!-- rnb-plot-begin eyJjb25kaXRpb25zIjpbXSwiaGVpZ2h0Ijo2LCJzaXplX2JlaGF2aW9yIjoxLCJ3aWR0aCI6MTJ9 --> 
  <p><img src="image13.png" /></p> <!-- rnb-plot-end --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuTkFcbmBgYCJ9 --> 
  <pre class="r"><code>NA</code></pre> <!-- rnb-source-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>The 4 categories are very similar on their distribution of loan sector, but there are some differences. For instance, “Personal Use” loans are more common when the borrower include both genders.</p> 
  <p>We can use Correspondence Analysis (CA) to further understand this correlation. CA provides a graphic method of exploring the relationship between variables in a contingency table</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuIyBDb3JyZXNwb25kZW5jZSBBbmFseXNpc1xuIyBDb2RlIGluIHRoaXMgYmxvY2sgaXMgYWRhcHRlZCBmcm9tIGh0dHBzOi8vd3d3LnN0YXRtZXRob2RzLm5ldC9hZHZzdGF0cy9jYS5odG1sXG50YWJsZSA8LSBkY2FzdChraXZhX2J5X2FjdGl2aXR5X2dlbmRlcl90eXBlLCBnZW5kZXJfdHlwZX5zZWN0b3IsIHZhbHVlLnZhciA9IFwibG9hbl9jb3VudFwiKVxucm93bmFtZXModGFibGUpIDwtIHRhYmxlJGdlbmRlcl90eXBlXG50YWJsZSRnZW5kZXJfdHlwZSA8LSBOVUxMXG5maXQgPC0gY2EodGFibGUpXG4jIHByaW50KGZpdCkgIyBiYXNpYyByZXN1bHRzXG4jIHN1bW1hcnkoZml0KSAjIGV4dGVuZGVkIHJlc3VsdHNcbnBsb3QoZml0LCBtYXNzID0gVFJVRSwgY29udHJpYiA9IFwiYWJzb2x1dGVcIiwgbWFwID1cbiAgIFwicm93Z3JlZW5cIiwgYXJyb3dzID0gYyhGQUxTRSwgVFJVRSkpICMgYXN5bW1ldHJpYyBtYXAgXG5gYGAifQ== --> 
  <pre class="r"><code># Correspondence Analysis
# Code in this block is adapted from https://www.statmethods.net/advstats/ca.html
table &lt;- dcast(kiva_by_activity_gender_type, gender_type~sector, value.var = "loan_count")
rownames(table) &lt;- table$gender_type
table$gender_type &lt;- NULL
fit &lt;- ca(table)
# print(fit) # basic results
# summary(fit) # extended results
plot(fit, mass = TRUE, contrib = "absolute", map =
   "rowgreen", arrows = c(FALSE, TRUE)) # asymmetric map </code></pre> <!-- rnb-source-end --> <!-- rnb-plot-begin eyJjb25kaXRpb25zIjpbXSwiaGVpZ2h0Ijo2LCJzaXplX2JlaGF2aW9yIjoxLCJ3aWR0aCI6MTJ9 --> 
  <p><img src="image14.png" /></p> <!-- rnb-plot-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>We can see that Male borrowers are more related to Agriculture, Transportation, Construction and Education; Female with Arts, Retail, Clothing and Food, and that Personal Use is related with borrowers that include Both genders.</p> 
  <p>Analyze if the world region and borrower gender are related</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxua2l2YV9ieV9yZWdpb25fZ2VuZGVyX3R5cGUgPC0ga2l2YV93aXRoX3JlZ2lvbiAlPiUgXG4gICAgICAgIGdyb3VwX2J5KC5kb3RzPWMoJ3dvcmxkX3JlZ2lvbicsICdnZW5kZXJfdHlwZScpKSAlPiUgXG4gICAgICAgIHN1bW1hcmlzZShsb2FuX2Ftb3VudF9tZWFuID0gbWVhbihsb2FuX2Ftb3VudCwgbmEucm0gPSBUKSxcbiAgICAgICAgICAgICAgICAgIGxvYW5fYW1vdW50X3N1bSA9IHN1bShsb2FuX2Ftb3VudCwgbmEucm0gPSBUKSxcbiAgICAgICAgICAgICAgICAgIGxvYW5fY291bnQgPSBzdW0obG9hbl9hbW91bnQqMCsxLCBuYS5ybSA9IFQpXG4gICAgICAgICAgICAgICAgICApXG5raXZhX2J5X3JlZ2lvbl9nZW5kZXJfdHlwZSA8LSBtZXJnZShraXZhX2J5X3JlZ2lvbl9nZW5kZXJfdHlwZSwga2l2YV90b3RhbF9ieV9yZWdpb24sIGJ5PSd3b3JsZF9yZWdpb24nKVxua2l2YV9ieV9yZWdpb25fZ2VuZGVyX3R5cGUkbG9hbl9wZXJjZW50YWdlIDwtIGtpdmFfYnlfcmVnaW9uX2dlbmRlcl90eXBlJGxvYW5fY291bnQgLyBraXZhX2J5X3JlZ2lvbl9nZW5kZXJfdHlwZSR0b3RhbF9sb2FucyAqIDEwMFxuZ2dwbG90KGtpdmFfYnlfcmVnaW9uX2dlbmRlcl90eXBlLCBtYXBwaW5nID0gYWVzKHggPSBnZW5kZXJfdHlwZSwgeSA9IHdvcmxkX3JlZ2lvbikpICsgXG4gIGdlb21fY291bnQobWFwcGluZyA9IGFlcyhzaXplPWxvYW5fcGVyY2VudGFnZSwgY29sb3I9bG9hbl9hbW91bnRfc3VtKSkgK1xuICBnZ3RpdGxlKFwiTG9hbnMgJSBvZiBSZWdpb24gQnkgR2VuZGVyXCIpICtcbiAgc2NhbGVfY29sb3JfY29udGludW91cyhsb3cgPSBcImJsYWNrXCIsIGhpZ2ggPSBcInJlZFwiLCBsYWJlbCA9IGZmX21pbGxzKHByZWZpeCA9JyQnKSkgK1xuICBzY2FsZV9zaXplX2NvbnRpbnVvdXMocmFuZ2UgPSBjKDAuMSwgMTUpLCBsYWJlbCA9IGZmX3BlcmNlbnQoZGlnaXRzPTApKSArXG4gIGNpdHM0MDA5X3RoZW1lICtcbiAgdGhlbWUoYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSA5MCwgaGp1c3QgPSAxLCBzaXplID0gMTQpLFxuICAgICAgICBheGlzLnRleHQueSA9IGVsZW1lbnRfdGV4dChhbmdsZSA9ICAwLCBzaXplID0gMTQpLFxuICAgICAgICBheGlzLnRpdGxlLnggPSBlbGVtZW50X2JsYW5rKCksXG4gICAgICAgIGF4aXMudGl0bGUueSA9IGVsZW1lbnRfYmxhbmsoKSlcbmBgYCJ9 --> 
  <pre class="r"><code>kiva_by_region_gender_type &lt;- kiva_with_region %&gt;% 
        group_by(.dots=c('world_region', 'gender_type')) %&gt;% 
        summarise(loan_amount_mean = mean(loan_amount, na.rm = T),
                  loan_amount_sum = sum(loan_amount, na.rm = T),
                  loan_count = sum(loan_amount*0+1, na.rm = T)
                  )
kiva_by_region_gender_type &lt;- merge(kiva_by_region_gender_type, kiva_total_by_region, by='world_region')
kiva_by_region_gender_type$loan_percentage &lt;- kiva_by_region_gender_type$loan_count / kiva_by_region_gender_type$total_loans * 100
ggplot(kiva_by_region_gender_type, mapping = aes(x = gender_type, y = world_region)) + 
  geom_count(mapping = aes(size=loan_percentage, color=loan_amount_sum)) +
  ggtitle("Loans % of Region By Gender") +
  scale_color_continuous(low = "black", high = "red", label = ff_mills(prefix ='$')) +
  scale_size_continuous(range = c(0.1, 15), label = ff_percent(digits=0)) +
  cits4009_theme +
  theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 14),
        axis.text.y = element_text(angle =  0, size = 14),
        axis.title.x = element_blank(),
        axis.title.y = element_blank())</code></pre> <!-- rnb-source-end --> <!-- rnb-plot-begin eyJjb25kaXRpb25zIjpbXSwiaGVpZ2h0Ijo2LCJzaXplX2JlaGF2aW9yIjoxLCJ3aWR0aCI6MTJ9 --> 
  <p><img src="image15.png" /></p> <!-- rnb-plot-end --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuTkFcbmBgYCJ9 --> 
  <pre class="r"><code>NA</code></pre> <!-- rnb-source-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>Female borrowers are predominant in all regions, but this is even more marked in South Asia and East Asia and the Pacific.</p> 
 </div> 
 <div id="trend-by-time" class="section level3"> 
  <h3>Trend by time</h3> 
  <p>Analyze how much money was lend along the years.</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxua2l2YV9ieV9kYXRlIDwtIGtpdmEgJT4lIFxuICAgICAgICBncm91cF9ieSguZG90cz1jKCdkYXRlJykpICU+JSBcbiAgICAgICAgc3VtbWFyaXNlKGxvYW5fYW1vdW50X21lYW4gPSBtZWFuKGxvYW5fYW1vdW50LCBuYS5ybSA9IFQpLFxuICAgICAgICAgICAgICAgICAgbG9hbl9hbW91bnRfc3VtID0gc3VtKGxvYW5fYW1vdW50LCBuYS5ybSA9IFQpLFxuICAgICAgICAgICAgICAgICAgbG9hbl9jb3VudCA9IHN1bShsb2FuX2Ftb3VudCowKzEsIG5hLnJtID0gVClcbiAgICAgICAgICAgICAgICAgIClcbmdncGxvdChkYXRhID0ga2l2YV9ieV9kYXRlLCBtYXBwaW5nID0gYWVzKHggPSBkYXRlLCB5ID0gbG9hbl9hbW91bnRfc3VtKSkgK1xuICBnZW9tX3BvaW50KCkgK1xuICBnZW9tX3Ntb290aChzcGFuPTAuMSkgK1xuICBnZ3RpdGxlKFwiTG9hbiBhbW91bnQgYnkgZGF5XCIpICsgXG4gIGNpdHM0MDA5X3RoZW1lXG5gYGAifQ== --> 
  <pre class="r"><code>kiva_by_date &lt;- kiva %&gt;% 
        group_by(.dots=c('date')) %&gt;% 
        summarise(loan_amount_mean = mean(loan_amount, na.rm = T),
                  loan_amount_sum = sum(loan_amount, na.rm = T),
                  loan_count = sum(loan_amount*0+1, na.rm = T)
                  )
ggplot(data = kiva_by_date, mapping = aes(x = date, y = loan_amount_sum)) +
  geom_point() +
  geom_smooth(span=0.1) +
  ggtitle("Loan amount by day") + 
  cits4009_theme</code></pre> <!-- rnb-source-end --> <!-- rnb-plot-begin eyJjb25kaXRpb25zIjpbWzAsImBnZW9tX3Ntb290aCgpYCB1c2luZyBtZXRob2QgPSAnZ2FtJyBhbmQgZm9ybXVsYSAneSB+IHMoeCwgYnMgPSBcImNzXCIpJ1xuIl1dLCJoZWlnaHQiOjcuNDE2Niwic2l6ZV9iZWhhdmlvciI6MSwid2lkdGgiOjEyfQ== --> 
  <p><img src="image16.png" /></p> <!-- rnb-plot-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>It is clear that there are two different groups. One might be weekdays and the other weekends. The following plot addresses this.</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxua2l2YV9ieV9kYXRlJHdlZWtkYXkgPC0gaXNXZWVrZGF5KGtpdmFfYnlfZGF0ZSRkYXRlLCB3ZGF5PTE6NSlcbmdncGxvdChkYXRhID0ga2l2YV9ieV9kYXRlLCBtYXBwaW5nID0gYWVzKHggPSBkYXRlLCB5ID0gbG9hbl9hbW91bnRfc3VtLCBjb2xvciA9IHdlZWtkYXkpKSArXG4gIGdlb21fcG9pbnQoKSArXG4gIGdlb21fc21vb3RoKHNwYW49MC4xKSArXG4gIGdndGl0bGUoXCJMb2FuIGFtb3VudCBieSBkYXksIHNwbGl0IGJ5IFdlZWtkYXkvV2Vla2VuZFwiKSArIFxuICBjaXRzNDAwOV90aGVtZVxuYGBgIn0= --> 
  <pre class="r"><code>kiva_by_date$weekday &lt;- isWeekday(kiva_by_date$date, wday=1:5)
ggplot(data = kiva_by_date, mapping = aes(x = date, y = loan_amount_sum, color = weekday)) +
  geom_point() +
  geom_smooth(span=0.1) +
  ggtitle("Loan amount by day, split by Weekday/Weekend") + 
  cits4009_theme</code></pre> <!-- rnb-source-end --> <!-- rnb-plot-begin eyJjb25kaXRpb25zIjpbWzAsImBnZW9tX3Ntb290aCgpYCB1c2luZyBtZXRob2QgPSAnbG9lc3MnIGFuZCBmb3JtdWxhICd5IH4geCdcbiJdXSwiaGVpZ2h0Ijo3LjQxNjYsInNpemVfYmVoYXZpb3IiOjEsIndpZHRoIjoxMn0= --> 
  <p><img src="image17.png" /></p> <!-- rnb-plot-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>We can see that in fact weekends and weekdays have different distributions in terms of loan amount. The trend seems so be increasing slightly with time. There’s a notorious drop by the end, but it might be due to incompletely loaded data for the last days of the data set.</p> 
  <p>Now we repeat the analysis but split by “sector”, as different sectors such as agriculture and retail might have different seasonality and general trends</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxua2l2YV9ieV9zZWN0b3JfbW9udGggPC0ga2l2YV93aXRoX3JlZ2lvblssYygnZGF0ZScsJ3NlY3RvcicsJ2xvYW5fYW1vdW50JyldICU+JSBcbiAgICAgICAgZ3JvdXBfYnkoeWVhcihkYXRlKSxtb250aChkYXRlKSxzZWN0b3IpICU+JSBcbiAgICAgICAgc3VtbWFyaXNlKGxvYW5fYW1vdW50X21lYW4gPSBtZWFuKGxvYW5fYW1vdW50LCBuYS5ybSA9IFQpLFxuICAgICAgICAgICAgICAgICAgbG9hbl9hbW91bnRfc3VtID0gc3VtKGxvYW5fYW1vdW50LCBuYS5ybSA9IFQpLFxuICAgICAgICAgICAgICAgICAgbG9hbl9jb3VudCA9IHN1bShsb2FuX2Ftb3VudCowKzEsIG5hLnJtID0gVClcbiAgICAgICAgICAgICAgICAgIClcbmNvbG5hbWVzKGtpdmFfYnlfc2VjdG9yX21vbnRoKSA8LSBjKFwieWVhcl9kYXRlXCIsIFwibW9udGhfZGF0ZVwiLCBcInNlY3RvclwiLCBcImxvYW5fYW1vdW50X21lYW5cIiwgXCJsb2FuX2Ftb3VudF9zdW1cIiwgXCJsb2FuX2NvdW50XCIpXG5raXZhX2J5X3NlY3Rvcl9tb250aCRtb250aF9udW1iZXIgPC0ga2l2YV9ieV9zZWN0b3JfbW9udGgkeWVhcl9kYXRlICsoa2l2YV9ieV9zZWN0b3JfbW9udGgkbW9udGhfZGF0ZS0xKS8xMlxua2l2YV9ieV9zZWN0b3JfbW9udGggPC0ga2l2YV9ieV9zZWN0b3JfbW9udGhba2l2YV9ieV9zZWN0b3JfbW9udGgkeWVhcl9kYXRlPDIwMTcsXSAjIE9ubHkgcGxvdCB0aGUgZnVsbCB5ZWFyc1xuZ2dwbG90KGRhdGEgPSBraXZhX2J5X3NlY3Rvcl9tb250aCwgbWFwcGluZyA9IGFlcyh4ID0gbW9udGhfbnVtYmVyLCB5ID0gbG9hbl9hbW91bnRfc3VtLCBjb2xvciA9IHNlY3RvcikpICtcbiAgZ2VvbV9wb2ludCgpICtcbiAgZ2VvbV9saW5lKCkgK1xuICBnZ3RpdGxlKFwiTG9hbiBhbW91bnQgYnkgbW9udGgsIHNwbGl0IGJ5IFNlY3RvclwiKSArIFxuICBjaXRzNDAwOV90aGVtZVxuYGBgIn0= --> 
  <pre class="r"><code>kiva_by_sector_month &lt;- kiva_with_region[,c('date','sector','loan_amount')] %&gt;% 
        group_by(year(date),month(date),sector) %&gt;% 
        summarise(loan_amount_mean = mean(loan_amount, na.rm = T),
                  loan_amount_sum = sum(loan_amount, na.rm = T),
                  loan_count = sum(loan_amount*0+1, na.rm = T)
                  )
colnames(kiva_by_sector_month) &lt;- c("year_date", "month_date", "sector", "loan_amount_mean", "loan_amount_sum", "loan_count")
kiva_by_sector_month$month_number &lt;- kiva_by_sector_month$year_date +(kiva_by_sector_month$month_date-1)/12
kiva_by_sector_month &lt;- kiva_by_sector_month[kiva_by_sector_month$year_date&lt;2017,] # Only plot the full years
ggplot(data = kiva_by_sector_month, mapping = aes(x = month_number, y = loan_amount_sum, color = sector)) +
  geom_point() +
  geom_line() +
  ggtitle("Loan amount by month, split by Sector") + 
  cits4009_theme</code></pre> <!-- rnb-source-end --> <!-- rnb-plot-begin eyJjb25kaXRpb25zIjpbXSwiaGVpZ2h0Ijo3LjQxNjYsInNpemVfYmVoYXZpb3IiOjEsIndpZHRoIjoxMn0= --> 
  <p><img src="image18.png" /></p> <!-- rnb-plot-end --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuZ2dwbG90KGRhdGEgPSBraXZhX2J5X3NlY3Rvcl9tb250aCwgbWFwcGluZyA9IGFlcyh4ID0gbW9udGhfbnVtYmVyLCB5ID0gbG9hbl9jb3VudCwgY29sb3IgPSBzZWN0b3IpKSArXG4gIGdlb21fcG9pbnQoKSArXG4gIGdlb21fbGluZSgpICtcbiAgZ2d0aXRsZShcIkxvYW5zIGNvdW50IGJ5IG1vbnRoLCBzcGxpdCBieSBTZWN0b3JcIikgKyBcbiAgY2l0czQwMDlfdGhlbWVcbmBgYCJ9 --> 
  <pre class="r"><code>ggplot(data = kiva_by_sector_month, mapping = aes(x = month_number, y = loan_count, color = sector)) +
  geom_point() +
  geom_line() +
  ggtitle("Loans count by month, split by Sector") + 
  cits4009_theme</code></pre> <!-- rnb-source-end --> <!-- rnb-plot-begin eyJjb25kaXRpb25zIjpbXSwiaGVpZ2h0Ijo3LjQxNjYsInNpemVfYmVoYXZpb3IiOjEsIndpZHRoIjoxMn0= --> 
  <p><img src="image19.png" /></p> <!-- rnb-plot-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>We can take out the 3 larger sectors (Retail, Food and Agriculture) to better visualize the trend in the smaller sectors</p> <!-- rnb-text-end --> <!-- rnb-chunk-begin --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuc21hbGxfc2VjdG9ycyA8LSAhKGtpdmFfYnlfc2VjdG9yX21vbnRoJHNlY3RvciAlaW4lIGMoJ1JldGFpbCcsJ0Zvb2QnLCdBZ3JpY3VsdHVyZScpKVxuZ2dwbG90KGRhdGEgPSBraXZhX2J5X3NlY3Rvcl9tb250aFtzbWFsbF9zZWN0b3JzLF0sIG1hcHBpbmcgPSBhZXMoeCA9IG1vbnRoX251bWJlciwgeSA9IGxvYW5fYW1vdW50X3N1bSwgY29sb3IgPSBzZWN0b3IpKSArXG4gIGdlb21fcG9pbnQoKSArXG4gIGdlb21fbGluZSgpICtcbiAgZ2d0aXRsZShcIkxvYW4gYW1vdW50IGJ5IG1vbnRoLCBzbWFsbGVyIHNlY3RvcnNcIikgKyBcbiAgY2l0czQwMDlfdGhlbWVcbmBgYCJ9 --> 
  <pre class="r"><code>small_sectors &lt;- !(kiva_by_sector_month$sector %in% c('Retail','Food','Agriculture'))
ggplot(data = kiva_by_sector_month[small_sectors,], mapping = aes(x = month_number, y = loan_amount_sum, color = sector)) +
  geom_point() +
  geom_line() +
  ggtitle("Loan amount by month, smaller sectors") + 
  cits4009_theme</code></pre> <!-- rnb-source-end --> <!-- rnb-plot-begin eyJjb25kaXRpb25zIjpbXSwiaGVpZ2h0Ijo3LjQxNjYsInNpemVfYmVoYXZpb3IiOjEsIndpZHRoIjoxMn0= --> 
  <p><img src="image20.png" /></p> <!-- rnb-plot-end --> <!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuZ2dwbG90KGRhdGEgPSBraXZhX2J5X3NlY3Rvcl9tb250aFtzbWFsbF9zZWN0b3JzLF0sIG1hcHBpbmcgPSBhZXMoeCA9IG1vbnRoX251bWJlciwgeSA9IGxvYW5fY291bnQsIGNvbG9yID0gc2VjdG9yKSkgK1xuICBnZW9tX3BvaW50KCkgK1xuICBnZW9tX2xpbmUoKSArXG4gIGdndGl0bGUoXCJMb2FucyBjb3VudCBieSBtb250aCwgc21hbGxlciBzZWN0b3JzXCIpICsgXG4gIGNpdHM0MDA5X3RoZW1lXG5gYGAifQ== --> 
  <pre class="r"><code>ggplot(data = kiva_by_sector_month[small_sectors,], mapping = aes(x = month_number, y = loan_count, color = sector)) +
  geom_point() +
  geom_line() +
  ggtitle("Loans count by month, smaller sectors") + 
  cits4009_theme</code></pre> <!-- rnb-source-end --> <!-- rnb-plot-begin eyJjb25kaXRpb25zIjpbXSwiaGVpZ2h0Ijo3LjQxNjYsInNpemVfYmVoYXZpb3IiOjEsIndpZHRoIjoxMn0= --> 
  <p><img src="image21.png" /></p> <!-- rnb-plot-end --> <!-- rnb-chunk-end --> <!-- rnb-text-begin --> 
  <p>There’s been an increase in the number of loans belonging to the “Personal Use” and “Education” categories, that’s been more steep than the increase of other popular categories such as Services, Clothing and Housing.</p> <!-- rnb-text-end --> 
 </div> 
 <div id="rmd-source-code">
   LS0tCnRpdGxlOiAiQ0lUUzQwMDkgLSBQcm9qZWN0IDEiCmF1dGhvcjogU2VyZ2lvIEJhbmNoZXJvICgyMjU2NTk3OSkKb3V0cHV0OiBodG1sX25vdGVib29rCi0tLQoKIyMjIEludHJvZHVjdGlvbgpUaGUgZGF0YSBzZXQgYW5hbHl6ZWQgY2FuIGJlIG9idGFpbmVkIGZyb20gdGhlIEthZ2dsZSBwbGF0Zm9ybS4gSXQncyBwYXJ0IG9mIHRoZSAiRGF0YSBTY2llbmNlIGZvciBHb29kOiBLaXZhIENyb3dkZnVuZGluZyIgY2hhbGxlbmdlLgpodHRwczovL3d3dy5rYWdnbGUuY29tL2tpdmEvZGF0YS1zY2llbmNlLWZvci1nb29kLWtpdmEtY3Jvd2RmdW5kaW5nCgpLaXZhLm9yZyBpcyBhIGNyb3dkZnVuZGluZyBvcmdhbml6YXRpb24gdGhhdCBwcm92aWRlcyBsb2FucyB0byBwZW9wbGUgaW4gZWNvbm9taWMgZGlzYWR2YW50YWdlIGFsbCBvdmVyIHRoZSB3b3JsZC4gVGhlIGRhdGEgc2V0IGluY2x1ZGVzIG92ZXIgNjcwSyBsb2FucyBtYWRlIGJ5IEtpdmEgaW4gYSBzcGFuIG9mIGFsbW9zdCAzIHllYXJzIGFuZCBhIGhhbGYuIERhdGEgcHJvdmlkZWQgaW5jbHVkZXMgZ2VvZ3JhcGhpY2FsIGluZm9ybWF0aW9uLCB1c2FnZSBvZiB0aGUgbG9hbnMgYW5kIHNvbWUgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGJvcnJvd2Vycy4KCiMjIyBEYXRhIGxvYWRpbmcsIG92ZXJ2aWV3IGFuZCBzZXQgdXAKCkxvYWQgbGlicmFyaWVzCmBgYHtyIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9CmxpYnJhcnkoZ2dwbG90MikKbGlicmFyeShncmlkRXh0cmEpCmxpYnJhcnkoZHBseXIpCmxpYnJhcnkoZ2d0aGVtZXMpCmxpYnJhcnkobnVtZm9ybSkKbGlicmFyeSh0cmVlbWFwaWZ5KQpsaWJyYXJ5KHRpbWVEYXRlKQpsaWJyYXJ5KGx1YnJpZGF0ZSkKbGlicmFyeShkcGx5cikKbGlicmFyeShyZXNoYXBlMikKbGlicmFyeShjYSkKYGBgCgpTZXR0aW5nIHVwIGEgcGxvdHRpbmcgdGhlbWUgc28gdGhhdCBhbGwgY2hhcnRzIGxvb2sgY29oZXJlbnQKYGBge3J9CmNpdHM0MDA5X3RoZW1lIDwtIHRoZW1lX2ZldygpICsgIyBUaGVtZSBiYXNlZCBvbiBTLiBGZXcncyAiUHJhY3RpY2FsIFJ1bGVzIGZvciBVc2luZyBDb2xvciBpbiBDaGFydHMiCiAgICAgICAgICAgICAgICAgIHRoZW1lKHBsb3QudGl0bGUgPSBlbGVtZW50X3RleHQoY29sb3IgPSAiZGFya3JlZCIpKSArCiAgICAgICAgICAgICAgICAgIHRoZW1lKHN0cmlwLnRleHQueCA9IGVsZW1lbnRfdGV4dChzaXplID0gMTQsIGNvbG91ciA9ICIjMjAyMDIwIikpICsKICAgICAgICAgICAgICAgICAgdGhlbWUocGxvdC5tYXJnaW49bWFyZ2luKDEwLDMwLDEwLDMwKSkKYGBgCgpMb2FkIHRoZSBtYWluIGRhdGEKYGBge3J9CmRhdGEucGF0aCA8LSAnLi9kYXRhL2tpdmFfbG9hbnMuY3N2JwpraXZhIDwtIHJlYWQuY3N2KGRhdGEucGF0aCkKYGBgCgpVc2luZyBzdHIgdG8gYW5hbHl6ZSB0aGUgZGF0YQpgYGB7ciBlY2hvPVQsIHJlc3VsdHM9J2hpZGUnfQpzdHIoa2l2YSkKYGBgClRoZXJlIGFyZSA2NzEyMDUgb2JzIHdpdGggMjAgdmFyaWFibGVzLCBjb21wcmlzZWQgYnkgMTQgZmFjdG9ycywgMiBpbnRlZ2VyIGFuZCA0IG51bWVyaWMgdmFyaWFibGVzLgpCdXQgaW4gZmFjdCBjb2x1bW5zLCB3ZSBjYW4gc2VlIHRoYXQgZnJvbSB0aGUgZmFjdG9ycywgc29tZSBoYXZlIHRvbyBtYW55IGxldmVsczogInVzZSIsICJwb3N0ZWRfdGltZSIsICJkaXNidXJzZWRfdGltZSIsICJmdW5kZWRfdGltZSIsICJ0YWdzIiwgImJvcnJvd2VyX2dlbmRlcnMiIGFuZCAiZGF0ZSIuIFRoaXMgaXMgYmVjYXVzZSBSIHRyZWF0cyBhbnkgY29sdW1uIGZvciB3aGljaCBpdCBmaW5kcyAic3RyaW5nIiBkYXRhIGFzIGZhY3RvcnMgYnkgZGVmYXVsdC4gV2Ugd2lsbCBkZWFsIHdpdGggdGhlc2UgbGF0ZXIgb24uCkZyb20gdGhlIG51bWVyaWMgdmFyaWFibGVzLCBwYXJ0bmVyX2lkIGFuZCBpZCBhcmUgYWN0dWFsbHkgaWRzIHNvIHRoZXkgY291bGQgYmUgdHJlYXRlZCBhcyBmYWN0b3JzIG9yIGlnbm9yZWQgZm9yIG5vdy4KCgpVc2luZyBzdW1tYXJ5IHRvIGFuYWx5emUgdGhlIGRhdGEKYGBge3IgZWNobz1ULCByZXN1bHRzPSdoaWRlJ30Kc3VtbWFyeShraXZhKQpgYGAKTW9zdCBudW1lcmljIHZhcmlhYmxlcywgbGlrZSBsb2FuIGFtb3VudCBhbmQgbGVuZGVyIGNvdW50IGFyZSBoaWdobHkgcmlnaHQtc2tld2VkLgoKVmlld2luZyB0aGUgZmlyc3QgdGVuIG9ic2VydmF0aW9ucwpgYGB7ciBlY2hvPVQsIHJlc3VsdHM9J2hpZGUnfQpoZWFkKGtpdmEpCmBgYApGcm9tIHRoZSBhYm92ZSB0d28gc3VtbWFyaWVzLCB3ZSBjYW4gc2VlIHRoYXQgYm9ycm93ZXJfZ2VuZGVycyBpcyBhIGxpc3Qgd2l0aCB0aGUgZ2VuZGVycyBvZiBhbGwgdGhlIGJvcnJvd2VycyBpbmRpdmlkdWFsbHkgbGlzdGVkLiAiVXNlIiIgaXMgYSBmcmVlIHRleHQgZmllbGQuCgojIyMjIyBJbml0aWFsIHRyYW5zZm9ybWF0aW9ucwpCYXNlZCBvbiB0aGUgYWJvdmUgb2JzZXJ2YXRpb25zLCB3ZSdsbCBjb252ZXJ0IHNvbWUgY29sdW1ucyB0byBhIG1vcmUgYXBwcm9wcmlhdGUgZm9ybWF0IGFuZCBhZGQgbmV3IG9uZXMgdGhhdCBtaWdodCBiZSB1c2VmdWwgaW4gZnVydGhlciBhbmFseXNpcy4KYGBge3IgZWNobz1ULCByZXN1bHRzPSdzaG93J30KdGltZV9jb2xzIDwtIGMoJ3Bvc3RlZF90aW1lJywgJ2Rpc2J1cnNlZF90aW1lJywgJ2Z1bmRlZF90aW1lJykKa2l2YVssdGltZV9jb2xzXVtraXZhWyx0aW1lX2NvbHNdPT0iIl0gPC0gTkEgIyBSZXBsYWNlIHRoZSAiIiBzdHJpbmcgZm9yIE5BIGluIHRoZSBkYXRlLXRpbWUgY29sdW1ucwoKa2l2YSA8LSB3aXRoaW4oa2l2YSwgewogICAgICAgICAgcGFydG5lcl9pZCA8LSBhcy5mYWN0b3IocGFydG5lcl9pZCkKICAgICAgICAgIHVzZSA8LSBhcy5jaGFyYWN0ZXIodXNlKQogICAgICAgICAgCiAgICAgICAgICAjIFVzZSB0aGUgImJvcnJvd2VyX2dlbmRlcnMiIHRvIGV4dHJhY3QgdGhlIG51bWJlciBvZiBib3Jyb3dlcnMKICAgICAgICAgIG51bWJlcl9ib3Jyb3dlcnMgPC0gc2FwcGx5KHN0cnNwbGl0KGFzLmNoYXJhY3RlcihraXZhJGJvcnJvd2VyX2dlbmRlcnMpLCAiLCAiKSwgbGVuZ3RoKQogICAgICAgICAgYm9ycm93ZXJzX2ZlbWFsZXMgPC0gc2FwcGx5KHN0cnNwbGl0KGFzLmNoYXJhY3RlcihraXZhJGJvcnJvd2VyX2dlbmRlcnMpLCAiLCAiKSwgZnVuY3Rpb24oeCl7c3VtKHg9PSdmZW1hbGUnKX0pCiAgICAgICAgICBib3Jyb3dlcnNfbWFsZXMgPC0gc2FwcGx5KHN0cnNwbGl0KGFzLmNoYXJhY3RlcihraXZhJGJvcnJvd2VyX2dlbmRlcnMpLCAiLCAiKSwgZnVuY3Rpb24oeCl7c3VtKHg9PSdtYWxlJyl9KQogICAgICAgICAgCiAgICAgICAgICAjIFBhcnNpbmcgYW5kIGNvbnZlcnRpbmcgZGF0ZXMKICAgICAgICAgIGRhdGUgPC0gYXMuRGF0ZShkYXRlLCBmb3JtYXQ9JyVZLSVtLSVkJykKICAgICAgICAgIHBvc3RlZF90aW1lIDwtIGFzLlBPU0lYbHQocG9zdGVkX3RpbWUpCiAgICAgICAgICBkaXNidXJzZWRfdGltZSA8LSBhcy5QT1NJWGx0KGRpc2J1cnNlZF90aW1lKQogICAgICAgICAgZnVuZGVkX3RpbWUgPC0gYXMuUE9TSVhsdChmdW5kZWRfdGltZSkKICAgICAgICAgIGZ1bmRlZF9sYWcgPC0gYXMubnVtZXJpYyhkaWZmdGltZShmdW5kZWRfdGltZSwgcG9zdGVkX3RpbWUsIHVuaXRzID0gImRheXMiKSkKICAgICAgICAgIGZ1bmRlZF9sYWdbZnVuZGVkX2xhZzwwXSA8LSBOQSAjIG5lZ2F0aXZlIHRpbWVzIG1ha2Ugbm8gc2Vuc2UsIHNldCB0byBOQQogICAgICAgICAgCiAgICAgICAgICAjIENvbnZlcnQgdGFncyB0byBjaGFyYWN0ZXJzCiAgICAgICAgICB0YWdzIDwtIGFzLmNoYXJhY3Rlcih0YWdzKQogICAgICAgICAgdXNlcl9mYXZvcml0ZSA8LSBncmVwbCgidXNlcl9mYXZvcml0ZSIsIHRhZ3MpICMgdGFrZSB0aGUgInVzZXJfZmF2b3JpdGUiIHRhZyBhcyBhIGJvb2xlYW4gdmFyaWFibGUKICAgICAgICAgIAogICAgICAgICAgZnVsbHlfZnVuZGVkIDwtIGZ1bmRlZF9hbW91bnQ+PWxvYW5fYW1vdW50ICMgYm9vbGVhbiB2YXJpYWJsZSBpbmRpY2F0aW5nIGlmIHRoZSBsb2FuIHdhcyBmdWxseSBmdW5kZWQKfSkKYGBgCgpBbmFseXplIHRoZSBudW1iZXIgb2YgTkEgZWFjaCB2YXJpYWJsZXMKYGBge3J9CmFwcGx5KGlzLm5hKGtpdmEpLCAyLCBzdW0pCmBgYApNb3N0IG9mIHRoZSBjb2x1bW5zIGRvbid0IGhhdmUgYW55IE5BLiBUaGUgb25lcyB0aGF0IGRvIG1pZ2h0IGJlIGR1ZSB0byBsYWNrIG9mIGZ1bmRpbmcuCldlIGNhbiBzZWUgdGhpcyBieSBzcGxpdHRpbmcgdGhlIHNhbWUgaW5mb3JtYXRpb24gYmV0d2VlbiB0aGUgZnVsbHkgZnVuZGVkIGFuZCBub3QgZnVuZGVkIGxvYW5zOgpgYGB7cn0KeCA8LSByYmluZChhcHBseShpcy5uYShraXZhW2tpdmEkZnVsbHlfZnVuZGVkLF0pLCAyLCBzdW0pLAogICAgICAgICAgIGFwcGx5KGlzLm5hKGtpdmFbIWtpdmEkZnVsbHlfZnVuZGVkLF0pLCAyLCBzdW0pKQpyb3duYW1lcyh4KSA8LSBjKCdmdWxseV9mdW5kZWQnLCdub3RfZnVsbHlfZnVuZGVkJykKdCh4Wyxjb2xTdW1zKHgpPjBdKQpgYGAKV2Ugc2VlIHRoYXQgdGhhdCdzIG1vc3RseSB0aGUgY2FzZSBmb3IgYWxsIHZhcmlhYmxlcyBleGNlcHQgcGFydG5lcl9pZC4KCgoKIyMjIEFuYWx5emluZyBsb2FuIGFtb3VudCwgZnVuZGVkIGFtb3VudCBhbmQgZnVuZGVkIHRpbWUKU2luY2UgdGhlc2UgYXJlIHJpZ2h0LXNrZXdlZCB2YXJpYWJsZXMsIHdlJ2xsIHVzZSB0d28gaGlzdG9ncmFtcyB0byBhbmFseXplIHRoZSBkaXN0cmlidXRpb246IG9uZSB3aXRoIGEgbG9nMTAgc2NhbGUgYW5kIG9uZSB3aXRoIGEgdHJ1bmNhdGVkIGxpbmVhciBzY2FsZQpgYGB7ciwgZmlnLndpZHRoID0gMTJ9CnAxIDwtIGdncGxvdChkYXRhID0ga2l2YSwgbWFwcGluZyA9IGFlcyh4ID0gbG9hbl9hbW91bnQpKSsKICBnZW9tX2hpc3RvZ3JhbShhZXMoeT0uLmRlbnNpdHkuLiksIGJpbnM9NTAsIGZpbGwgPSAiZ3JleSIpKwogIGdlb21fZGVuc2l0eShjb2xvcj0nZGFya3JlZCcpICsKICBzY2FsZV94X2NvbnRpbnVvdXModHJhbnM9J2xvZzEwJykrCiAgZ2d0aXRsZSgiTG9hbiBBbW91bnQgKExvZyBTY2FsZSkiKSArIAogIGNpdHM0MDA5X3RoZW1lCgpwMiA8LSBnZ3Bsb3QoZGF0YSA9IGtpdmEsIAogICAgICBtYXBwaW5nID0gYWVzKHggPSBsb2FuX2Ftb3VudCkpKwogIGdlb21faGlzdG9ncmFtKGFlcyh5PS4uZGVuc2l0eS4uKSwgYmlucyA9IDIwMCwgZmlsbCA9ICJncmV5IikrCiAgZ2VvbV9kZW5zaXR5KGNvbG9yPSdkYXJrcmVkJykgKwogIHNjYWxlX3hfY29udGludW91cyhsaW1pdHM9YygwLCAwLjVlKzA0KSkrCiAgYW5ub3RhdGUoInRleHQiLCB4ID0gMTAwMCwgeSA9IDAuMDAxNSwgbGFiZWwgPSAiU3Bpa2VzIGF0IGRpc2NyZXRlIHZhbHVlc1xuICQxSywgJDEuNUssIGV0YyIpICsKICBnZ3RpdGxlKCJMb2FuIEFtb3VudCAoVXAgdG8gJDVLKSIpICsgCiAgY2l0czQwMDlfdGhlbWUKCmdyaWQuYXJyYW5nZShwMSwgcDIsIG5jb2w9MSkKYGBgCk1vc3QgbG9hbnMgaGF2ZSAicm91bmQiIHZhbHVlcyBsaWtlIDEwMCwgNTAwLCAxSywgZXRjLgoKYGBge3IsIGZpZy53aWR0aCA9IDEyfQpwMSA8LSBnZ3Bsb3QoZGF0YSA9IGtpdmEsIG1hcHBpbmcgPSBhZXMoeCA9IGZ1bmRlZF9hbW91bnQpKSsKICBnZW9tX2hpc3RvZ3JhbShhZXMoeT0uLmRlbnNpdHkuLiksIGJpbnM9NTAsIGZpbGwgPSAiZ3JleSIpKwogIGdlb21fZGVuc2l0eShjb2xvcj0nZGFya3JlZCcpICsKICBzY2FsZV94X2NvbnRpbnVvdXModHJhbnM9J2xvZzEwJykrCiAgZ2d0aXRsZSgiRnVuZGVkIEFtb3VudCAoTG9nIFNjYWxlKSIpICsgCiAgY2l0czQwMDlfdGhlbWUKCnAyIDwtIGdncGxvdChkYXRhID0ga2l2YSwgCiAgICAgIG1hcHBpbmcgPSBhZXMoeCA9IGZ1bmRlZF9hbW91bnQpKSsKICBnZW9tX2hpc3RvZ3JhbShhZXMoeT0uLmRlbnNpdHkuLiksIGJpbnMgPSAyMDAsIGZpbGwgPSAiZ3JleSIpKwogIGdlb21fZGVuc2l0eShjb2xvcj0nZGFya3JlZCcpICsKICBzY2FsZV94X2NvbnRpbnVvdXMobGltaXRzPWMoMCwgMC41ZSswNCkpKwogIGdndGl0bGUoIkZ1bmRlZCBBbW91bnQgKFVwIHRvICQ1SykiKSArIAogIGNpdHM0MDA5X3RoZW1lCgpncmlkLmFycmFuZ2UocDEsIHAyLCBuY29sPTEpCmBgYApBcyBleHBlY3RlZCwgdGhlICJmdW5kZWRfYW1vdW50IiBoYXMgYSBkaXN0cmlidXRpb24gYWxtb3N0IGlkZW50aWNhbCB0byAibG9hbl9hbW91bnQiLgoKQmVjYXVzZSBtb3N0IGxvYW5zIGhhdmUgInJvdW5kIiB2YWx1ZXMgbGlrZSAxMDAsIDUwMCwgMUssIGV0Yy4sIGl0IG1pZ2h0IGJlIHVzZWZ1bCB0byBhZGQgYSBjYXRlZ29yaWNhbCB2YXJpYWJsZSB0byBncm91cCB0aGVtCmBgYHtyfQpicmtzIDwtYygwLCAxMDAsIDIwMCwgMzAwLCA0MDAsIDUwMCwgMTAwMCwgMjAwMCwgNTAwMCwgSW5mKQpraXZhJGxvYW5fYW1vdW50X3JhbmdlIDwtIGN1dChraXZhJGxvYW5fYW1vdW50LCBicmVha3M9YnJrcywgcmlnaHQ9RkFMU0UsIGluY2x1ZGUubG93ZXN0PVQpCmxldmVscyhraXZhJGxvYW5fYW1vdW50X3JhbmdlKSA8LSBjKCJbMCwxMDApIiwgIlsxMDAsMjAwKSIsICJbMjAwLDMwMCkiLCAiWzMwMCw0MDApIiwgIls0MDAsNTAwKSIsICJbNTAwLDFLKSIsICJbMUssMkspIiwKIlsySyw1SykiLCAiPj01SyIpCmBgYAoKCldlIGNhbiBhbHNvIGFuYWx5emUgdGhlIGRpc3RyaWJ1dGlvbiBvZiAiZnVuZGVkIGxhZyIgKGhvdyBsb25nIGl0IHRvb2sgZm9yIHRoZSBsb2FuIHRvIGJlIGZ1bmRlZCkuIApBZ2FpbiB3ZSdsbCB1c2UgYSBsb2cgc2NhbGUgYW5kIGEgdHJ1bmNhdGVkIGxpbmVhciBzY2FsZSB0byBwbG90IHRoZSBkaXN0cmlidXRpb24uCmBgYHtyLCBmaWcud2lkdGggPSAxMn0KcDEgPC0gZ2dwbG90KGRhdGEgPSBraXZhLCBtYXBwaW5nID0gYWVzKHggPSBmdW5kZWRfbGFnKSkrCiAgZ2VvbV9oaXN0b2dyYW0oYWVzKHk9Li5kZW5zaXR5Li4pLCBiaW5zPTMwLCBmaWxsID0gImdyZXkiKSsKICBnZW9tX2RlbnNpdHkoY29sb3I9J2RhcmtyZWQnKSArCiAgc2NhbGVfeF9jb250aW51b3VzKHRyYW5zPSdsb2cxMCcpKwogIGdndGl0bGUoIkZ1bmRlZCBMYWcgKExvZyBTY2FsZSkiKSArIAogIGNpdHM0MDA5X3RoZW1lCgpwMiA8LSBnZ3Bsb3QoZGF0YSA9IGtpdmEsIAogICAgICBtYXBwaW5nID0gYWVzKHggPSBmdW5kZWRfbGFnKSkrCiAgZ2VvbV9oaXN0b2dyYW0oYWVzKHk9Li5kZW5zaXR5Li4pLCBiaW5zID0gMTAwLCBmaWxsID0gImdyZXkiKSsKICBnZW9tX2RlbnNpdHkoY29sb3I9J2RhcmtyZWQnKSArCiAgc2NhbGVfeF9jb250aW51b3VzKGxpbWl0cz1jKDAsIDEwMCkpKwogIGFubm90YXRlKCJ0ZXh0IiwgeCA9IDMwLCB5ID0gMC4wMywgbGFiZWwgPSAifjMwIGRheXNcbiBmdW5kZWQgbGFnIikgKwogIGdndGl0bGUoIkZ1bmRlZCBMYWcgKFVwIHRvIDEwMCBkYXlzKSIpICsgCiAgY2l0czQwMDlfdGhlbWUKCmdyaWQuYXJyYW5nZShwMSwgcDIsIG5jb2w9MSkKYGBgCldlIHNlZSB0aGF0IGl0IHNlZW1zIHRvIGJlIGEgYmktbW9kYWwgZGlzdHJpYnV0aW9uLCB3aXRoIGEgcGVhayBhcm91bmQgMSB3ZWVrIGFuZCBhbm90aGVyIGF0IGFyb3VuZCAxIG1vbnRoLgoKTm93IHdlIHdhbnQgdG8gYW5hbHl6ZSBpZiB0aGVyZSdzIGEgcmVsYXRpb24gYmV0d2VlbiB0aGUgbG9hbiBhbW91bnQgYW5kIGhvdyBsb25nIGl0IHRha2VzIHRvIGZ1bmQgaXQuClNpbmNlIGZ1bmRlZCBsYWcgc2VlbXMgdG8gYmUgYmktbW9kYWwsIGEgYm94cGxvdCBtaWdodCBub3Qgc2hvdyB0aGlzIGRldGFpbCwgc28gd2UnbGwgdXNlIHZpb2xpbiBwbG90cy4KYGBge3IsIGZpZy53aWR0aCA9IDEyfQpnZCA8LSBraXZhICU+JSAKICAgICAgICBncm91cF9ieShsb2FuX2Ftb3VudF9yYW5nZSkgJT4lIAogICAgICAgIHN1bW1hcmlzZShmdW5kZWRfbGFnID0gbWVhbihmdW5kZWRfbGFnLCBuYS5ybSA9IFQpKQoKZ2dwbG90KGRhdGEgPSBraXZhLCAKICAgICAgbWFwcGluZyA9IGFlcyh5ID0gZnVuZGVkX2xhZywgeCA9IGxvYW5fYW1vdW50X3JhbmdlKSkrCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gMzEsIHNob3cubGVnZW5kID0gVCwgc2l6ZT0xLCBjb2xvcj0nZGFya2dyYXknLCBsaW5ldHlwZT0nZG90dGVkJykgKwogIGdlb21faGxpbmUoeWludGVyY2VwdCA9IDYsIHNob3cubGVnZW5kID0gVCwgc2l6ZT0xLCBjb2xvcj0nZGFya2dyYXknLCBsaW5ldHlwZT0nZG90dGVkJykgKyAKICBnZW9tX3Zpb2xpbihmaWxsID0nbGlnaHRncmF5JykrCiAgZ2VvbV9wb2ludChkYXRhID0gZ2QsIHN0YXQgPSAiaWRlbnRpdHkiLCBhZXMoc2hhcGU9J21lYW4nKSwgY29sb3I9J2RhcmtyZWQnLCBzaXplPTQpKwogIHNjYWxlX3lfY29udGludW91cyhsaW1pdHMgPSBjKDAsMTAwKSkrCiAgYW5ub3RhdGUoInRleHQiLCB4ID0gLTAuNSwgeSA9IDcsIGxhYmVsID0gIiAiKSArCiAgYW5ub3RhdGUoInRleHQiLCB4ID0gMCwgeSA9IDcsIGxhYmVsID0gIn4xIFdlZWtcbiBmdW5kZWQgbGFnIikgKwogIGFubm90YXRlKCJ0ZXh0IiwgeCA9IDQuNSwgeSA9IDMyLGxhYmVsID0gIn4zMCBkYXlzXG4gZnVuZGVkIGxhZyIpICsKICBnZ3RpdGxlKCJGdW5kZWQgTGFnIERpc3RyaWJ1dGlvbiBieSBMb2FuIEFtb3VudCBSYW5nZSIpICsgCiAgY2l0czQwMDlfdGhlbWUKYGBgClRoZSBmdW5kZWQgbGFnIGFwcGVhcnMgdG8gaW5jcmVhc2Ugd2l0aCB0aGUgbG9hbiBhbW91bnQuCkFub3RoZXIgdmlzaWJsZSBwYXR0ZXJuIGlzIHRoYXQgYSAzMCBkYXlzIGxhZyBzZWVtcyB0byBiZSB2ZXJ5IGNvbW1vbiBpbiBsYXJnZSBsb2Fucywgd2hlcmVhcyBzbWFsbGVyIGxvYW5zIGdldCBmdW5kZWQgbXVjaCBxdWlja2VyLCBzcGVjaWFsbHkgYWZ0ZXIgb25lIHdlZWsuIFRoaXMgY291bGQgYmUgZHVlIHRvIGtpdmEncyBwcm9tb3Rpb24gcG9saWN5IG9uIGhvdyBwcm9qZWN0cyBnZXQgZGlzcGxheWVkIGFuZCByYW5rZWQgaW4gdGhlaXIgc2l0ZSAoRm9yIGluc3RhbmNlLCBhZnRlciAzMCBkYXlzLCBhIHByb2plY3QgdGhhdCBoYXNuJ3QgYmVlbiBmdW5kZWQgaXMgc2hvd24gdG8gbW9yZSB2aXNpdG9ycykuCgojIyMgQW5hbHl6aW5nIE51bWJlciBvZiBMZW5kZXJzCmBgYHtyLCBmaWcud2lkdGggPSAxMn0KcDEgPC0gZ2dwbG90KGRhdGEgPSBraXZhLCAKICAgICAgbWFwcGluZyA9IGFlcyh4ID0gbGVuZGVyX2NvdW50KSkrCiAgZ2VvbV9oaXN0b2dyYW0oYWVzKHk9Li5kZW5zaXR5Li4pLCBiaW5zID0gMTAwLCBmaWxsID0gImdyZXkiKSsKICBnZW9tX2RlbnNpdHkoY29sb3I9J2RhcmtyZWQnKSArCiAgc2NhbGVfeF9jb250aW51b3VzKHRyYW5zPSdsb2cxMCcpKwogIGdndGl0bGUoIk51bWJlciBvZiBsZW5kZXJzIGRpc3RyaWJ1dGlvbiAoTG9nKSIpICsgCiAgY2l0czQwMDlfdGhlbWUKCnAyIDwtIGdncGxvdChkYXRhID0ga2l2YSwgCiAgICAgIG1hcHBpbmcgPSBhZXMoeCA9IGxlbmRlcl9jb3VudCkpKwogIGdlb21faGlzdG9ncmFtKGFlcyh5PS4uZGVuc2l0eS4uKSwgYmlucyA9IDEwMCwgZmlsbCA9ICJncmV5IikrCiAgZ2VvbV9kZW5zaXR5KGNvbG9yPSdkYXJrcmVkJykgKwogIHNjYWxlX3hfY29udGludW91cyhsaW1pdHM9YygwLCAxMDApKSsKICBnZ3RpdGxlKCJOdW1iZXIgb2YgbGVuZGVycyAodXAgdG8gMTAwKSBkaXN0cmlidXRpb24iKSArIAogIGNpdHM0MDA5X3RoZW1lCgpncmlkLmFycmFuZ2UocDEsIHAyLCBuY29sPTEpCmBgYApUaGUgbnVtYmVyIG9mIGxlbmRlcnMgc2VlbXMgdG8gZm9sbG93IGEgb25lLWluZmxhdGVkIFBvaXNzb24gZGlzdHJpYnV0aW9uCgpOb3cgd2UnbGwgc2VlIHRoZSByZWxhdGlvbiBiZXR3ZWVuIG51bWJlciBvZiBsZW5kZXJzIGFuZCBsb2FuIGFtb3VudC4KYGBge3IsIGZpZy53aWR0aD0xMn0KZ2dwbG90KG1hcHBpbmcgPSBhZXMoeD1sZW5kZXJfY291bnQsIHk9bG9hbl9hbW91bnQpLCBkYXRhPWtpdmFba2l2YSRsb2FuX2Ftb3VudD4xICYga2l2YSRsZW5kZXJfY291bnQ+MCxdKSArCiAgZ2VvbV9wb2ludChhbHBoYT0wLjAxKSArCiAgc2NhbGVfeF9jb250aW51b3VzKHRyYW5zPSdsb2cxMCcpICsKICBzY2FsZV95X2NvbnRpbnVvdXModHJhbnM9J2xvZzEwJykgKwogIGdlb21fbGluZShzdGF0PSdzdW1tYXJ5JyxmdW4ueT1xdWFudGlsZSxmdW4uYXJncyA9IGxpc3QoMC4wNSksCiAgICAgICAgICAgIGxpbmV0eXBlPTIsIG1hcHBpbmc9YWVzKGNvbG9yPSI1JSBQZXJjZW50aWxlIiksIHNpemU9MSkrCiAgZ2VvbV9saW5lKHN0YXQ9J3N1bW1hcnknLGZ1bi55PW1lYW4sCiAgICAgICAgICAgIGxpbmV0eXBlPTEsIG1hcHBpbmc9YWVzKGNvbG9yPSJNZWFuIiksIHNpemU9MSkrCiAgZ2VvbV9saW5lKHN0YXQ9J3N1bW1hcnknLGZ1bi55PXF1YW50aWxlLGZ1bi5hcmdzID0gbGlzdCgwLjk1KSwKICAgICAgICAgICAgbGluZXR5cGU9MiwgbWFwcGluZz1hZXMoY29sb3I9Ijk1JSBQZXJjZW50aWxlIiksIHNpemU9MSkrCiAgZ2d0aXRsZSgiTG9hbiBBbW91bnQgVnMgTnVtYmVyIG9mIExlbmRlcnMiKSArIAogIGNpdHM0MDA5X3RoZW1lCmBgYApUaGVyZSBzZWVtcyB0byBiZSBhIGxpbmVhciByZWxhdGlvbiBiZXR3ZWVuIHRoZSBudW1iZXIgb2YgbGVuZGVycyBhbmQgdGhlIGxvd2VyIHF1YW50aWxlcyBvZiB0aGUgbG9hbiBhbW91bnQuIFRoaXMgY291bGQgYmUgYmVjYXVzZSBvZiBhIG1pbmltdW0gbGVuZGluZyBhbW91bnQuIFdlIGNhbiBjcmVhdGUgYSBoaXN0b2dyYW0gb2YgbG9hbiBhbW91bnQgcGVyIGxlbmRlciB0byBzZWUgaWYgdGhpcyBpcyBjb3VsZCBiZSB0aGUgY2FzZS4KYGBge3IsIGZpZy53aWR0aD0xMn0KbWFzayA8LSBraXZhJGxvYW5fYW1vdW50PjEgJiBraXZhJGxlbmRlcl9jb3VudD4wCmtpdmEkbG9hbl9hbW91bnRfcGVyX2xlbmRlciA8LSBraXZhJGxvYW5fYW1vdW50IC8ga2l2YSRsZW5kZXJfY291bnQKa2l2YSRsb2FuX2Ftb3VudF9wZXJfbGVuZGVyWyFtYXNrXSA8LSBOQQpnZ3Bsb3QoZGF0YSA9IGtpdmEsIG1hcHBpbmcgPSBhZXMoeCA9IGxvYW5fYW1vdW50X3Blcl9sZW5kZXIpKSArCiAgZ2VvbV9oaXN0b2dyYW0oYmlucz0xMDApICsKICBzY2FsZV94X2NvbnRpbnVvdXMobGltaXRzID0gYygwLDUwMCkpKwogIGdndGl0bGUoIkRpc3RyaWJ1dGlvbiBvZiBMb2FuIEFtb3VudCBQZXIgTGVuZGVyICh1cCB0byAkNTAwKSIpICsKICBjaXRzNDAwOV90aGVtZQoKZ2dwbG90KGRhdGEgPSBraXZhLCBtYXBwaW5nID0gYWVzKHggPSBsb2FuX2Ftb3VudF9wZXJfbGVuZGVyKSkgKwogIGdlb21faGlzdG9ncmFtKGJpbnM9MTAwKSArCiAgc2NhbGVfeF9jb250aW51b3VzKGxpbWl0cyA9IGMoMCw1MCkpKwogIGdndGl0bGUoIkRpc3RyaWJ1dGlvbiBvZiBMb2FuIEFtb3VudCBQZXIgTGVuZGVyICh1cCB0byAkNTApIikgKwogIGNpdHM0MDA5X3RoZW1lCmBgYApUaGUgbGFyZ2Ugc3Bpa2UgYXQgXCQyNSBhbmQgdGhlIHZlcnkgZmV3IGNhc2VzIGJlbG93IHRoYXQgYW1vdW50IGFyZSBhIHN0cm9uZyBpbmRpY2F0aW9uIHRoYXQgdGhlIG1pbmltdW0gbG9hbiBpcyBzZXQgYXQgXCQyNSwgYW5kIHRoYXQgYSB2ZXJ5IGxhcmdlIHByb3BvcnRpb24gb2YgZm91bmRlcnMgYWN0dWFsbHkgZ2l2ZSB0aGF0IGFtb3VudC4gSW4gZmFjdCwgYnkgY2hlY2tpbmcgdGhlIGtpdmEub3JnIHdlYnNpdGUsIHdlIHNlZSB0aGlzIGlzIHRoZSBjYXNlLgoKIyMjIEdlb2dyYXBoaWNhbCBpbmZvcm1hdGlvbgpQbG90IHRoZSBsb2FuIGFtb3VudCBieSBjb3VudHJ5IHRvIGhhdmUgYW4gdW5kZXJzdGFuZGluZyBvZiB3aGVyZSB0aGUgbG9hbnMgYXJlIGJlaW5nIHVzZWQuCmBgYHtyLCBmaWcud2lkdGggPSAxMiwgZmlnLmhlaWdodD0xNn0Ka2l2YV9ieV9jb3VudHJ5IDwtIGtpdmEgJT4lIAogICAgICAgIGdyb3VwX2J5KGNvdW50cnkpICU+JSAKICAgICAgICBzdW1tYXJpc2UobG9hbl9hbW91bnRfbWVhbiA9IG1lYW4obG9hbl9hbW91bnQsIG5hLnJtID0gVCksCiAgICAgICAgICAgICAgICAgIGxvYW5fYW1vdW50X3N1bSA9IHN1bShsb2FuX2Ftb3VudCwgbmEucm0gPSBUKQogICAgICAgICAgICAgICAgICApCgpraXZhX2J5X2NvdW50cnkgPC0gdHJhbnNmb3JtKGtpdmFfYnlfY291bnRyeSwKICAgICAgICAgICAgICAgICAgICBjb3VudHJ5PXJlb3JkZXIoY291bnRyeSwgbG9hbl9hbW91bnRfc3VtKSkKZ2dwbG90KGtpdmFfYnlfY291bnRyeSwgbWFwcGluZz1hZXMoeD1jb3VudHJ5LCB5PWxvYW5fYW1vdW50X3N1bSkpKwogIGdlb21fYmFyKHN0YXQ9ImlkZW50aXR5IiwgZmlsbD0iZ3JheSIpICsKICBnZW9tX3RleHQobWFwcGluZz1hZXMobGFiZWw9ZmZfbWlsbHMoIGRpZ2l0cz0tNCkobG9hbl9hbW91bnRfc3VtKSksIHBvc2l0aW9uID0gcG9zaXRpb25fc3RhY2sodmp1c3QgPSAwLjUpLCBzaXplPTQpICsKICBnZ3RpdGxlKCJMb2FuIEFtb3VudCBCeSBDb3VudHJ5IikgKyAKICBjb29yZF9mbGlwKCkgKwogIHRoZW1lKGF4aXMudGV4dC55PWVsZW1lbnRfdGV4dChzaXplPXJlbCgwLjgpKSkrCiAgc2NhbGVfeV9jb250aW51b3VzKGxhYmVsID0gZmZfbWlsbHMocHJlZml4ID0nJCcsIGRpZ2l0cz0tNCkpKwogIGNpdHM0MDA5X3RoZW1lCmBgYAoKVGhlIHNpdGUgb2ZmZXJzIGEgc2Vjb25kYXJ5IGZpbGUgd2l0aCBleHRyYSBpbmZvcm1hdGlvbiBhYm91dCB0aGUgcmVnaW9ucywgc3VjaCBhcyBnZW9ncmFwaGljYWwgY29vcmRpbmF0ZXMgYW5kIHdvcmxkIHJlZ2lvbi4KTG9hZCBhbmQgbWVyZ2UgdGhpcyBkYXRhLgpgYGB7cn0Ka2l2YV9yZWdpb25zIDwtIHJlYWQuY3N2KCcuL2RhdGEva2l2YV9tcGlfcmVnaW9uX2xvY2F0aW9ucy5jc3YnKQoKa2l2YV9ieV9yZWdpb24gPC0ga2l2YSAlPiUgCiAgICAgICAgZ3JvdXBfYnkoLmRvdHM9YygnY291bnRyeScsICdyZWdpb24nKSkgJT4lIAogICAgICAgIHN1bW1hcmlzZShsb2FuX2Ftb3VudF9tZWFuID0gbWVhbihsb2FuX2Ftb3VudCwgbmEucm0gPSBUKSwKICAgICAgICAgICAgICAgICAgbG9hbl9hbW91bnRfc3VtID0gc3VtKGxvYW5fYW1vdW50LCBuYS5ybSA9IFQpCiAgICAgICAgICAgICAgICAgICkKCmtpdmFfYnlfcmVnaW9uIDwtIG1lcmdlKGtpdmFfYnlfcmVnaW9uLCBraXZhX3JlZ2lvbnMsIGJ5PWMoJ2NvdW50cnknLCdyZWdpb24nKSwgYWxsLnggPSBUUlVFKQpraXZhX3dpdGhfcmVnaW9uIDwtIG1lcmdlKGtpdmEsIGtpdmFfcmVnaW9ucywgYnk9YygnY291bnRyeScsJ3JlZ2lvbicpLCBhbGwueCA9IFRSVUUpCmBgYAoKUGxvdCBhIG1hcApgYGB7cn0KY2l0czQwMDlfbWFwX3RoZW1lIDwtIGNpdHM0MDA5X3RoZW1lICsgCiAgICAgICAgICAgICAgICAgICAgICB0aGVtZShwYW5lbC5ncmlkID0gZWxlbWVudF9ibGFuaygpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFuZWwuYm9yZGVyID0gZWxlbWVudF9ibGFuaygpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVnZW5kLnBvc2l0aW9uPSJ0b3AiLCBsZWdlbmQuZGlyZWN0aW9uID0gJ2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXhpcy50aXRsZS54PWVsZW1lbnRfYmxhbmsoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF4aXMudGV4dC54PWVsZW1lbnRfYmxhbmsoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF4aXMudGlja3MueD1lbGVtZW50X2JsYW5rKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBheGlzLnRpdGxlLnk9ZWxlbWVudF9ibGFuaygpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXhpcy50ZXh0Lnk9ZWxlbWVudF9ibGFuaygpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXhpcy50aWNrcy55PWVsZW1lbnRfYmxhbmsoKSkKYGBgCgpgYGB7ciwgZmlnLndpZHRoID0gMTJ9CmdncGxvdChraXZhX2J5X3JlZ2lvbikrCiAgZ2VvbV9wb2x5Z29uKGRhdGE9bWFwX2RhdGEoIndvcmxkIiksIGFlcyh4ID0gbG9uZywgeSA9IGxhdCwgZ3JvdXAgPSBncm91cCksIGZpbGw9IiNGMEYwRjAiLCBjb2xvdXIgPSAibGlnaHRncmF5IikrCiAgZ2VvbV9wb2ludChtYXBwaW5nID0gYWVzKHg9bG9uLCB5PWxhdCwgc2l6ZSA9IGxvYW5fYW1vdW50X3N1bSksIGFscGhhPTAuNywgY29sb3I9J2RhcmtyZWQnKSsKICBjb29yZF9xdWlja21hcCgpKwogIGZhY2V0X3dyYXAofndvcmxkX3JlZ2lvbiwgIHNjYWxlcyA9ICJmcmVlIikrCiAgZ2d0aXRsZSgiTG9jYXRpb24gb2YgTG9hbnMgYnkgV29ybGQgUmVnaW9uIikgKyAKICBjaXRzNDAwOV9tYXBfdGhlbWUKYGBgClRoZXJlIGFyZSBzb21lIGNsZWFyIGlzc3VlcyB3aXRoIHRoZSBkYXRhOiBXZSBjYW4gc2VlIHRoYXQgdGhlcmUgYXJlIG1pc3MgbG9jYXRlZCBwb2ludHMsIGZvciBpbnN0YW5jZSB0aGVyZSBhcmUgcG9pbnRzIGNhdGVnb3JpemVkIGFzICJMYXRpbiBBbWVyaWNhIGFuZCBDYXJpYmJlYW4iIGJ1dCBhcmUgcGxhY2VkIGluIEFmcmljYSBvciBBc2lhLgpXZSBjYW4gY2xlYW4gdXAgdGhpcyBieSBzZXR0aW5nIHRvIE5BIHRoZSBjb29yZGluYXRlcyB0aGF0IGZhbGwgZmFyIGZyb20gdGhlIHJlZ2lvbiBib3VuZGluZyBib3guCkFsc28sIG1hbnkgY291bnRyaWVzIHNlZW0gdG8gaGF2ZSBub3QgYmVlbiBtYXBwZWQgY29ycmVjdGx5LiBGb3IgaW5zdGFuY2UsIFBoaWxpcHBpbmVzIGlzIHRoZSBsYXJnZXN0IGluIHRlcm1zIG9mIGxvYW4gYW1vdW50LCBidXQgbm8gcG9pbnQgYXBwZWFycyBmb3IgaXQuCgoKVGhlIHByb2JsZW0gaXMgdGhhdCB0aGUgInJlZ2lvbiIgbmFtZSBub3QgYWx3YXlzIG1hdGNoZXMgYmV0d2VlbiBib3RoIGZpbGVzLiBBbiBhcHByb3hpbWF0ZSBzb2x1dGlvbiBpcyB0byB1c2UgdGhlIGNvdW50cnkgaW5zdGVhZCBvZiB0aGUgcmVnaW9uIHRvIG1hcCB0aGVtLgpgYGB7cn0Ka2l2YV9jb3VudHJpZXMgPC0ga2l2YV9yZWdpb25zICU+JSAKICAgICAgICBncm91cF9ieSguZG90cz1jKCdjb3VudHJ5JykpICU+JSAKICAgICAgICBzdW1tYXJpc2Uod29ybGRfcmVnaW9uX2ltcCA9IG1heChhcy5jaGFyYWN0ZXIod29ybGRfcmVnaW9uKSwgbmEucm0gPSBUKSwKICAgICAgICAgICAgICAgICAgbGF0X2ltcCA9IG1lZGlhbihsYXQpLAogICAgICAgICAgICAgICAgICBsb25faW1wID0gbWVkaWFuKGxvbikKICAgICAgICAgICAgICAgICAgKQoKa2l2YV9ieV9yZWdpb24gPC0gbWVyZ2Uoa2l2YV9ieV9yZWdpb24sIGtpdmFfY291bnRyaWVzLCBieT1jKCdjb3VudHJ5JyksIGFsbC54ID0gVFJVRSkKa2l2YV93aXRoX3JlZ2lvbiA8LSBtZXJnZShraXZhX3dpdGhfcmVnaW9uLCBraXZhX2NvdW50cmllcywgYnk9YygnY291bnRyeScpLCBhbGwueCA9IFRSVUUpCgojIEltcHV0ZSB3aXRoIHRoZSBjb3VudHJ5IHJlZ2lvbgpraXZhX2J5X3JlZ2lvbiR3b3JsZF9yZWdpb25baXMubmEoa2l2YV9ieV9yZWdpb24kd29ybGRfcmVnaW9uKV0gPC0ga2l2YV9ieV9yZWdpb24kd29ybGRfcmVnaW9uX2ltcFtpcy5uYShraXZhX2J5X3JlZ2lvbiR3b3JsZF9yZWdpb24pXQpraXZhX3dpdGhfcmVnaW9uJHdvcmxkX3JlZ2lvbltpcy5uYShraXZhX3dpdGhfcmVnaW9uJHdvcmxkX3JlZ2lvbildIDwtIGtpdmFfd2l0aF9yZWdpb24kd29ybGRfcmVnaW9uX2ltcFtpcy5uYShraXZhX3dpdGhfcmVnaW9uJHdvcmxkX3JlZ2lvbildCgpgYGAKCmBgYHtyfQp1bmlxdWUoa2l2YV9ieV9yZWdpb24kY291bnRyeVtpcy5uYShraXZhX2J5X3JlZ2lvbiR3b3JsZF9yZWdpb24pXSkKYGBgClRoZXJlIGFyZSAyNSBjb3VudHJpZXMgc3RpbGwgd2l0aCBubyBhc3NpZ25lZCB3b3JsZCByZWdpb24uIEZ1cnRoZXIgY2xlYW4gdXAgaXMgbmVlZGVkIGJ1dCBpdCB3b3VsZCByZXF1aXJlIGFuIGV4dGVybmFsIGRhdGEgc291cmNlIG9yIGRvaW5nIGl0IG1hbnVhbGx5LgpXZSdsbCB1c2UgYW4gZXh0cmEgd29ybGQgcmVnaW9uICJVTktOT1dOIiB0byB0YWcgdGhlbQpgYGB7cn0KbGV2ZWxzKGtpdmFfYnlfcmVnaW9uJHdvcmxkX3JlZ2lvbikgPC0gYyhsZXZlbHMoa2l2YV9ieV9yZWdpb24kd29ybGRfcmVnaW9uKSwgJ1VOS09XTicpCmtpdmFfYnlfcmVnaW9uJHdvcmxkX3JlZ2lvbltpcy5uYShraXZhX2J5X3JlZ2lvbiR3b3JsZF9yZWdpb24pXSA8LSAnVU5LT1dOJwpsZXZlbHMoa2l2YV93aXRoX3JlZ2lvbiR3b3JsZF9yZWdpb24pIDwtIGMobGV2ZWxzKGtpdmFfd2l0aF9yZWdpb24kd29ybGRfcmVnaW9uKSwgJ1VOS09XTicpCmtpdmFfd2l0aF9yZWdpb24kd29ybGRfcmVnaW9uW2lzLm5hKGtpdmFfd2l0aF9yZWdpb24kd29ybGRfcmVnaW9uKV0gPC0gJ1VOS09XTicKYGBgCgpDbGVhbiB1cCB0aGUgZGF0YSBhcyBkaXNjdXNzZWQgYWJvdmUKYGBge3J9CmtpdmFfYnlfcmVnaW9uX2NsZWFuIDwtIGtpdmFfYnlfcmVnaW9uCm1hcF9kYXRhX3dvcmxkIDwtIG1hcF9kYXRhKCJ3b3JsZCIpCm1hcF9kYXRhX3dvcmxkWywnd29ybGRfcmVnaW9uJ108LSBOQQptYXBfZGF0YV93b3JsZF9zcGxpdCA8LSBtYXBfZGF0YV93b3JsZFswOjAsXQpyZWdpb25zX2xpbXMgPC0gbGlzdChsaXN0KHdvcmxkX3JlZ2lvbj0nTGF0aW4gQW1lcmljYSBhbmQgQ2FyaWJiZWFuJywgeWxpbT1jKC02MCwzMCksIHhsaW09YygtMTIwLC0zMCkpLAogICAgICAgICAgICAgICAgICAgICBsaXN0KHdvcmxkX3JlZ2lvbj0nU3ViLVNhaGFyYW4gQWZyaWNhJywgeWxpbT1jKC0zNSwzNSksIHhsaW09YygtMzAsNjApKSwKICAgICAgICAgICAgICAgICAgICAgbGlzdCh3b3JsZF9yZWdpb249J0FyYWIgU3RhdGVzJywgeWxpbT1jKC01LDM1KSwgeGxpbT1jKDMwLDYwKSksCiAgICAgICAgICAgICAgICAgICAgIGxpc3Qod29ybGRfcmVnaW9uPSdFYXN0IEFzaWEgYW5kIHRoZSBQYWNpZmljJywgeWxpbT1jKC02MCwxODApLCB4bGltPWMoOTAsMTAwMCkpLAogICAgICAgICAgICAgICAgICAgICBsaXN0KHdvcmxkX3JlZ2lvbj0nRXVyb3BlIGFuZCBDZW50cmFsIEFzaWEnLCB5bGltPWMoMjAsMjAwKSwgeGxpbT1jKC0yMCw5MCkpLAogICAgICAgICAgICAgICAgICAgICBsaXN0KHdvcmxkX3JlZ2lvbj0nU291dGggQXNpYScsIHlsaW09YygwLDUwKSwgeGxpbT1jKDYwLDEwMCkpCiAgICAgICAgICAgICAgICAgICAgICkKZm9yKHJsIGluIHJlZ2lvbnNfbGltcyl7CiAgIG5ld19wYXJ0IDwtIG1hcF9kYXRhX3dvcmxkW21hcF9kYXRhX3dvcmxkJGxvbmc+cmwkeGxpbVsxXSAmIG1hcF9kYXRhX3dvcmxkJGxvbmc8cmwkeGxpbVsyXSAmIG1hcF9kYXRhX3dvcmxkJGxhdD5ybCR5bGltWzFdICYgbWFwX2RhdGFfd29ybGQkbGF0PHJsJHlsaW1bMl0sXQogICBuZXdfcGFydCR3b3JsZF9yZWdpb24gPC0gcmwkd29ybGRfcmVnaW9uCiAgIG1hcF9kYXRhX3dvcmxkX3NwbGl0IDwtIHJiaW5kKG1hcF9kYXRhX3dvcmxkX3NwbGl0LCBuZXdfcGFydCkKICAgbWFzayA8LSAhKGtpdmFfYnlfcmVnaW9uX2NsZWFuJGxvbj5ybCR4bGltWzFdICYga2l2YV9ieV9yZWdpb25fY2xlYW4kbG9uPHJsJHhsaW1bMl0gJiBraXZhX2J5X3JlZ2lvbl9jbGVhbiRsYXQ+cmwkeWxpbVsxXSAmIGtpdmFfYnlfcmVnaW9uX2NsZWFuJGxhdDxybCR5bGltWzJdKQogICBtYXNrW2lzLm5hKG1hc2spXSA8LSBUUlVFCiAgIG1hc2sgPC0gbWFzayAmIGtpdmFfYnlfcmVnaW9uX2NsZWFuJHdvcmxkX3JlZ2lvbj09cmwkd29ybGRfcmVnaW9uCiAgIGtpdmFfYnlfcmVnaW9uX2NsZWFuW21hc2ssIGMoJ2xhdCcsJ2xvbicpXSA8LSBOQQogICAKICAgbWFzayA8LSAhKGtpdmFfYnlfcmVnaW9uX2NsZWFuJGxvbl9pbXA+cmwkeGxpbVsxXSAmIGtpdmFfYnlfcmVnaW9uX2NsZWFuJGxvbl9pbXA8cmwkeGxpbVsyXSAmIGtpdmFfYnlfcmVnaW9uX2NsZWFuJGxhdF9pbXA+cmwkeWxpbVsxXSAmIGtpdmFfYnlfcmVnaW9uX2NsZWFuJGxhdF9pbXA8cmwkeWxpbVsyXSkKICAgbWFza1tpcy5uYShtYXNrKV0gPC0gVFJVRQogICBtYXNrIDwtIG1hc2sgJiBraXZhX2J5X3JlZ2lvbl9jbGVhbiR3b3JsZF9yZWdpb249PXJsJHdvcmxkX3JlZ2lvbgogICBraXZhX2J5X3JlZ2lvbl9jbGVhblttYXNrLCBjKCdsYXRfaW1wJywnbG9uX2ltcCcpXSA8LSBOQQp9CiMgSW1wdXRlIHdpdGggdGhlIGNvdW50cnkgbWVkaWFuIGxhdC9sb24Ka2l2YV9ieV9yZWdpb25fY2xlYW5baXMubmEoa2l2YV9ieV9yZWdpb25fY2xlYW4kbGF0KSwgYygnbGF0JywnbG9uJyldIDwtIGtpdmFfYnlfcmVnaW9uX2NsZWFuW2lzLm5hKGtpdmFfYnlfcmVnaW9uX2NsZWFuJGxhdCksIGMoJ2xhdF9pbXAnLCdsb25faW1wJyldCmtpdmFfd2l0aF9yZWdpb25baXMubmEoa2l2YV9ieV9yZWdpb24kbGF0KSwgYygnbGF0JywnbG9uJyldIDwtIGtpdmFfd2l0aF9yZWdpb25baXMubmEoa2l2YV9ieV9yZWdpb24kbGF0KSwgYygnbGF0X2ltcCcsJ2xvbl9pbXAnKV0KCmBgYAoKCgpgYGB7ciwgZmlnLndpZHRoID0gMTJ9CmdncGxvdChraXZhX2J5X3JlZ2lvbl9jbGVhbltraXZhX2J5X3JlZ2lvbl9jbGVhbiR3b3JsZF9yZWdpb24hPSdVTktPV04nLF0pKwogIGdlb21fcG9seWdvbihkYXRhPW1hcF9kYXRhX3dvcmxkX3NwbGl0LCBhZXMoeCA9IGxvbmcsIHkgPSBsYXQsIGdyb3VwID0gZ3JvdXApLCBmaWxsPSIjRjBGMEYwIiwgY29sb3VyID0gImxpZ2h0Z3JheSIpKwogIGdlb21fcG9pbnQobWFwcGluZyA9IGFlcyh4PWxvbiwgeT1sYXQsIHNpemUgPSBsb2FuX2Ftb3VudF9zdW0pLCBhbHBoYT0wLjMsIGNvbG9yPSdkYXJrcmVkJywgcG9zaXRpb24gPSBwb3NpdGlvbl9qaXR0ZXIodyA9IDEsIGggPSAxKSkrCiAgY29vcmRfcXVpY2ttYXAoKSsKICBmYWNldF93cmFwKH53b3JsZF9yZWdpb24sICBzY2FsZXMgPSAiZnJlZSIpKwogIGdndGl0bGUoIkxvY2F0aW9uIG9mIExvYW5zIGJ5IFdvcmxkIFJlZ2lvbiIpICsgCiAgc2NhbGVfc2l6ZShsYWJlbCA9IGZmX21pbGxzKHByZWZpeCA9JyQnKSwgYnJlYWtzID0gYygxZSs2LDJlKzYsNGUrNiw2ZSs2KSkrCiAgY2l0czQwMDlfbWFwX3RoZW1lCmBgYApUaGUgcGxvdCBzZWVtcyBtb3JlIHNlbnNpYmxlIG5vdy4gTW9zdCBsb2FucyBhY2N1bXVsYXRlIGFyb3VuZCBhIGZldyBsb2NhdGlvbnMgaW4gZWFjaCB3b3JsZCByZWdpb24uCgojIyMgRGF0YSBieSBzZWN0b3IsIHJlZ2lvbiBhbmQgZ2VuZGVyCkFuYWx5emUgZm9yIHdoYXQgc2VjdG9yIGFuZCBhY3Rpdml0eSB0aGUgbG9hbnMgYXJlIGZvcgpgYGB7ciwgZmlnLndpZHRoID0gMTJ9CmtpdmFfYnlfYWN0aXZpdHkgPC0ga2l2YV93aXRoX3JlZ2lvbiAlPiUgCiAgICAgICAgZ3JvdXBfYnkoLmRvdHM9Yygnc2VjdG9yJywgJ2FjdGl2aXR5JykpICU+JSAKICAgICAgICBzdW1tYXJpc2UobG9hbl9hbW91bnRfbWVhbiA9IG1lYW4obG9hbl9hbW91bnQsIG5hLnJtID0gVCksCiAgICAgICAgICAgICAgICAgIGxvYW5fYW1vdW50X3N1bSA9IHN1bShsb2FuX2Ftb3VudCwgbmEucm0gPSBUKQogICAgICAgICAgICAgICAgICApCgoKCmdncGxvdChraXZhX2J5X2FjdGl2aXR5LCBnZ3Bsb3QyOjphZXMoYXJlYSA9IGxvYW5fYW1vdW50X3N1bSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWwgPSBhY3Rpdml0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJncm91cCA9IHNlY3RvciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxsID0gc2VjdG9yKSkgKyAKICBnZW9tX3RyZWVtYXAoKSArCiAgZ2VvbV90cmVlbWFwX3N1Ymdyb3VwX2JvcmRlcigpICsKICBnZW9tX3RyZWVtYXBfc3ViZ3JvdXBfdGV4dChwbGFjZSA9ICJjZW50cmUiLCBncm93ID0gRiwgYWxwaGEgPSAuNSwgY29sb3VyID0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiV2hpdGUiLCBmb250ZmFjZSA9ICJpdGFsaWMiLCBtaW4uc2l6ZSA9IDApICsKICBnZW9tX3RyZWVtYXBfdGV4dChjb2xvdXIgPSAiYmxhY2siLCBwbGFjZSA9ICJjZW50cmUiLCByZWZsb3cgPSBULCBhbHBoYT0wLjcpICsKICBnZ3RpdGxlKCJMb2FuIEFtb3VudCBCeSBTZWN0b3IvQWN0aXZpdHkiKSArCiAgY2l0czQwMDlfdGhlbWUKYGBgClRoZXJlIGFyZSAzIG1haW4gc2VjdG9ycywgQWdyaWN1bHR1cmUsIFJldGFpbCBhbmQgRm9vZC4gV2l0aGluIHRoZSBzZWN0b3MsIHRoZSBtdWNoIG9mIHRoZSBsYXJnZXN0IGFjdGl2aXRpZXMgYXJlIG5vdCB2ZXJ5IHVzZWZ1bGx5IGxhYmVsZCAoZS5nIEZvb2QgaW4gRm9vZCwgUmV0YWlsIGluIFJldGFpbCkuCgpBbmFseXplIGlmIGRpZmZlcmVudCB3b3JsZCByZWdpb25zIGhhdmUgZGlmZmVyZW50IHR5cGVzIG9mIGxvYW5zCmBgYHtyLCBmaWcud2lkdGggPSAxMiwgZmlnLmhlaWdodD02fQpraXZhX2J5X2FjdGl2aXR5X3dyZWdpb24gPC0ga2l2YV93aXRoX3JlZ2lvbiAlPiUgCiAgICAgICAgZ3JvdXBfYnkoLmRvdHM9Yygnc2VjdG9yJywgJ3dvcmxkX3JlZ2lvbicpKSAlPiUgCiAgICAgICAgc3VtbWFyaXNlKGxvYW5fYW1vdW50X21lYW4gPSBtZWFuKGxvYW5fYW1vdW50LCBuYS5ybSA9IFQpLAogICAgICAgICAgICAgICAgICBsb2FuX2Ftb3VudF9zdW0gPSBzdW0obG9hbl9hbW91bnQsIG5hLnJtID0gVCksCiAgICAgICAgICAgICAgICAgIGxvYW5fY291bnQgPSBzdW0obG9hbl9hbW91bnQqMCsxLCBuYS5ybSA9IFQpCiAgICAgICAgICAgICAgICAgICkKCmtpdmFfdG90YWxfYnlfcmVnaW9uIDwtIGtpdmFfYnlfYWN0aXZpdHlfd3JlZ2lvbiAlPiUgZ3JvdXBfYnkod29ybGRfcmVnaW9uKSAlPiUgc3VtbWFyaXNlKHRvdGFsX2xvYW5zID0gc3VtKGxvYW5fY291bnQsIG5hLnJtID0gVCkpCgpraXZhX2J5X2FjdGl2aXR5X3dyZWdpb24gPC0gbWVyZ2Uoa2l2YV9ieV9hY3Rpdml0eV93cmVnaW9uLCBraXZhX3RvdGFsX2J5X3JlZ2lvbiwgYnk9J3dvcmxkX3JlZ2lvbicpCgpraXZhX2J5X2FjdGl2aXR5X3dyZWdpb24kbG9hbl9wZXJjZW50YWdlIDwtIGtpdmFfYnlfYWN0aXZpdHlfd3JlZ2lvbiRsb2FuX2NvdW50IC8ga2l2YV9ieV9hY3Rpdml0eV93cmVnaW9uJHRvdGFsX2xvYW5zICogMTAwCgpnZ3Bsb3Qoa2l2YV9ieV9hY3Rpdml0eV93cmVnaW9uLCBtYXBwaW5nID0gYWVzKHggPSBzZWN0b3IsIHkgPSB3b3JsZF9yZWdpb24pKSArIAogIGdlb21fY291bnQobWFwcGluZyA9IGFlcyhzaXplPWxvYW5fcGVyY2VudGFnZSwgY29sb3I9bG9hbl9hbW91bnRfc3VtKSkgKwogIGdndGl0bGUoIkxvYW5zICUgb2YgUmVnaW9uIEJ5IFNlY3RvciIpICsKICBzY2FsZV9jb2xvcl9jb250aW51b3VzKGxvdyA9ICJibGFjayIsIGhpZ2ggPSAicmVkIiwgbGFiZWwgPSBmZl9taWxscyhwcmVmaXggPSckJykpICsKICBzY2FsZV9zaXplX2NvbnRpbnVvdXMocmFuZ2UgPSBjKDAuMSwgMTUpLCBsYWJlbCA9IGZmX3BlcmNlbnQoZGlnaXRzPTApKSArCiAgY2l0czQwMDlfdGhlbWUgKwogIHRoZW1lKGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KGFuZ2xlID0gOTAsIGhqdXN0ID0gMSwgc2l6ZSA9IDE0KSwKICAgICAgICBheGlzLnRleHQueSA9IGVsZW1lbnRfdGV4dChhbmdsZSA9ICAwLCBzaXplID0gMTQpLAogICAgICAgIGF4aXMudGl0bGUueCA9IGVsZW1lbnRfYmxhbmsoKSwKICAgICAgICBheGlzLnRpdGxlLnkgPSBlbGVtZW50X2JsYW5rKCkpCiAgCmBgYApXZSBjYW4gc2VlIHRoYXQgdGhlcmUncyBkaWZmZXJlbmNlIGluIHRoZSB3YXkgZWFjaCByZWdpb24gdXNlcyB0aGUgbG9hbnMuIEZvciBpbnN0YW5jZSwgdGhlIEFyYWIgU3RhdGVzIGhhdmUgYSBsYXJnZXIgcGVyY2VudGFnZSBkZWRpY2F0ZWQgdG8gIkVkdWNhdGlvbiIgdGhhbiBvdGhlciByZWdpb25zLiBTdWItU2FoYXJhbiBBZnJpY2EgYW5kIExhdGluIEFtZXJpY2EgYW5kIENhcmliYmVhbiBoYXZlIHZlcnkgc2ltaWxhciBwcm9maWxlcy4KCgoKCkFuYWx5emUgaWYgdGhlIGxvYW4gc2VjdG9yIGFuZCBib3Jyb3dlciBnZW5kZXIgYXJlIHJlbGF0ZWQKYGBge3IsIGZpZy53aWR0aCA9IDEyLCBmaWcuaGVpZ2h0PTZ9CgojIENyZWF0ZSBhICJnZW5kZXIgdHlwZSIgdmFyaWFibGUgdG8gc3VtbWFyaXplIHRoZSBnZW5kZXIgaW5mb3JtYXRpb24Ka2l2YV93aXRoX3JlZ2lvbiRnZW5kZXJfdHlwZSA8LSAnVW5rb3duJwpraXZhX3dpdGhfcmVnaW9uJGdlbmRlcl90eXBlW2tpdmFfd2l0aF9yZWdpb24kYm9ycm93ZXJzX2ZlbWFsZXM+MF0gPC0gJ0ZlbWFsZScKa2l2YV93aXRoX3JlZ2lvbiRnZW5kZXJfdHlwZVtraXZhX3dpdGhfcmVnaW9uJGJvcnJvd2Vyc19tYWxlcz4wXSA8LSAnTWFsZScKa2l2YV93aXRoX3JlZ2lvbiRnZW5kZXJfdHlwZVtraXZhX3dpdGhfcmVnaW9uJGJvcnJvd2Vyc19mZW1hbGVzPjAgJiBraXZhX3dpdGhfcmVnaW9uJGJvcnJvd2Vyc19tYWxlcz4wXSA8LSAnQm90aCcKCmtpdmFfYnlfYWN0aXZpdHlfZ2VuZGVyX3R5cGUgPC0ga2l2YV93aXRoX3JlZ2lvbiAlPiUgCiAgICAgICAgZ3JvdXBfYnkoLmRvdHM9Yygnc2VjdG9yJywgJ2dlbmRlcl90eXBlJykpICU+JSAKICAgICAgICBzdW1tYXJpc2UobG9hbl9hbW91bnRfbWVhbiA9IG1lYW4obG9hbl9hbW91bnQsIG5hLnJtID0gVCksCiAgICAgICAgICAgICAgICAgIGxvYW5fYW1vdW50X3N1bSA9IHN1bShsb2FuX2Ftb3VudCwgbmEucm0gPSBUKSwKICAgICAgICAgICAgICAgICAgbG9hbl9jb3VudCA9IHN1bShsb2FuX2Ftb3VudCowKzEsIG5hLnJtID0gVCkKICAgICAgICAgICAgICAgICAgKQoKa2l2YV90b3RhbF9ieV9nZW5kZXJfdHlwZSA8LSBraXZhX2J5X2FjdGl2aXR5X2dlbmRlcl90eXBlICU+JSBncm91cF9ieShnZW5kZXJfdHlwZSkgJT4lIHN1bW1hcmlzZSh0b3RhbF9sb2FucyA9IHN1bShsb2FuX2NvdW50LCBuYS5ybSA9IFQpKQoKa2l2YV9ieV9hY3Rpdml0eV9nZW5kZXJfdHlwZSA8LSBtZXJnZShraXZhX2J5X2FjdGl2aXR5X2dlbmRlcl90eXBlLCBraXZhX3RvdGFsX2J5X2dlbmRlcl90eXBlLCBieT0nZ2VuZGVyX3R5cGUnKQoKa2l2YV9ieV9hY3Rpdml0eV9nZW5kZXJfdHlwZSRsb2FuX3BlcmNlbnRhZ2UgPC0ga2l2YV9ieV9hY3Rpdml0eV9nZW5kZXJfdHlwZSRsb2FuX2NvdW50IC8ga2l2YV9ieV9hY3Rpdml0eV9nZW5kZXJfdHlwZSR0b3RhbF9sb2FucyAqIDEwMAoKZ2dwbG90KGtpdmFfYnlfYWN0aXZpdHlfZ2VuZGVyX3R5cGUsIG1hcHBpbmcgPSBhZXMoeCA9IHNlY3RvciwgeSA9IGdlbmRlcl90eXBlKSkgKyAKICAjZ2VvbV90aWxlKG1hcHBpbmcgPSBhZXMoZmlsbD1sb2FuX2Ftb3VudF9zdW0pKSArCiAgZ2VvbV9jb3VudChtYXBwaW5nID0gYWVzKHNpemU9bG9hbl9wZXJjZW50YWdlLCBjb2xvcj1sb2FuX2Ftb3VudF9zdW0pKSArCiAgZ2d0aXRsZSgiTG9hbnMgJSBvZiBHZW5kZXIgVHlwZSBCeSBTZWN0b3IiKSArCiAgc2NhbGVfY29sb3JfY29udGludW91cyhsb3cgPSAiYmxhY2siLCBoaWdoID0gInJlZCIsIGxhYmVsID0gZmZfbWlsbHMocHJlZml4ID0nJCcpKSArCiAgc2NhbGVfc2l6ZV9jb250aW51b3VzKHJhbmdlID0gYygwLjEsIDE1KSwgbGFiZWwgPSBmZl9wZXJjZW50KGRpZ2l0cz0wKSkgKwogIGNpdHM0MDA5X3RoZW1lICsKICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDkwLCBoanVzdCA9IDEsIHNpemUgPSAxNCksCiAgICAgICAgYXhpcy50ZXh0LnkgPSBlbGVtZW50X3RleHQoYW5nbGUgPSAgMCwgc2l6ZSA9IDE0KSwKICAgICAgICBheGlzLnRpdGxlLnggPSBlbGVtZW50X2JsYW5rKCksCiAgICAgICAgYXhpcy50aXRsZS55ID0gZWxlbWVudF9ibGFuaygpKQogIApgYGAKVGhlIDQgY2F0ZWdvcmllcyBhcmUgdmVyeSBzaW1pbGFyIG9uIHRoZWlyIGRpc3RyaWJ1dGlvbiBvZiBsb2FuIHNlY3RvciwgYnV0IHRoZXJlIGFyZSBzb21lIGRpZmZlcmVuY2VzLiBGb3IgaW5zdGFuY2UsICJQZXJzb25hbCBVc2UiIGxvYW5zIGFyZSBtb3JlIGNvbW1vbiB3aGVuIHRoZSBib3Jyb3dlciBpbmNsdWRlIGJvdGggZ2VuZGVycy4KCldlIGNhbiB1c2UgQ29ycmVzcG9uZGVuY2UgQW5hbHlzaXMgKENBKSB0byBmdXJ0aGVyIHVuZGVyc3RhbmQgdGhpcyBjb3JyZWxhdGlvbi4gQ0EgcHJvdmlkZXMgYSBncmFwaGljIG1ldGhvZCBvZiBleHBsb3JpbmcgdGhlIHJlbGF0aW9uc2hpcCBiZXR3ZWVuIHZhcmlhYmxlcyBpbiBhIGNvbnRpbmdlbmN5IHRhYmxlCmBgYHtyLCBmaWcud2lkdGggPSAxMiwgZmlnLmhlaWdodD02fQojIENvcnJlc3BvbmRlbmNlIEFuYWx5c2lzCiMgQ29kZSBpbiB0aGlzIGJsb2NrIGlzIGFkYXB0ZWQgZnJvbSBodHRwczovL3d3dy5zdGF0bWV0aG9kcy5uZXQvYWR2c3RhdHMvY2EuaHRtbAp0YWJsZSA8LSBkY2FzdChraXZhX2J5X2FjdGl2aXR5X2dlbmRlcl90eXBlLCBnZW5kZXJfdHlwZX5zZWN0b3IsIHZhbHVlLnZhciA9ICJsb2FuX2NvdW50IikKcm93bmFtZXModGFibGUpIDwtIHRhYmxlJGdlbmRlcl90eXBlCnRhYmxlJGdlbmRlcl90eXBlIDwtIE5VTEwKZml0IDwtIGNhKHRhYmxlKQojIHByaW50KGZpdCkgIyBiYXNpYyByZXN1bHRzCiMgc3VtbWFyeShmaXQpICMgZXh0ZW5kZWQgcmVzdWx0cwpwbG90KGZpdCwgbWFzcyA9IFRSVUUsIGNvbnRyaWIgPSAiYWJzb2x1dGUiLCBtYXAgPQogICAicm93Z3JlZW4iLCBhcnJvd3MgPSBjKEZBTFNFLCBUUlVFKSkgIyBhc3ltbWV0cmljIG1hcCAKYGBgCldlIGNhbiBzZWUgdGhhdCBNYWxlIGJvcnJvd2VycyBhcmUgbW9yZSByZWxhdGVkIHRvIEFncmljdWx0dXJlLCBUcmFuc3BvcnRhdGlvbiwgQ29uc3RydWN0aW9uIGFuZCBFZHVjYXRpb247IEZlbWFsZSB3aXRoIEFydHMsIFJldGFpbCwgQ2xvdGhpbmcgYW5kIEZvb2QsIGFuZCB0aGF0IFBlcnNvbmFsIFVzZSBpcyByZWxhdGVkIHdpdGggYm9ycm93ZXJzIHRoYXQgaW5jbHVkZSBCb3RoIGdlbmRlcnMuCgpBbmFseXplIGlmIHRoZSB3b3JsZCByZWdpb24gYW5kIGJvcnJvd2VyIGdlbmRlciBhcmUgcmVsYXRlZApgYGB7ciwgZmlnLndpZHRoID0gMTIsIGZpZy5oZWlnaHQ9Nn0Ka2l2YV9ieV9yZWdpb25fZ2VuZGVyX3R5cGUgPC0ga2l2YV93aXRoX3JlZ2lvbiAlPiUgCiAgICAgICAgZ3JvdXBfYnkoLmRvdHM9Yygnd29ybGRfcmVnaW9uJywgJ2dlbmRlcl90eXBlJykpICU+JSAKICAgICAgICBzdW1tYXJpc2UobG9hbl9hbW91bnRfbWVhbiA9IG1lYW4obG9hbl9hbW91bnQsIG5hLnJtID0gVCksCiAgICAgICAgICAgICAgICAgIGxvYW5fYW1vdW50X3N1bSA9IHN1bShsb2FuX2Ftb3VudCwgbmEucm0gPSBUKSwKICAgICAgICAgICAgICAgICAgbG9hbl9jb3VudCA9IHN1bShsb2FuX2Ftb3VudCowKzEsIG5hLnJtID0gVCkKICAgICAgICAgICAgICAgICAgKQoKa2l2YV9ieV9yZWdpb25fZ2VuZGVyX3R5cGUgPC0gbWVyZ2Uoa2l2YV9ieV9yZWdpb25fZ2VuZGVyX3R5cGUsIGtpdmFfdG90YWxfYnlfcmVnaW9uLCBieT0nd29ybGRfcmVnaW9uJykKCmtpdmFfYnlfcmVnaW9uX2dlbmRlcl90eXBlJGxvYW5fcGVyY2VudGFnZSA8LSBraXZhX2J5X3JlZ2lvbl9nZW5kZXJfdHlwZSRsb2FuX2NvdW50IC8ga2l2YV9ieV9yZWdpb25fZ2VuZGVyX3R5cGUkdG90YWxfbG9hbnMgKiAxMDAKCmdncGxvdChraXZhX2J5X3JlZ2lvbl9nZW5kZXJfdHlwZSwgbWFwcGluZyA9IGFlcyh4ID0gZ2VuZGVyX3R5cGUsIHkgPSB3b3JsZF9yZWdpb24pKSArIAogIGdlb21fY291bnQobWFwcGluZyA9IGFlcyhzaXplPWxvYW5fcGVyY2VudGFnZSwgY29sb3I9bG9hbl9hbW91bnRfc3VtKSkgKwogIGdndGl0bGUoIkxvYW5zICUgb2YgUmVnaW9uIEJ5IEdlbmRlciIpICsKICBzY2FsZV9jb2xvcl9jb250aW51b3VzKGxvdyA9ICJibGFjayIsIGhpZ2ggPSAicmVkIiwgbGFiZWwgPSBmZl9taWxscyhwcmVmaXggPSckJykpICsKICBzY2FsZV9zaXplX2NvbnRpbnVvdXMocmFuZ2UgPSBjKDAuMSwgMTUpLCBsYWJlbCA9IGZmX3BlcmNlbnQoZGlnaXRzPTApKSArCiAgY2l0czQwMDlfdGhlbWUgKwogIHRoZW1lKGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KGFuZ2xlID0gOTAsIGhqdXN0ID0gMSwgc2l6ZSA9IDE0KSwKICAgICAgICBheGlzLnRleHQueSA9IGVsZW1lbnRfdGV4dChhbmdsZSA9ICAwLCBzaXplID0gMTQpLAogICAgICAgIGF4aXMudGl0bGUueCA9IGVsZW1lbnRfYmxhbmsoKSwKICAgICAgICBheGlzLnRpdGxlLnkgPSBlbGVtZW50X2JsYW5rKCkpCiAgCmBgYApGZW1hbGUgYm9ycm93ZXJzIGFyZSBwcmVkb21pbmFudCBpbiBhbGwgcmVnaW9ucywgYnV0IHRoaXMgaXMgZXZlbiBtb3JlIG1hcmtlZCBpbiBTb3V0aCBBc2lhIGFuZCBFYXN0IEFzaWEgYW5kIHRoZSBQYWNpZmljLgoKIyMjIFRyZW5kIGJ5IHRpbWUKQW5hbHl6ZSBob3cgbXVjaCBtb25leSB3YXMgbGVuZCBhbG9uZyB0aGUgeWVhcnMuCmBgYHtyLCBmaWcud2lkdGggPSAxMn0Ka2l2YV9ieV9kYXRlIDwtIGtpdmEgJT4lIAogICAgICAgIGdyb3VwX2J5KC5kb3RzPWMoJ2RhdGUnKSkgJT4lIAogICAgICAgIHN1bW1hcmlzZShsb2FuX2Ftb3VudF9tZWFuID0gbWVhbihsb2FuX2Ftb3VudCwgbmEucm0gPSBUKSwKICAgICAgICAgICAgICAgICAgbG9hbl9hbW91bnRfc3VtID0gc3VtKGxvYW5fYW1vdW50LCBuYS5ybSA9IFQpLAogICAgICAgICAgICAgICAgICBsb2FuX2NvdW50ID0gc3VtKGxvYW5fYW1vdW50KjArMSwgbmEucm0gPSBUKQogICAgICAgICAgICAgICAgICApCmdncGxvdChkYXRhID0ga2l2YV9ieV9kYXRlLCBtYXBwaW5nID0gYWVzKHggPSBkYXRlLCB5ID0gbG9hbl9hbW91bnRfc3VtKSkgKwogIGdlb21fcG9pbnQoKSArCiAgZ2VvbV9zbW9vdGgoc3Bhbj0wLjEpICsKICBnZ3RpdGxlKCJMb2FuIGFtb3VudCBieSBkYXkiKSArIAogIGNpdHM0MDA5X3RoZW1lCmBgYApJdCBpcyBjbGVhciB0aGF0IHRoZXJlIGFyZSB0d28gZGlmZmVyZW50IGdyb3Vwcy4gT25lIG1pZ2h0IGJlIHdlZWtkYXlzIGFuZCB0aGUgb3RoZXIgd2Vla2VuZHMuClRoZSBmb2xsb3dpbmcgcGxvdCBhZGRyZXNzZXMgdGhpcy4KYGBge3IsIGZpZy53aWR0aCA9IDEyfQpraXZhX2J5X2RhdGUkd2Vla2RheSA8LSBpc1dlZWtkYXkoa2l2YV9ieV9kYXRlJGRhdGUsIHdkYXk9MTo1KQoKZ2dwbG90KGRhdGEgPSBraXZhX2J5X2RhdGUsIG1hcHBpbmcgPSBhZXMoeCA9IGRhdGUsIHkgPSBsb2FuX2Ftb3VudF9zdW0sIGNvbG9yID0gd2Vla2RheSkpICsKICBnZW9tX3BvaW50KCkgKwogIGdlb21fc21vb3RoKHNwYW49MC4xKSArCiAgZ2d0aXRsZSgiTG9hbiBhbW91bnQgYnkgZGF5LCBzcGxpdCBieSBXZWVrZGF5L1dlZWtlbmQiKSArIAogIGNpdHM0MDA5X3RoZW1lCmBgYApXZSBjYW4gc2VlIHRoYXQgaW4gZmFjdCB3ZWVrZW5kcyBhbmQgd2Vla2RheXMgaGF2ZSBkaWZmZXJlbnQgZGlzdHJpYnV0aW9ucyBpbiB0ZXJtcyBvZiBsb2FuIGFtb3VudC4gVGhlIHRyZW5kIHNlZW1zIHNvIGJlIGluY3JlYXNpbmcgc2xpZ2h0bHkgd2l0aCB0aW1lLiBUaGVyZSdzIGEgbm90b3Jpb3VzIGRyb3AgYnkgdGhlIGVuZCwgYnV0IGl0IG1pZ2h0IGJlIGR1ZSB0byBpbmNvbXBsZXRlbHkgbG9hZGVkIGRhdGEgZm9yIHRoZSBsYXN0IGRheXMgb2YgdGhlIGRhdGEgc2V0LgoKTm93IHdlIHJlcGVhdCB0aGUgYW5hbHlzaXMgYnV0IHNwbGl0IGJ5ICJzZWN0b3IiLCBhcyBkaWZmZXJlbnQgc2VjdG9ycyBzdWNoIGFzIGFncmljdWx0dXJlIGFuZCByZXRhaWwgbWlnaHQgaGF2ZSBkaWZmZXJlbnQgc2Vhc29uYWxpdHkgYW5kIGdlbmVyYWwgdHJlbmRzCmBgYHtyLCBmaWcud2lkdGggPSAxMn0Ka2l2YV9ieV9zZWN0b3JfbW9udGggPC0ga2l2YV93aXRoX3JlZ2lvblssYygnZGF0ZScsJ3NlY3RvcicsJ2xvYW5fYW1vdW50JyldICU+JSAKICAgICAgICBncm91cF9ieSh5ZWFyKGRhdGUpLG1vbnRoKGRhdGUpLHNlY3RvcikgJT4lIAogICAgICAgIHN1bW1hcmlzZShsb2FuX2Ftb3VudF9tZWFuID0gbWVhbihsb2FuX2Ftb3VudCwgbmEucm0gPSBUKSwKICAgICAgICAgICAgICAgICAgbG9hbl9hbW91bnRfc3VtID0gc3VtKGxvYW5fYW1vdW50LCBuYS5ybSA9IFQpLAogICAgICAgICAgICAgICAgICBsb2FuX2NvdW50ID0gc3VtKGxvYW5fYW1vdW50KjArMSwgbmEucm0gPSBUKQogICAgICAgICAgICAgICAgICApCmNvbG5hbWVzKGtpdmFfYnlfc2VjdG9yX21vbnRoKSA8LSBjKCJ5ZWFyX2RhdGUiLCAibW9udGhfZGF0ZSIsICJzZWN0b3IiLCAibG9hbl9hbW91bnRfbWVhbiIsICJsb2FuX2Ftb3VudF9zdW0iLCAibG9hbl9jb3VudCIpCmtpdmFfYnlfc2VjdG9yX21vbnRoJG1vbnRoX251bWJlciA8LSBraXZhX2J5X3NlY3Rvcl9tb250aCR5ZWFyX2RhdGUgKyhraXZhX2J5X3NlY3Rvcl9tb250aCRtb250aF9kYXRlLTEpLzEyCgpraXZhX2J5X3NlY3Rvcl9tb250aCA8LSBraXZhX2J5X3NlY3Rvcl9tb250aFtraXZhX2J5X3NlY3Rvcl9tb250aCR5ZWFyX2RhdGU8MjAxNyxdICMgT25seSBwbG90IHRoZSBmdWxsIHllYXJzCgpnZ3Bsb3QoZGF0YSA9IGtpdmFfYnlfc2VjdG9yX21vbnRoLCBtYXBwaW5nID0gYWVzKHggPSBtb250aF9udW1iZXIsIHkgPSBsb2FuX2Ftb3VudF9zdW0sIGNvbG9yID0gc2VjdG9yKSkgKwogIGdlb21fcG9pbnQoKSArCiAgZ2VvbV9saW5lKCkgKwogIGdndGl0bGUoIkxvYW4gYW1vdW50IGJ5IG1vbnRoLCBzcGxpdCBieSBTZWN0b3IiKSArIAogIGNpdHM0MDA5X3RoZW1lCgpnZ3Bsb3QoZGF0YSA9IGtpdmFfYnlfc2VjdG9yX21vbnRoLCBtYXBwaW5nID0gYWVzKHggPSBtb250aF9udW1iZXIsIHkgPSBsb2FuX2NvdW50LCBjb2xvciA9IHNlY3RvcikpICsKICBnZW9tX3BvaW50KCkgKwogIGdlb21fbGluZSgpICsKICBnZ3RpdGxlKCJMb2FucyBjb3VudCBieSBtb250aCwgc3BsaXQgYnkgU2VjdG9yIikgKyAKICBjaXRzNDAwOV90aGVtZQoKYGBgCldlIGNhbiB0YWtlIG91dCB0aGUgMyBsYXJnZXIgc2VjdG9ycyAoUmV0YWlsLCBGb29kIGFuZCBBZ3JpY3VsdHVyZSkgdG8gYmV0dGVyIHZpc3VhbGl6ZSB0aGUgdHJlbmQgaW4gdGhlIHNtYWxsZXIgc2VjdG9ycwpgYGB7ciwgZmlnLndpZHRoID0gMTJ9CnNtYWxsX3NlY3RvcnMgPC0gIShraXZhX2J5X3NlY3Rvcl9tb250aCRzZWN0b3IgJWluJSBjKCdSZXRhaWwnLCdGb29kJywnQWdyaWN1bHR1cmUnKSkKZ2dwbG90KGRhdGEgPSBraXZhX2J5X3NlY3Rvcl9tb250aFtzbWFsbF9zZWN0b3JzLF0sIG1hcHBpbmcgPSBhZXMoeCA9IG1vbnRoX251bWJlciwgeSA9IGxvYW5fYW1vdW50X3N1bSwgY29sb3IgPSBzZWN0b3IpKSArCiAgZ2VvbV9wb2ludCgpICsKICBnZW9tX2xpbmUoKSArCiAgZ2d0aXRsZSgiTG9hbiBhbW91bnQgYnkgbW9udGgsIHNtYWxsZXIgc2VjdG9ycyIpICsgCiAgY2l0czQwMDlfdGhlbWUKCmdncGxvdChkYXRhID0ga2l2YV9ieV9zZWN0b3JfbW9udGhbc21hbGxfc2VjdG9ycyxdLCBtYXBwaW5nID0gYWVzKHggPSBtb250aF9udW1iZXIsIHkgPSBsb2FuX2NvdW50LCBjb2xvciA9IHNlY3RvcikpICsKICBnZW9tX3BvaW50KCkgKwogIGdlb21fbGluZSgpICsKICBnZ3RpdGxlKCJMb2FucyBjb3VudCBieSBtb250aCwgc21hbGxlciBzZWN0b3JzIikgKyAKICBjaXRzNDAwOV90aGVtZQoKCmBgYApUaGVyZSdzIGJlZW4gYW4gaW5jcmVhc2UgaW4gdGhlIG51bWJlciBvZiBsb2FucyBiZWxvbmdpbmcgdG8gdGhlICJQZXJzb25hbCBVc2UiIGFuZCAiRWR1Y2F0aW9uIiBjYXRlZ29yaWVzLCB0aGF0J3MgYmVlbiBtb3JlIHN0ZWVwIHRoYW4gdGhlIGluY3JlYXNlIG9mIG90aGVyIHBvcHVsYXIgY2F0ZWdvcmllcyBzdWNoIGFzIFNlcnZpY2VzLCBDbG90aGluZyBhbmQgSG91c2luZy4= 
 </div> 
</div> 
<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});

$(document).ready(function () {
  $('.knitsql-table').addClass('kable-table');
  var container = $('.kable-table');
  container.each(function() {

    // move the caption out of the table
    var table = $(this).children('table');
    var caption = table.children('caption').detach();
    caption.insertBefore($(this)).css('display', 'inherit');
  });
});

</script> <!-- tabsets --> 
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script> <!-- code folding --> 
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("Project 1 - Sergio Banchero.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script> <!-- dynamically load mathjax for compatibility with self-contained --> 
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
      </body>
    </html>